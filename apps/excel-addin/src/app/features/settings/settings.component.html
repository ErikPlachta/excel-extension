<section>
  <h2>Settings</h2>

  <h3>Backup & Restore</h3>
  <div class="tables-toolbar">
    <button type="button" (click)="exportBackup()">
      Export Backup
    </button>
    <button type="button" (click)="fileInput.click()">
      Import Backup
    </button>
    <input
      #fileInput
      type="file"
      accept=".json"
      style="display: none"
      (change)="onFileSelected($event)"
    />
  </div>

  <h3>Query Execution</h3>
  <p style="font-size: 0.9em; color: #666; margin-bottom: 1em;">
    Configure performance settings for large datasets. Changes take effect on next query run.
  </p>

  <label>
    Max rows per query:
    <input
      type="number"
      [value]="settings.value.queryExecution?.maxRowsPerQuery ?? 10000"
      (change)="onMaxRowsChange($event.target.value)"
      min="100"
      max="100000"
      step="1000"
      style="width: 100px; margin-left: 8px;"
    />
    <small style="display: block; margin-top: 4px; color: #666;">
      Limits result size to prevent Excel crashes (default: 10,000)
    </small>
  </label>

  <label>
    Chunk size (Excel writes):
    <input
      type="number"
      [value]="settings.value.queryExecution?.chunkSize ?? 1000"
      (change)="onChunkSizeChange($event.target.value)"
      min="100"
      max="5000"
      step="100"
      style="width: 100px; margin-left: 8px;"
    />
    <small style="display: block; margin-top: 4px; color: #666;">
      Rows per batch when writing to Excel (default: 1,000)
    </small>
  </label>

  <label>
    <input
      type="checkbox"
      [checked]="settings.value.queryExecution?.enableProgressiveLoading ?? true"
      (change)="onProgressiveLoadingChange($event.target.checked)"
    />
    Enable progressive loading
    <small style="display: block; margin-top: 4px; margin-left: 24px; color: #666;">
      Show first chunk immediately, queue rest (default: on)
    </small>
  </label>

  <h3>Telemetry</h3>
  <label>
    <input
      type="checkbox"
      [checked]="settings.value.telemetry.enableWorkbookLogging"
      (change)="onTelemetryWorkbookLoggingChange($event.target.checked)"
    />
    Enable in-workbook telemetry log table
  </label>

  <label>
    <input
      type="checkbox"
      [checked]="settings.value.telemetry.enableConsoleLogging"
      (change)="onTelemetryConsoleLoggingChange($event.target.checked)"
    />
    Enable console telemetry logging
  </label>

  <h3>Developer Tools</h3>
  <div class="tables-toolbar">
    <button type="button" (click)="resetManagedTables()">
      Reset extension-managed tables (dev)
    </button>
  </div>
</section>
