import{a as E,b as k,c as jo,d as v}from"./chunk-4CLCTAJ7.js";var Da;function Bo(){return Da}function dt(n){let e=Da;return Da=n,e}var Pu=Symbol("NotFound");function jn(n){return n===Pu||n?.name==="\u0275NotFound"}var De=null,Ho=!1,Ca=1,Vm=null,Ne=Symbol("SIGNAL");function F(n){let e=De;return De=n,e}function Wo(){return De}var Bn={version:0,lastCleanEpoch:0,dirty:!1,producers:void 0,producersTail:void 0,consumers:void 0,consumersTail:void 0,recomputing:!1,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Go(n){if(Ho)throw new Error("");if(De===null)return;De.consumerOnSignalRead(n);let e=De.producersTail;if(e!==void 0&&e.producer===n)return;let t,r=De.recomputing;if(r&&(t=e!==void 0?e.nextProducer:De.producers,t!==void 0&&t.producer===n)){De.producersTail=t,t.lastReadVersion=n.version;return}let o=n.consumersTail;if(o!==void 0&&o.consumer===De&&(!r||Bm(o,De)))return;let i=Hn(De),s={producer:n,consumer:De,nextProducer:t,prevConsumer:o,lastReadVersion:n.version,nextConsumer:void 0};De.producersTail=s,e!==void 0?e.nextProducer=s:De.producers=s,i&&ju(n,s)}function Fu(){Ca++}function zo(n){if(!(Hn(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===Ca)){if(!n.producerMustRecompute(n)&&!Zo(n)){qo(n);return}n.producerRecomputeValue(n),qo(n)}}function ba(n){if(n.consumers===void 0)return;let e=Ho;Ho=!0;try{for(let t=n.consumers;t!==void 0;t=t.nextConsumer){let r=t.consumer;r.dirty||jm(r)}}finally{Ho=e}}function _a(){return De?.consumerAllowSignalWrites!==!1}function jm(n){n.dirty=!0,ba(n),n.consumerMarkedDirty?.(n)}function qo(n){n.dirty=!1,n.lastCleanEpoch=Ca}function Rr(n){return n&&Lu(n),F(n)}function Lu(n){n.producersTail=void 0,n.recomputing=!0}function Qo(n,e){F(e),n&&Vu(n)}function Vu(n){n.recomputing=!1;let e=n.producersTail,t=e!==void 0?e.nextProducer:n.producers;if(t!==void 0){if(Hn(n))do t=wa(t);while(t!==void 0);e!==void 0?e.nextProducer=void 0:n.producers=void 0}}function Zo(n){for(let e=n.producers;e!==void 0;e=e.nextProducer){let t=e.producer,r=e.lastReadVersion;if(r!==t.version||(zo(t),r!==t.version))return!0}return!1}function Yo(n){if(Hn(n)){let e=n.producers;for(;e!==void 0;)e=wa(e)}n.producers=void 0,n.producersTail=void 0,n.consumers=void 0,n.consumersTail=void 0}function ju(n,e){let t=n.consumersTail,r=Hn(n);if(t!==void 0?(e.nextConsumer=t.nextConsumer,t.nextConsumer=e):(e.nextConsumer=void 0,n.consumers=e),e.prevConsumer=t,n.consumersTail=e,!r)for(let o=n.producers;o!==void 0;o=o.nextProducer)ju(o.producer,o)}function wa(n){let e=n.producer,t=n.nextProducer,r=n.nextConsumer,o=n.prevConsumer;if(n.nextConsumer=void 0,n.prevConsumer=void 0,r!==void 0?r.prevConsumer=o:e.consumersTail=o,o!==void 0)o.nextConsumer=r;else if(e.consumers=r,!Hn(e)){let i=e.producers;for(;i!==void 0;)i=wa(i)}return t}function Hn(n){return n.consumerIsAlwaysLive||n.consumers!==void 0}function Ko(n){Vm?.(n)}function Bm(n,e){let t=e.producersTail;if(t!==void 0){let r=e.producers;do{if(r===n)return!0;if(r===t)break;r=r.nextProducer}while(r!==void 0)}return!1}function Jo(n,e){return Object.is(n,e)}function Xo(n,e){let t=Object.create(Hm);t.computation=n,e!==void 0&&(t.equal=e);let r=()=>{if(zo(t),Go(t),t.value===Ar)throw t.error;return t.value};return r[Ne]=t,Ko(t),r}var Uo=Symbol("UNSET"),$o=Symbol("COMPUTING"),Ar=Symbol("ERRORED"),Hm=k(E({},Bn),{value:Uo,dirty:!0,error:null,equal:Jo,kind:"computed",producerMustRecompute(n){return n.value===Uo||n.value===$o},producerRecomputeValue(n){if(n.value===$o)throw new Error("");let e=n.value;n.value=$o;let t=Rr(n),r,o=!1;try{r=n.computation(),F(null),o=e!==Uo&&e!==Ar&&r!==Ar&&n.equal(e,r)}catch(i){r=Ar,n.error=i}finally{Qo(n,t)}if(o){n.value=e;return}n.value=r,n.version++}});function Um(){throw new Error}var Bu=Um;function Hu(n){Bu(n)}function Ia(n){Bu=n}var $m=null;function Sa(n,e){let t=Object.create($u);t.value=n,e!==void 0&&(t.equal=e);let r=()=>Uu(t);return r[Ne]=t,Ko(t),[r,s=>ei(t,s),s=>Ta(t,s)]}function Uu(n){return Go(n),n.value}function ei(n,e){_a()||Hu(n),n.equal(n.value,e)||(n.value=e,qm(n))}function Ta(n,e){_a()||Hu(n),ei(n,e(n.value))}var $u=k(E({},Bn),{equal:Jo,value:void 0,kind:"signal"});function qm(n){n.version++,Fu(),ba(n),$m?.(n)}function U(n){return typeof n=="function"}function Un(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var ti=Un(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,o)=>`${o+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function an(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var ge=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let i of t)i.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(U(r))try{r()}catch(i){e=i instanceof ti?i.errors:[i]}let{_finalizers:o}=this;if(o){this._finalizers=null;for(let i of o)try{qu(i)}catch(s){e=e??[],s instanceof ti?e=[...e,...s.errors]:e.push(s)}}if(e)throw new ti(e)}}add(e){var t;if(e&&e!==this)if(this.closed)qu(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&an(t,e)}remove(e){let{_finalizers:t}=this;t&&an(t,e),e instanceof n&&e._removeParent(this)}};ge.EMPTY=(()=>{let n=new ge;return n.closed=!0,n})();var Ma=ge.EMPTY;function ni(n){return n instanceof ge||n&&"closed"in n&&U(n.remove)&&U(n.add)&&U(n.unsubscribe)}function qu(n){U(n)?n():n.unsubscribe()}var tt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var $n={setTimeout(n,e,...t){let{delegate:r}=$n;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=$n;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function ri(n){$n.setTimeout(()=>{let{onUnhandledError:e}=tt;if(e)e(n);else throw n})}function kr(){}var Wu=xa("C",void 0,void 0);function Gu(n){return xa("E",void 0,n)}function zu(n){return xa("N",n,void 0)}function xa(n,e,t){return{kind:n,value:e,error:t}}var ln=null;function qn(n){if(tt.useDeprecatedSynchronousErrorHandling){let e=!ln;if(e&&(ln={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=ln;if(ln=null,t)throw r}}else n()}function Qu(n){tt.useDeprecatedSynchronousErrorHandling&&ln&&(ln.errorThrown=!0,ln.error=n)}var cn=class extends ge{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,ni(e)&&e.add(this)):this.destination=zm}static create(e,t,r){return new kt(e,t,r)}next(e){this.isStopped?Aa(zu(e),this):this._next(e)}error(e){this.isStopped?Aa(Gu(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Aa(Wu,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},Wm=Function.prototype.bind;function Na(n,e){return Wm.call(n,e)}var Ra=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){oi(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){oi(r)}else oi(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){oi(t)}}},kt=class extends cn{constructor(e,t,r){super();let o;if(U(e)||!e)o={next:e??void 0,error:t??void 0,complete:r??void 0};else{let i;this&&tt.useDeprecatedNextContext?(i=Object.create(e),i.unsubscribe=()=>this.unsubscribe(),o={next:e.next&&Na(e.next,i),error:e.error&&Na(e.error,i),complete:e.complete&&Na(e.complete,i)}):o=e}this.destination=new Ra(o)}};function oi(n){tt.useDeprecatedSynchronousErrorHandling?Qu(n):ri(n)}function Gm(n){throw n}function Aa(n,e){let{onStoppedNotification:t}=tt;t&&$n.setTimeout(()=>t(n,e))}var zm={closed:!0,next:kr,error:Gm,complete:kr};var Wn=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Zu(n){return n}function Yu(n){return n.length===0?Zu:n.length===1?n[0]:function(t){return n.reduce((r,o)=>o(r),t)}}var X=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,o){let i=Zm(t)?t:new kt(t,r,o);return qn(()=>{let{operator:s,source:a}=this;i.add(s?s.call(i,a):a?this._subscribe(i):this._trySubscribe(i))}),i}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=Ku(r),new r((o,i)=>{let s=new kt({next:a=>{try{t(a)}catch(l){i(l),s.unsubscribe()}},error:i,complete:o});this.subscribe(s)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[Wn](){return this}pipe(...t){return Yu(t)(this)}toPromise(t){return t=Ku(t),new t((r,o)=>{let i;this.subscribe(s=>i=s,s=>o(s),()=>r(i))})}}return n.create=e=>new n(e),n})();function Ku(n){var e;return(e=n??tt.Promise)!==null&&e!==void 0?e:Promise}function Qm(n){return n&&U(n.next)&&U(n.error)&&U(n.complete)}function Zm(n){return n&&n instanceof cn||Qm(n)&&ni(n)}function Ym(n){return U(n?.lift)}function Ce(n){return e=>{if(Ym(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function be(n,e,t,r,o){return new ka(n,e,t,r,o)}var ka=class extends cn{constructor(e,t,r,o,i,s){super(e),this.onFinalize=i,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=o?function(a){try{o(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};var Ju=Un(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var nt=(()=>{class n extends X{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new ii(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new Ju}next(t){qn(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){qn(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){qn(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:o,observers:i}=this;return r||o?Ma:(this.currentObservers=null,i.push(t),new ge(()=>{this.currentObservers=null,an(i,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:o,isStopped:i}=this;r?t.error(o):i&&t.complete()}asObservable(){let t=new X;return t.source=this,t}}return n.create=(e,t)=>new ii(e,t),n})(),ii=class extends nt{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:Ma}};var _e=class extends nt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var Oa={now(){return(Oa.delegate||Date).now()},delegate:void 0};var si=class extends ge{constructor(e,t){super()}schedule(e,t=0){return this}};var Or={setInterval(n,e,...t){let{delegate:r}=Or;return r?.setInterval?r.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=Or;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var ai=class extends si{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var r;if(this.closed)return this;this.state=e;let o=this.id,i=this.scheduler;return o!=null&&(this.id=this.recycleAsyncId(i,o,t)),this.pending=!0,this.delay=t,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(i,this.id,t),this}requestAsyncId(e,t,r=0){return Or.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return t;t!=null&&Or.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,t);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r=!1,o;try{this.work(e)}catch(i){r=!0,o=i||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),o}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,an(r,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var Gn=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}};Gn.now=Oa.now;var li=class extends Gn{constructor(e,t=Gn.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}};var Pa=new li(ai),Xu=Pa;function ci(n){return n&&U(n.schedule)}function ed(n){return n[n.length-1]}function td(n){return U(ed(n))?n.pop():void 0}function nd(n){return ci(ed(n))?n.pop():void 0}function od(n,e,t,r){function o(i){return i instanceof t?i:new t(function(s){s(i)})}return new(t||(t=Promise))(function(i,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?i(u.value):o(u.value).then(a,l)}c((r=r.apply(n,e||[])).next())})}function rd(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function un(n){return this instanceof un?(this.v=n,this):new un(n)}function id(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),o,i=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),o[Symbol.asyncIterator]=function(){return this},o;function s(f){return function(b){return Promise.resolve(b).then(f,d)}}function a(f,b){r[f]&&(o[f]=function(x){return new Promise(function(S,T){i.push([f,x,S,T])>1||l(f,x)})},b&&(o[f]=b(o[f])))}function l(f,b){try{c(r[f](b))}catch(x){p(i[0][3],x)}}function c(f){f.value instanceof un?Promise.resolve(f.value.v).then(u,d):p(i[0][2],f)}function u(f){l("next",f)}function d(f){l("throw",f)}function p(f,b){f(b),i.shift(),i.length&&l(i[0][0],i[0][1])}}function sd(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof rd=="function"?rd(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(i){t[i]=n[i]&&function(s){return new Promise(function(a,l){s=n[i](s),o(a,l,s.done,s.value)})}}function o(i,s,a,l){Promise.resolve(l).then(function(c){i({value:c,done:a})},s)}}var ui=n=>n&&typeof n.length=="number"&&typeof n!="function";function di(n){return U(n?.then)}function fi(n){return U(n[Wn])}function pi(n){return Symbol.asyncIterator&&U(n?.[Symbol.asyncIterator])}function hi(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function Km(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var mi=Km();function gi(n){return U(n?.[mi])}function yi(n){return id(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:o}=yield un(t.read());if(o)return yield un(void 0);yield yield un(r)}}finally{t.releaseLock()}})}function vi(n){return U(n?.getReader)}function we(n){if(n instanceof X)return n;if(n!=null){if(fi(n))return Jm(n);if(ui(n))return Xm(n);if(di(n))return eg(n);if(pi(n))return ad(n);if(gi(n))return tg(n);if(vi(n))return ng(n)}throw hi(n)}function Jm(n){return new X(e=>{let t=n[Wn]();if(U(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Xm(n){return new X(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function eg(n){return new X(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,ri)})}function tg(n){return new X(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function ad(n){return new X(e=>{rg(n,e).catch(t=>e.error(t))})}function ng(n){return ad(yi(n))}function rg(n,e){var t,r,o,i;return od(this,void 0,void 0,function*(){try{for(t=sd(n);r=yield t.next(),!r.done;){let s=r.value;if(e.next(s),e.closed)return}}catch(s){o={error:s}}finally{try{r&&!r.done&&(i=t.return)&&(yield i.call(t))}finally{if(o)throw o.error}}e.complete()})}function qe(n,e,t,r=0,o=!1){let i=e.schedule(function(){t(),o?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(i),!o)return i}function Ei(n,e=0){return Ce((t,r)=>{t.subscribe(be(r,o=>qe(r,n,()=>r.next(o),e),()=>qe(r,n,()=>r.complete(),e),o=>qe(r,n,()=>r.error(o),e)))})}function Di(n,e=0){return Ce((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function ld(n,e){return we(n).pipe(Di(e),Ei(e))}function cd(n,e){return we(n).pipe(Di(e),Ei(e))}function ud(n,e){return new X(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function dd(n,e){return new X(t=>{let r;return qe(t,e,()=>{r=n[mi](),qe(t,e,()=>{let o,i;try{({value:o,done:i}=r.next())}catch(s){t.error(s);return}i?t.complete():t.next(o)},0,!0)}),()=>U(r?.return)&&r.return()})}function Ci(n,e){if(!n)throw new Error("Iterable cannot be null");return new X(t=>{qe(t,e,()=>{let r=n[Symbol.asyncIterator]();qe(t,e,()=>{r.next().then(o=>{o.done?t.complete():t.next(o.value)})},0,!0)})})}function fd(n,e){return Ci(yi(n),e)}function pd(n,e){if(n!=null){if(fi(n))return ld(n,e);if(ui(n))return ud(n,e);if(di(n))return cd(n,e);if(pi(n))return Ci(n,e);if(gi(n))return dd(n,e);if(vi(n))return fd(n,e)}throw hi(n)}function Pr(n,e){return e?pd(n,e):we(n)}function bi(...n){let e=nd(n);return Pr(n,e)}var hd=Un(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function Fa(n,e){let t=typeof e=="object";return new Promise((r,o)=>{let i=new kt({next:s=>{r(s),i.unsubscribe()},error:o,complete:()=>{t?r(e.defaultValue):o(new hd)}});n.subscribe(i)})}function md(n){return n instanceof Date&&!isNaN(n)}function de(n,e){return Ce((t,r)=>{let o=0;t.subscribe(be(r,i=>{r.next(n.call(e,i,o++))}))})}var{isArray:og}=Array;function ig(n,e){return og(e)?n(...e):n(e)}function gd(n){return de(e=>ig(n,e))}var{isArray:sg}=Array,{getPrototypeOf:ag,prototype:lg,keys:cg}=Object;function yd(n){if(n.length===1){let e=n[0];if(sg(e))return{args:e,keys:null};if(ug(e)){let t=cg(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function ug(n){return n&&typeof n=="object"&&ag(n)===lg}function vd(n,e){return n.reduce((t,r,o)=>(t[r]=e[o],t),{})}function Ed(n,e,t,r,o,i,s,a){let l=[],c=0,u=0,d=!1,p=()=>{d&&!l.length&&!c&&e.complete()},f=x=>c<r?b(x):l.push(x),b=x=>{i&&e.next(x),c++;let S=!1;we(t(x,u++)).subscribe(be(e,T=>{o?.(T),i?f(T):e.next(T)},()=>{S=!0},void 0,()=>{if(S)try{for(c--;l.length&&c<r;){let T=l.shift();s?qe(e,s,()=>b(T)):b(T)}p()}catch(T){e.error(T)}}))};return n.subscribe(be(e,f,()=>{d=!0,p()})),()=>{a?.()}}function _i(n,e,t=1/0){return U(e)?_i((r,o)=>de((i,s)=>e(r,i,o,s))(we(n(r,o))),t):(typeof e=="number"&&(t=e),Ce((r,o)=>Ed(r,o,n,t)))}function La(...n){let e=td(n),{args:t,keys:r}=yd(n),o=new X(i=>{let{length:s}=t;if(!s){i.complete();return}let a=new Array(s),l=s,c=s;for(let u=0;u<s;u++){let d=!1;we(t[u]).subscribe(be(i,p=>{d||(d=!0,c--),a[u]=p},()=>l--,void 0,()=>{(!l||!d)&&(c||i.next(r?vd(r,a):a),i.complete())}))}});return e?o.pipe(gd(e)):o}function Dd(n=0,e,t=Xu){let r=-1;return e!=null&&(ci(e)?t=e:r=e),new X(o=>{let i=md(n)?+n-t.now():n;i<0&&(i=0);let s=0;return t.schedule(function(){o.closed||(o.next(s++),0<=r?this.schedule(void 0,r):o.complete())},i)})}function Va(n=0,e=Pa){return n<0&&(n=0),Dd(n,n,e)}function ja(n,e){return Ce((t,r)=>{let o=0;t.subscribe(be(r,i=>n.call(e,i,o++)&&r.next(i)))})}function Ba(n,e){return U(e)?_i(n,e,1):_i(n,1)}function Ha(n){return Ce((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function Ua(n,e){return Ce((t,r)=>{let o=null,i=0,s=!1,a=()=>s&&!o&&r.complete();t.subscribe(be(r,l=>{o?.unsubscribe();let c=0,u=i++;we(n(l,u)).subscribe(o=be(r,d=>r.next(e?e(l,d,u,c++):d),()=>{o=null,a()}))},()=>{s=!0,a()}))})}function wi(n){return Ce((e,t)=>{we(n).subscribe(be(t,()=>t.complete(),kr)),!t.closed&&e.subscribe(t)})}function Cd(n){let e=F(null);try{return n()}finally{F(e)}}var el="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",N=class extends Error{code;constructor(e,t){super(jr(e,t)),this.code=e}};function dg(n){return`NG0${Math.abs(n)}`}function jr(n,e){return`${dg(n)}${e?": "+e:""}`}function K(n){for(let e in n)if(n[e]===K)return e;throw Error("")}function wd(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function Ot(n){if(typeof n=="string")return n;if(Array.isArray(n))return`[${n.map(Ot).join(", ")}]`;if(n==null)return""+n;let e=n.overriddenName||n.name;if(e)return`${e}`;let t=n.toString();if(t==null)return""+t;let r=t.indexOf(`
`);return r>=0?t.slice(0,r):t}function Mi(n,e){return n?e?`${n} ${e}`:n:e||""}var fg=K({__forward_ref__:K});function it(n){return n.__forward_ref__=it,n.toString=function(){return Ot(this())},n}function ye(n){return tl(n)?n():n}function tl(n){return typeof n=="function"&&n.hasOwnProperty(fg)&&n.__forward_ref__===it}function I(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Tt(n){return{providers:n.providers||[],imports:n.imports||[]}}function xi(n){return pg(n,Ni)}function pg(n,e){return n.hasOwnProperty(e)&&n[e]||null}function hg(n){let e=n?.[Ni]??null;return e||null}function qa(n){return n&&n.hasOwnProperty(Si)?n[Si]:null}var Ni=K({\u0275prov:K}),Si=K({\u0275inj:K}),R=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=I({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function nl(n){return n&&!!n.\u0275providers}var rl=K({\u0275cmp:K}),ol=K({\u0275dir:K}),il=K({\u0275pipe:K});var Lr=K({\u0275fac:K}),mn=K({__NG_ELEMENT_ID__:K}),bd=K({__NG_ENV_ID__:K});function Qn(n){return typeof n=="string"?n:n==null?"":String(n)}function Id(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():Qn(n)}var Sd=K({ngErrorCode:K}),mg=K({ngErrorMessage:K}),gg=K({ngTokenPath:K});function sl(n,e){return Td("",-200,e)}function Ai(n,e){throw new N(-201,!1)}function Td(n,e,t){let r=new N(e,n);return r[Sd]=e,r[mg]=n,t&&(r[gg]=t),r}function yg(n){return n[Sd]}var Wa;function Md(){return Wa}function Te(n){let e=Wa;return Wa=n,e}function al(n,e,t){let r=xi(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&8)return null;if(e!==void 0)return e;Ai(n,"Injector")}var vg={},dn=vg,Eg="__NG_DI_FLAG__",Ga=class{injector;constructor(e){this.injector=e}retrieve(e,t){let r=fn(t)||0;try{return this.injector.get(e,r&8?null:dn,r)}catch(o){if(jn(o))return o;throw o}}};function Dg(n,e=0){let t=Bo();if(t===void 0)throw new N(-203,!1);if(t===null)return al(n,void 0,e);{let r=Cg(e),o=t.retrieve(n,r);if(jn(o)){if(r.optional)return null;throw o}return o}}function C(n,e=0){return(Md()||Dg)(ye(n),e)}function M(n,e){return C(n,fn(e))}function fn(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Cg(n){return{optional:!!(n&8),host:!!(n&1),self:!!(n&2),skipSelf:!!(n&4)}}function za(n){let e=[];for(let t=0;t<n.length;t++){let r=ye(n[t]);if(Array.isArray(r)){if(r.length===0)throw new N(900,!1);let o,i=0;for(let s=0;s<r.length;s++){let a=r[s],l=bg(a);typeof l=="number"?l===-1?o=a.token:i|=l:o=a}e.push(C(o,i))}else e.push(C(r))}return e}function bg(n){return n[Eg]}function Pt(n,e){let t=n.hasOwnProperty(Lr);return t?n[Lr]:null}function Ri(n,e){n.forEach(t=>Array.isArray(t)?Ri(t,e):e(t))}function ll(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Br(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function xd(n,e){let t=[];for(let r=0;r<n;r++)t.push(e);return t}function Nd(n,e,t,r){let o=n.length;if(o==e)n.push(t,r);else if(o===1)n.push(r,n[0]),n[0]=t;else{for(o--,n.push(n[o-1],n[o]);o>e;){let i=o-2;n[o]=n[i],o--}n[e]=t,n[e+1]=r}}function ki(n,e,t){let r=Zn(n,e);return r>=0?n[r|1]=t:(r=~r,Nd(n,r,e,t)),r}function Oi(n,e){let t=Zn(n,e);if(t>=0)return n[t|1]}function Zn(n,e){return _g(n,e,1)}function _g(n,e,t){let r=0,o=n.length>>t;for(;o!==r;){let i=r+(o-r>>1),s=n[i<<t];if(e===s)return i<<t;s>e?o=i:r=i+1}return~(o<<t)}var Lt={},Me=[],gn=new R(""),cl=new R("",-1),ul=new R(""),Vr=class{get(e,t=dn){if(t===dn){let o=Td("",-201);throw o.name="\u0275NotFound",o}return t}};function yn(n){return n[rl]||null}function dl(n){return n[ol]||null}function Ad(n){return n[il]||null}function Hr(n){return{\u0275providers:n}}function Rd(...n){return{\u0275providers:fl(!0,n),\u0275fromNgModule:!0}}function fl(n,...e){let t=[],r=new Set,o,i=s=>{t.push(s)};return Ri(e,s=>{let a=s;Ti(a,i,[],r)&&(o||=[],o.push(a))}),o!==void 0&&kd(o,i),t}function kd(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:o}=n[t];pl(o,i=>{e(i,r)})}}function Ti(n,e,t,r){if(n=ye(n),!n)return!1;let o=null,i=qa(n),s=!i&&yn(n);if(!i&&!s){let l=n.ngModule;if(i=qa(l),i)o=l;else return!1}else{if(s&&!s.standalone)return!1;o=n}let a=r.has(o);if(s){if(a)return!1;if(r.add(o),s.dependencies){let l=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let c of l)Ti(c,e,t,r)}}else if(i){if(i.imports!=null&&!a){r.add(o);let c;try{Ri(i.imports,u=>{Ti(u,e,t,r)&&(c||=[],c.push(u))})}finally{}c!==void 0&&kd(c,e)}if(!a){let c=Pt(o)||(()=>new o);e({provide:o,useFactory:c,deps:Me},o),e({provide:ul,useValue:o,multi:!0},o),e({provide:gn,useValue:()=>C(o),multi:!0},o)}let l=i.providers;if(l!=null&&!a){let c=n;pl(l,u=>{e(u,c)})}}else return!1;return o!==n&&n.providers!==void 0}function pl(n,e){for(let t of n)nl(t)&&(t=t.\u0275providers),Array.isArray(t)?pl(t,e):e(t)}var wg=K({provide:String,useValue:K});function Od(n){return n!==null&&typeof n=="object"&&wg in n}function Ig(n){return!!(n&&n.useExisting)}function Sg(n){return!!(n&&n.useFactory)}function pn(n){return typeof n=="function"}function Pd(n){return!!n.useClass}var Ur=new R(""),Ii={},_d={},$a;function $r(){return $a===void 0&&($a=new Vr),$a}var Ae=class{},hn=class extends Ae{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,r,o){super(),this.parent=t,this.source=r,this.scopes=o,Za(e,s=>this.processProvider(s)),this.records.set(cl,zn(void 0,this)),o.has("environment")&&this.records.set(Ae,zn(void 0,this));let i=this.records.get(Ur);i!=null&&typeof i.value=="string"&&this.scopes.add(i.value),this.injectorDefTypes=new Set(this.get(ul,Me,{self:!0}))}retrieve(e,t){let r=fn(t)||0;try{return this.get(e,dn,r)}catch(o){if(jn(o))return o;throw o}}destroy(){Fr(this),this._destroyed=!0;let e=F(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),F(e)}}onDestroy(e){return Fr(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){Fr(this);let t=dt(this),r=Te(void 0),o;try{return e()}finally{dt(t),Te(r)}}get(e,t=dn,r){if(Fr(this),e.hasOwnProperty(bd))return e[bd](this);let o=fn(r),i,s=dt(this),a=Te(void 0);try{if(!(o&4)){let c=this.records.get(e);if(c===void 0){let u=Ag(e)&&xi(e);u&&this.injectableDefInScope(u)?c=zn(Qa(e),Ii):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c,o)}let l=o&2?$r():this.parent;return t=o&8&&t===dn?null:t,l.get(e,t)}catch(l){let c=yg(l);throw c===-200||c===-201?new N(c,null):l}finally{Te(a),dt(s)}}resolveInjectorInitializers(){let e=F(null),t=dt(this),r=Te(void 0),o;try{let i=this.get(gn,Me,{self:!0});for(let s of i)s()}finally{dt(t),Te(r),F(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(Ot(r));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=ye(e);let t=pn(e)?e:ye(e&&e.provide),r=Mg(e);if(!pn(e)&&e.multi===!0){let o=this.records.get(t);o||(o=zn(void 0,Ii,!0),o.factory=()=>za(o.multi),this.records.set(t,o)),t=e,o.multi.push(e)}this.records.set(t,r)}hydrate(e,t,r){let o=F(null);try{if(t.value===_d)throw sl(Ot(e));return t.value===Ii&&(t.value=_d,t.value=t.factory(void 0,r)),typeof t.value=="object"&&t.value&&Ng(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{F(o)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=ye(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function Qa(n){let e=xi(n),t=e!==null?e.factory:Pt(n);if(t!==null)return t;if(n instanceof R)throw new N(204,!1);if(n instanceof Function)return Tg(n);throw new N(204,!1)}function Tg(n){if(n.length>0)throw new N(204,!1);let t=hg(n);return t!==null?()=>t.factory(n):()=>new n}function Mg(n){if(Od(n))return zn(void 0,n.useValue);{let e=hl(n);return zn(e,Ii)}}function hl(n,e,t){let r;if(pn(n)){let o=ye(n);return Pt(o)||Qa(o)}else if(Od(n))r=()=>ye(n.useValue);else if(Sg(n))r=()=>n.useFactory(...za(n.deps||[]));else if(Ig(n))r=(o,i)=>C(ye(n.useExisting),i!==void 0&&i&8?8:void 0);else{let o=ye(n&&(n.useClass||n.provide));if(xg(n))r=()=>new o(...za(n.deps));else return Pt(o)||Qa(o)}return r}function Fr(n){if(n.destroyed)throw new N(205,!1)}function zn(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function xg(n){return!!n.deps}function Ng(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function Ag(n){return typeof n=="function"||typeof n=="object"&&n.ngMetadataName==="InjectionToken"}function Za(n,e){for(let t of n)Array.isArray(t)?Za(t,e):t&&nl(t)?Za(t.\u0275providers,e):e(t)}function Yn(n,e){let t;n instanceof hn?(Fr(n),t=n):t=new Ga(n);let r,o=dt(t),i=Te(void 0);try{return e()}finally{dt(o),Te(i)}}function Fd(){return Md()!==void 0||Bo()!=null}var st=0,O=1,P=2,ve=3,We=4,xe=5,Kn=6,Jn=7,Ie=8,Vt=9,Mt=10,J=11,Xn=12,ml=13,vn=14,Re=15,En=16,Dn=17,Cn=18,qr=19,gl=20,It=21,Pi=22,Wr=23,Be=24,bn=25,Gr=26,oe=27,Ld=1;var jt=7,zr=8,Qr=9,ke=10;function ft(n){return Array.isArray(n)&&typeof n[Ld]=="object"}function at(n){return Array.isArray(n)&&n[Ld]===!0}function yl(n){return(n.flags&4)!==0}function Bt(n){return n.componentOffset>-1}function er(n){return(n.flags&1)===1}function pt(n){return!!n.template}function tr(n){return(n[P]&512)!==0}function _n(n){return(n[P]&256)===256}var Vd="svg",jd="math";function Ge(n){for(;Array.isArray(n);)n=n[st];return n}function vl(n,e){return Ge(e[n])}function lt(n,e){return Ge(e[n.index])}function Fi(n,e){return n.data[e]}function El(n,e){return n[e]}function Dl(n,e,t,r){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=r}function ze(n,e){let t=e[n];return ft(t)?t:t[st]}function Li(n){return(n[P]&128)===128}function Bd(n){return at(n[ve])}function Ht(n,e){return e==null?null:n[e]}function Cl(n){n[Dn]=0}function bl(n){n[P]&1024||(n[P]|=1024,Li(n)&&nr(n))}function Hd(n,e){for(;n>0;)e=e[vn],n--;return e}function Zr(n){return!!(n[P]&9216||n[Be]?.dirty)}function Vi(n){n[Mt].changeDetectionScheduler?.notify(8),n[P]&64&&(n[P]|=1024),Zr(n)&&nr(n)}function nr(n){n[Mt].changeDetectionScheduler?.notify(0);let e=Ft(n);for(;e!==null&&!(e[P]&8192||(e[P]|=8192,!Li(e)));)e=Ft(e)}function _l(n,e){if(_n(n))throw new N(911,!1);n[It]===null&&(n[It]=[]),n[It].push(e)}function Ud(n,e){if(n[It]===null)return;let t=n[It].indexOf(e);t!==-1&&n[It].splice(t,1)}function Ft(n){let e=n[ve];return at(e)?e[ve]:e}function $d(n){return n[Jn]??=[]}function qd(n){return n.cleanup??=[]}var V={lFrame:nf(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var Ya=!1;function Wd(){return V.lFrame.elementDepthCount}function Gd(){V.lFrame.elementDepthCount++}function wl(){V.lFrame.elementDepthCount--}function ji(){return V.bindingsEnabled}function Il(){return V.skipHydrationRootTNode!==null}function Sl(n){return V.skipHydrationRootTNode===n}function Tl(){V.skipHydrationRootTNode=null}function L(){return V.lFrame.lView}function le(){return V.lFrame.tView}function j(n){return V.lFrame.contextLView=n,n[Ie]}function B(n){return V.lFrame.contextLView=null,n}function fe(){let n=Ml();for(;n!==null&&n.type===64;)n=n.parent;return n}function Ml(){return V.lFrame.currentTNode}function zd(){let n=V.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function rr(n,e){let t=V.lFrame;t.currentTNode=n,t.isParent=e}function xl(){return V.lFrame.isParent}function Nl(){V.lFrame.isParent=!1}function Qd(){return V.lFrame.contextLView}function Al(){return Ya}function Rl(n){let e=Ya;return Ya=n,e}function wn(){let n=V.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function Zd(){return V.lFrame.bindingIndex}function Yd(n){return V.lFrame.bindingIndex=n}function or(){return V.lFrame.bindingIndex++}function Bi(n){let e=V.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function Kd(){return V.lFrame.inI18n}function Jd(n,e){let t=V.lFrame;t.bindingIndex=t.bindingRootIndex=n,Hi(e)}function Xd(){return V.lFrame.currentDirectiveIndex}function Hi(n){V.lFrame.currentDirectiveIndex=n}function ef(n){let e=V.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function kl(n){V.lFrame.currentQueryIndex=n}function Rg(n){let e=n[O];return e.type===2?e.declTNode:e.type===1?n[xe]:null}function Ol(n,e,t){if(t&4){let o=e,i=n;for(;o=o.parent,o===null&&!(t&1);)if(o=Rg(i),o===null||(i=i[vn],o.type&10))break;if(o===null)return!1;e=o,n=i}let r=V.lFrame=tf();return r.currentTNode=e,r.lView=n,!0}function Ui(n){let e=tf(),t=n[O];V.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function tf(){let n=V.lFrame,e=n===null?null:n.child;return e===null?nf(n):e}function nf(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function rf(){let n=V.lFrame;return V.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var Pl=rf;function $i(){let n=rf();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function of(n){return(V.lFrame.contextLView=Hd(n,V.lFrame.contextLView))[Ie]}function xt(){return V.lFrame.selectedIndex}function Ut(n){V.lFrame.selectedIndex=n}function Yr(){let n=V.lFrame;return Fi(n.tView,n.selectedIndex)}function sf(){return V.lFrame.currentNamespace}var af=!0;function qi(){return af}function Kr(n){af=n}function Ka(n,e=null,t=null,r){let o=lf(n,e,t,r);return o.resolveInjectorInitializers(),o}function lf(n,e=null,t=null,r,o=new Set){let i=[t||Me,Rd(n)];return r=r||(typeof n=="object"?void 0:Ot(n)),new hn(i,e||$r(),r||null,o)}var rt=class n{static THROW_IF_NOT_FOUND=dn;static NULL=new Vr;static create(e,t){if(Array.isArray(e))return Ka({name:""},t,e,"");{let r=e.name??"";return Ka({name:r},e.parent,e.providers,r)}}static \u0275prov=I({token:n,providedIn:"any",factory:()=>C(cl)});static __NG_ELEMENT_ID__=-1},He=new R(""),$t=(()=>{class n{static __NG_ELEMENT_ID__=kg;static __NG_ENV_ID__=t=>t}return n})(),Ja=class extends $t{_lView;constructor(e){super(),this._lView=e}get destroyed(){return _n(this._lView)}onDestroy(e){let t=this._lView;return _l(t,e),()=>Ud(t,e)}};function kg(){return new Ja(L())}var ot=class{_console=console;handleError(e){this._console.error("ERROR",e)}},ht=new R("",{providedIn:"root",factory:()=>{let n=M(Ae),e;return t=>{n.destroyed&&!e?setTimeout(()=>{throw t}):(e??=n.get(ot),e.handleError(t))}}}),cf={provide:gn,useValue:()=>void M(ot),multi:!0};function Fl(n){return typeof n=="function"&&n[Ne]!==void 0}function In(n,e){let[t,r,o]=Sa(n,e?.equal),i=t,s=i[Ne];return i.set=r,i.update=o,i.asReadonly=uf.bind(i),i}function uf(){let n=this[Ne];if(n.readonlyFn===void 0){let e=()=>this();e[Ne]=n,n.readonlyFn=e}return n.readonlyFn}function Ll(n){return Fl(n)&&typeof n.set=="function"}var Wi=(()=>{class n{view;node;constructor(t,r){this.view=t,this.node=r}static __NG_ELEMENT_ID__=Og}return n})();function Og(){return new Wi(L(),fe())}var St=class{},Jr=new R("",{providedIn:"root",factory:()=>!1});var Vl=new R(""),jl=new R(""),qt=(()=>{class n{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new _e(!1);get hasPendingTasks(){return this.destroyed?!1:this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new X(t=>{t.next(!1),t.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=I({token:n,providedIn:"root",factory:()=>new n})}return n})(),Gi=(()=>{class n{internalPendingTasks=M(qt);scheduler=M(St);errorHandler=M(ht);add(){let t=this.internalPendingTasks.add();return()=>{this.internalPendingTasks.has(t)&&(this.scheduler.notify(11),this.internalPendingTasks.remove(t))}}run(t){let r=this.add();t().catch(this.errorHandler).finally(r)}static \u0275prov=I({token:n,providedIn:"root",factory:()=>new n})}return n})();function Xr(...n){}var Bl=(()=>{class n{static \u0275prov=I({token:n,providedIn:"root",factory:()=>new Xa})}return n})(),Xa=class{dirtyEffectCount=0;queues=new Map;add(e){this.enqueue(e),this.schedule(e)}schedule(e){e.dirty&&this.dirtyEffectCount++}remove(e){let t=e.zone,r=this.queues.get(t);r.has(e)&&(r.delete(e),e.dirty&&this.dirtyEffectCount--)}enqueue(e){let t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);let r=this.queues.get(t);r.has(e)||r.add(e)}flush(){for(;this.dirtyEffectCount>0;){let e=!1;for(let[t,r]of this.queues)t===null?e||=this.flushQueue(r):e||=t.run(()=>this.flushQueue(r));e||(this.dirtyEffectCount=0)}}flushQueue(e){let t=!1;for(let r of e)r.dirty&&(this.dirtyEffectCount--,t=!0,r.run());return t}};function ao(n){return{toString:n}.toString()}function qg(n){return typeof n=="function"}var Ji=class{previousValue;currentValue;firstChange;constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function Lf(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}var fs=(()=>{let n=()=>Vf;return n.ngInherit=!0,n})();function Vf(n){return n.type.prototype.ngOnChanges&&(n.setInput=Gg),Wg}function Wg(){let n=Bf(this),e=n?.current;if(e){let t=n.previous;if(t===Lt)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function Gg(n,e,t,r,o){let i=this.declaredInputs[r],s=Bf(n)||zg(n,{previous:Lt,current:null}),a=s.current||(s.current={}),l=s.previous,c=l[i];a[i]=new Ji(c&&c.currentValue,t,l===Lt),Lf(n,e,o,t)}var jf="__ngSimpleChanges__";function Bf(n){return n[jf]||null}function zg(n,e){return n[jf]=e}var df=[];var z=function(n,e=null,t){for(let r=0;r<df.length;r++){let o=df[r];o(n,e,t)}};function Qg(n,e,t){let{ngOnChanges:r,ngOnInit:o,ngDoCheck:i}=e.type.prototype;if(r){let s=Vf(e);(t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s)}o&&(t.preOrderHooks??=[]).push(0-n,o),i&&((t.preOrderHooks??=[]).push(n,i),(t.preOrderCheckHooks??=[]).push(n,i))}function Hf(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let i=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=i;s&&(n.contentHooks??=[]).push(-t,s),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),l&&(n.viewHooks??=[]).push(-t,l),c&&((n.viewHooks??=[]).push(t,c),(n.viewCheckHooks??=[]).push(t,c)),u!=null&&(n.destroyHooks??=[]).push(t,u)}}function Qi(n,e,t){Uf(n,e,3,t)}function Zi(n,e,t,r){(n[P]&3)===t&&Uf(n,e,t,r)}function Hl(n,e){let t=n[P];(t&3)===e&&(t&=16383,t+=1,n[P]=t)}function Uf(n,e,t,r){let o=r!==void 0?n[Dn]&65535:0,i=r??-1,s=e.length-1,a=0;for(let l=o;l<s;l++)if(typeof e[l+1]=="number"){if(a=e[l],r!=null&&a>=r)break}else e[l]<0&&(n[Dn]+=65536),(a<i||i==-1)&&(Zg(n,t,e,l),n[Dn]=(n[Dn]&4294901760)+l+2),l++}function ff(n,e){z(4,n,e);let t=F(null);try{e.call(n)}finally{F(t),z(5,n,e)}}function Zg(n,e,t,r){let o=t[r]<0,i=t[r+1],s=o?-t[r]:t[r],a=n[s];o?n[P]>>14<n[Dn]>>16&&(n[P]&3)===e&&(n[P]+=16384,ff(a,i)):ff(a,i)}var sr=-1,Tn=class{factory;name;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,r,o){this.factory=e,this.name=o,this.canSeeViewProviders=t,this.injectImpl=r}};function Yg(n){return(n.flags&8)!==0}function Kg(n){return(n.flags&16)!==0}function Jg(n,e,t){let r=0;for(;r<t.length;){let o=t[r];if(typeof o=="number"){if(o!==0)break;r++;let i=t[r++],s=t[r++],a=t[r++];n.setAttribute(e,s,a,i)}else{let i=o,s=t[++r];ey(i)?n.setProperty(e,i,s):n.setAttribute(e,i,s),r++}}return r}function Xg(n){return n===3||n===4||n===6}function ey(n){return n.charCodeAt(0)===64}function ar(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let o=e[r];typeof o=="number"?t=o:t===0||(t===-1||t===2?pf(n,t,o,null,e[++r]):pf(n,t,o,null,null))}}return n}function pf(n,e,t,r,o){let i=0,s=n.length;if(e===-1)s=-1;else for(;i<n.length;){let a=n[i++];if(typeof a=="number"){if(a===e){s=-1;break}else if(a>e){s=i-1;break}}}for(;i<n.length;){let a=n[i];if(typeof a=="number")break;if(a===t){o!==null&&(n[i+1]=o);return}i++,o!==null&&i++}s!==-1&&(n.splice(s,0,e),i=s+1),n.splice(i++,0,t),o!==null&&n.splice(i++,0,o)}function $f(n){return n!==sr}function Xi(n){return n&32767}function ty(n){return n>>16}function es(n,e){let t=ty(n),r=e;for(;t>0;)r=r[vn],t--;return r}var Yl=!0;function ts(n){let e=Yl;return Yl=n,e}var ny=256,qf=ny-1,Wf=5,ry=0,mt={};function oy(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(mn)&&(r=t[mn]),r==null&&(r=t[mn]=ry++);let o=r&qf,i=1<<o;e.data[n+(o>>Wf)]|=i}function ns(n,e){let t=Gf(n,e);if(t!==-1)return t;let r=e[O];r.firstCreatePass&&(n.injectorIndex=e.length,Ul(r.data,n),Ul(e,null),Ul(r.blueprint,null));let o=Dc(n,e),i=n.injectorIndex;if($f(o)){let s=Xi(o),a=es(o,e),l=a[O].data;for(let c=0;c<8;c++)e[i+c]=a[s+c]|l[s+c]}return e[i+8]=o,i}function Ul(n,e){n.push(0,0,0,0,0,0,0,0,e)}function Gf(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function Dc(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,o=e;for(;o!==null;){if(r=Kf(o),r===null)return sr;if(t++,o=o[vn],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return sr}function Kl(n,e,t){oy(n,e,t)}function zf(n,e,t){if(t&8||n!==void 0)return n;Ai(e,"NodeInjector")}function Qf(n,e,t,r){if(t&8&&r===void 0&&(r=null),(t&3)===0){let o=n[Vt],i=Te(void 0);try{return o?o.get(e,r,t&8):al(e,r,t&8)}finally{Te(i)}}return zf(r,e,t)}function Zf(n,e,t,r=0,o){if(n!==null){if(e[P]&2048&&!(r&2)){let s=cy(n,e,t,r,mt);if(s!==mt)return s}let i=Yf(n,e,t,r,mt);if(i!==mt)return i}return Qf(e,t,r,o)}function Yf(n,e,t,r,o){let i=ay(t);if(typeof i=="function"){if(!Ol(e,n,r))return r&1?zf(o,t,r):Qf(e,t,r,o);try{let s;if(s=i(r),s==null&&!(r&8))Ai(t);else return s}finally{Pl()}}else if(typeof i=="number"){let s=null,a=Gf(n,e),l=sr,c=r&1?e[Re][xe]:null;for((a===-1||r&4)&&(l=a===-1?Dc(n,e):e[a+8],l===sr||!mf(r,!1)?a=-1:(s=e[O],a=Xi(l),e=es(l,e)));a!==-1;){let u=e[O];if(hf(i,a,u.data)){let d=iy(a,e,t,s,r,c);if(d!==mt)return d}l=e[a+8],l!==sr&&mf(r,e[O].data[a+8]===c)&&hf(i,a,e)?(s=u,a=Xi(l),e=es(l,e)):a=-1}}return o}function iy(n,e,t,r,o,i){let s=e[O],a=s.data[n+8],l=r==null?Bt(a)&&Yl:r!=s&&(a.type&3)!==0,c=o&1&&i===a,u=sy(a,s,t,l,c);return u!==null?rs(e,s,u,a,o):mt}function sy(n,e,t,r,o){let i=n.providerIndexes,s=e.data,a=i&1048575,l=n.directiveStart,c=n.directiveEnd,u=i>>20,d=r?a:a+u,p=o?a+u:c;for(let f=d;f<p;f++){let b=s[f];if(f<l&&t===b||f>=l&&b.type===t)return f}if(o){let f=s[l];if(f&&pt(f)&&f.type===t)return l}return null}function rs(n,e,t,r,o){let i=n[t],s=e.data;if(i instanceof Tn){let a=i;if(a.resolving){let f=Id(s[t]);throw sl(f)}let l=ts(a.canSeeViewProviders);a.resolving=!0;let c=s[t].type||s[t],u,d=a.injectImpl?Te(a.injectImpl):null,p=Ol(n,r,0);try{i=n[t]=a.factory(void 0,o,s,n,r),e.firstCreatePass&&t>=r.directiveStart&&Qg(t,s[t],e)}finally{d!==null&&Te(d),ts(l),a.resolving=!1,Pl()}}return i}function ay(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(mn)?n[mn]:void 0;return typeof e=="number"?e>=0?e&qf:ly:e}function hf(n,e,t){let r=1<<n;return!!(t[e+(n>>Wf)]&r)}function mf(n,e){return!(n&2)&&!(n&1&&e)}var Sn=class{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return Zf(this._tNode,this._lView,e,fn(r),t)}};function ly(){return new Sn(fe(),L())}function dr(n){return ao(()=>{let e=n.prototype.constructor,t=e[Lr]||Jl(e),r=Object.prototype,o=Object.getPrototypeOf(n.prototype).constructor;for(;o&&o!==r;){let i=o[Lr]||Jl(o);if(i&&i!==t)return i;o=Object.getPrototypeOf(o)}return i=>new i})}function Jl(n){return tl(n)?()=>{let e=Jl(ye(n));return e&&e()}:Pt(n)}function cy(n,e,t,r,o){let i=n,s=e;for(;i!==null&&s!==null&&s[P]&2048&&!tr(s);){let a=Yf(i,s,t,r|2,mt);if(a!==mt)return a;let l=i.parent;if(!l){let c=s[gl];if(c){let u=c.get(t,mt,r);if(u!==mt)return u}l=Kf(s),s=s[vn]}i=l}return o}function Kf(n){let e=n[O],t=e.type;return t===2?e.declTNode:t===1?n[xe]:null}function uy(){return ps(fe(),L())}function ps(n,e){return new At(lt(n,e))}var At=(()=>{class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=uy}return n})();function Jf(n){return(n.flags&128)===128}var Cc=(function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n})(Cc||{}),Xf=new Map,dy=0;function fy(){return dy++}function py(n){Xf.set(n[qr],n)}function Xl(n){Xf.delete(n[qr])}var gf="__ngContext__";function lr(n,e){ft(e)?(n[gf]=e[qr],py(e)):n[gf]=e}function ep(n){return np(n[Xn])}function tp(n){return np(n[We])}function np(n){for(;n!==null&&!at(n);)n=n[We];return n}var ec;function bc(n){ec=n}function rp(){if(ec!==void 0)return ec;if(typeof document<"u")return document;throw new N(210,!1)}var hs=new R("",{providedIn:"root",factory:()=>hy}),hy="ng",ms=new R(""),lo=new R("",{providedIn:"platform",factory:()=>"unknown"});var gs=new R("",{providedIn:"root",factory:()=>rp().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var my="h",gy="b";var op=!1,ip=new R("",{providedIn:"root",factory:()=>op});var yy=(n,e,t,r)=>{};function vy(n,e,t,r){yy(n,e,t,r)}function ys(n){return(n.flags&32)===32}var Ey=()=>null;function sp(n,e,t=!1){return Ey(n,e,t)}function ap(n,e){let t=n.contentQueries;if(t!==null){let r=F(null);try{for(let o=0;o<t.length;o+=2){let i=t[o],s=t[o+1];if(s!==-1){let a=n.data[s];kl(i),a.contentQueries(2,e[s],s)}}}finally{F(r)}}}function tc(n,e,t){kl(0);let r=F(null);try{e(n,t)}finally{F(r)}}function _c(n,e,t){if(yl(e)){let r=F(null);try{let o=e.directiveStart,i=e.directiveEnd;for(let s=o;s<i;s++){let a=n.data[s];if(a.contentQueries){let l=t[s];a.contentQueries(1,l,s)}}}finally{F(r)}}}var Nt=(function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n})(Nt||{});var nc=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${el})`}};function wc(n){return n instanceof nc?n.changingThisBreaksApplicationSecurity:n}var Dy=/^>|^->|<!--|-->|--!>|<!-$/g,Cy=/(<|>)/g,by="\u200B$1\u200B";function _y(n){return n.replace(Dy,e=>e.replace(Cy,by))}function wy(n,e,t){let r=n.length;for(;;){let o=n.indexOf(e,t);if(o===-1)return o;if(o===0||n.charCodeAt(o-1)<=32){let i=e.length;if(o+i===r||n.charCodeAt(o+i)<=32)return o}t=o+1}}var lp="ng-template";function Iy(n,e,t,r){let o=0;if(r){for(;o<e.length&&typeof e[o]=="string";o+=2)if(e[o]==="class"&&wy(e[o+1].toLowerCase(),t,0)!==-1)return!0}else if(Ic(n))return!1;if(o=e.indexOf(1,o),o>-1){let i;for(;++o<e.length&&typeof(i=e[o])=="string";)if(i.toLowerCase()===t)return!0}return!1}function Ic(n){return n.type===4&&n.value!==lp}function Sy(n,e,t){let r=n.type===4&&!t?lp:n.value;return e===r}function Ty(n,e,t){let r=4,o=n.attrs,i=o!==null?Ny(o):0,s=!1;for(let a=0;a<e.length;a++){let l=e[a];if(typeof l=="number"){if(!s&&!ct(r)&&!ct(l))return!1;if(s&&ct(l))continue;s=!1,r=l|r&1;continue}if(!s)if(r&4){if(r=2|r&1,l!==""&&!Sy(n,l,t)||l===""&&e.length===1){if(ct(r))return!1;s=!0}}else if(r&8){if(o===null||!Iy(n,o,l,t)){if(ct(r))return!1;s=!0}}else{let c=e[++a],u=My(l,o,Ic(n),t);if(u===-1){if(ct(r))return!1;s=!0;continue}if(c!==""){let d;if(u>i?d="":d=o[u+1].toLowerCase(),r&2&&c!==d){if(ct(r))return!1;s=!0}}}}return ct(r)||s}function ct(n){return(n&1)===0}function My(n,e,t,r){if(e===null)return-1;let o=0;if(r||!t){let i=!1;for(;o<e.length;){let s=e[o];if(s===n)return o;if(s===3||s===6)i=!0;else if(s===1||s===2){let a=e[++o];for(;typeof a=="string";)a=e[++o];continue}else{if(s===4)break;if(s===0){o+=4;continue}}o+=i?1:2}return-1}else return Ay(e,n)}function cp(n,e,t=!1){for(let r=0;r<e.length;r++)if(Ty(n,e[r],t))return!0;return!1}function xy(n){let e=n.attrs;if(e!=null){let t=e.indexOf(5);if((t&1)===0)return e[t+1]}return null}function Ny(n){for(let e=0;e<n.length;e++){let t=n[e];if(Xg(t))return e}return n.length}function Ay(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function Ry(n,e){e:for(let t=0;t<e.length;t++){let r=e[t];if(n.length===r.length){for(let o=0;o<n.length;o++)if(n[o]!==r[o])continue e;return!0}}return!1}function yf(n,e){return n?":not("+e.trim()+")":e}function ky(n){let e=n[0],t=1,r=2,o="",i=!1;for(;t<n.length;){let s=n[t];if(typeof s=="string")if(r&2){let a=n[++t];o+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else r&8?o+="."+s:r&4&&(o+=" "+s);else o!==""&&!ct(s)&&(e+=yf(i,o),o=""),r=s,i=i||!ct(r);t++}return o!==""&&(e+=yf(i,o)),e}function Oy(n){return n.map(ky).join(",")}function Py(n){let e=[],t=[],r=1,o=2;for(;r<n.length;){let i=n[r];if(typeof i=="string")o===2?i!==""&&e.push(i,n[++r]):o===8&&t.push(i);else{if(!ct(o))break;o=i}r++}return t.length&&e.push(1,...t),e}var Oe={};function Fy(n,e){return n.createText(e)}function Ly(n,e,t){n.setValue(e,t)}function Vy(n,e){return n.createComment(_y(e))}function up(n,e,t){return n.createElement(e,t)}function os(n,e,t,r,o){n.insertBefore(e,t,r,o)}function dp(n,e,t){n.appendChild(e,t)}function vf(n,e,t,r,o){r!==null?os(n,e,t,r,o):dp(n,e,t)}function jy(n,e,t,r){n.removeChild(null,e,t,r)}function By(n,e,t){n.setAttribute(e,"style",t)}function Hy(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function fp(n,e,t){let{mergedAttrs:r,classes:o,styles:i}=t;r!==null&&Jg(n,e,r),o!==null&&Hy(n,e,o),i!==null&&By(n,e,i)}function Sc(n,e,t,r,o,i,s,a,l,c,u){let d=oe+r,p=d+o,f=Uy(d,p),b=typeof c=="function"?c():c;return f[O]={type:n,blueprint:f,template:t,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:p,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof i=="function"?i():i,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:l,consts:b,incompleteFirstPass:!1,ssrId:u}}function Uy(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:Oe);return t}function $y(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=Sc(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function Tc(n,e,t,r,o,i,s,a,l,c,u){let d=e.blueprint.slice();return d[st]=o,d[P]=r|4|128|8|64|1024,(c!==null||n&&n[P]&2048)&&(d[P]|=2048),Cl(d),d[ve]=d[vn]=n,d[Ie]=t,d[Mt]=s||n&&n[Mt],d[J]=a||n&&n[J],d[Vt]=l||n&&n[Vt]||null,d[xe]=i,d[qr]=fy(),d[Kn]=u,d[gl]=c,d[Re]=e.type==2?n[Re]:d,d}function qy(n,e,t){let r=lt(e,n),o=$y(t),i=n[Mt].rendererFactory,s=Mc(n,Tc(n,o,null,pp(t),r,e,null,i.createRenderer(r,t),null,null,null));return n[e.index]=s}function pp(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function hp(n,e,t,r){if(t===0)return-1;let o=e.length;for(let i=0;i<t;i++)e.push(r),n.blueprint.push(r),n.data.push(null);return o}function Mc(n,e){return n[Xn]?n[ml][We]=e:n[Xn]=e,n[ml]=e,e}function m(n=1){mp(le(),L(),xt()+n,!1)}function mp(n,e,t,r){if(!r)if((e[P]&3)===3){let i=n.preOrderCheckHooks;i!==null&&Qi(e,i,t)}else{let i=n.preOrderHooks;i!==null&&Zi(e,i,0,t)}Ut(t)}var vs=(function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n})(vs||{});function rc(n,e,t,r){let o=F(null);try{let[i,s,a]=n.inputs[t],l=null;(s&vs.SignalBased)!==0&&(l=e[i][Ne]),l!==null&&l.transformFn!==void 0?r=l.transformFn(r):a!==null&&(r=a.call(e,r)),n.setInput!==null?n.setInput(e,l,r,t,i):Lf(e,l,i,r)}finally{F(o)}}var gt=(function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n})(gt||{}),Wy;function xc(n,e){return Wy(n,e)}var cr=new Set,Es=(function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n})(Es||{}),Nn=new R(""),Ef=new Set;function Ds(n){Ef.has(n)||(Ef.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var gp=!1,oc=class extends nt{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,Fd()&&(this.destroyRef=M($t,{optional:!0})??void 0,this.pendingTasks=M(qt,{optional:!0})??void 0)}emit(e){let t=F(null);try{super.next(e)}finally{F(t)}}subscribe(e,t,r){let o=e,i=t||(()=>null),s=r;if(e&&typeof e=="object"){let l=e;o=l.next?.bind(l),i=l.error?.bind(l),s=l.complete?.bind(l)}this.__isAsync&&(i=this.wrapInTimeout(i),o&&(o=this.wrapInTimeout(o)),s&&(s=this.wrapInTimeout(s)));let a=super.subscribe({next:o,error:i,complete:s});return e instanceof ge&&e.add(a),a}wrapInTimeout(e){return t=>{let r=this.pendingTasks?.add();setTimeout(()=>{try{e(t)}finally{r!==void 0&&this.pendingTasks?.remove(r)}})}}},pe=oc;function yp(n){let e,t;function r(){n=Xr;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),r()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),r()})),()=>r()}function Df(n){return queueMicrotask(()=>n()),()=>{n=Xr}}var Nc="isAngularZone",is=Nc+"_ID",Gy=0,se=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new pe(!1);onMicrotaskEmpty=new pe(!1);onStable=new pe(!1);onError=new pe(!1);constructor(e){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:o=!1,scheduleInRootZone:i=gp}=e;if(typeof Zone>"u")throw new N(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!o&&r,s.shouldCoalesceRunChangeDetection=o,s.callbackScheduled=!1,s.scheduleInRootZone=i,Zy(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(Nc)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new N(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new N(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,o){let i=this._inner,s=i.scheduleEventTask("NgZoneEvent: "+o,e,zy,Xr,Xr);try{return i.runTask(s,t,r)}finally{i.cancelTask(s)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},zy={};function Ac(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function Qy(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){yp(()=>{n.callbackScheduled=!1,ic(n),n.isCheckStableRunning=!0,Ac(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),ic(n)}function Zy(n){let e=()=>{Qy(n)},t=Gy++;n._inner=n._inner.fork({name:"angular",properties:{[Nc]:!0,[is]:t,[is+t]:!0},onInvokeTask:(r,o,i,s,a,l)=>{if(Yy(l))return r.invokeTask(i,s,a,l);try{return Cf(n),r.invokeTask(i,s,a,l)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),bf(n)}},onInvoke:(r,o,i,s,a,l,c)=>{try{return Cf(n),r.invoke(i,s,a,l,c)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!Ky(l)&&e(),bf(n)}},onHasTask:(r,o,i,s)=>{r.hasTask(i,s),o===i&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,ic(n),Ac(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(r,o,i,s)=>(r.handleError(i,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function ic(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function Cf(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function bf(n){n._nesting--,Ac(n)}var ss=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new pe;onMicrotaskEmpty=new pe;onStable=new pe;onError=new pe;run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,o){return e.apply(t,r)}};function Yy(n){return vp(n,"__ignore_ng_zone__")}function Ky(n){return vp(n,"__scheduler_tick__")}function vp(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var Rc=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=I({token:n,providedIn:"root",factory:()=>new n})}return n})(),Ep=[0,1,2,3],Dp=(()=>{class n{ngZone=M(se);scheduler=M(St);errorHandler=M(ot,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){M(Nn,{optional:!0})}execute(){let t=this.sequences.size>0;t&&z(16),this.executing=!0;for(let r of Ep)for(let o of this.sequences)if(!(o.erroredOrDestroyed||!o.hooks[r]))try{o.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>{let i=o.hooks[r];return i(o.pipelinedValue)},o.snapshot))}catch(i){o.erroredOrDestroyed=!0,this.errorHandler?.handleError(i)}this.executing=!1;for(let r of this.sequences)r.afterRun(),r.once&&(this.sequences.delete(r),r.destroy());for(let r of this.deferredRegistrations)this.sequences.add(r);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear(),t&&z(17)}register(t){let{view:r}=t;r!==void 0?((r[bn]??=[]).push(t),nr(r),r[P]|=8192):this.executing?this.deferredRegistrations.add(t):this.addSequence(t)}addSequence(t){this.sequences.add(t),this.scheduler.notify(7)}unregister(t){this.executing&&this.sequences.has(t)?(t.erroredOrDestroyed=!0,t.pipelinedValue=void 0,t.once=!0):(this.sequences.delete(t),this.deferredRegistrations.delete(t))}maybeTrace(t,r){return r?r.run(Es.AFTER_NEXT_RENDER,t):t()}static \u0275prov=I({token:n,providedIn:"root",factory:()=>new n})}return n})(),as=class{impl;hooks;view;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(e,t,r,o,i,s=null){this.impl=e,this.hooks=t,this.view=r,this.once=o,this.snapshot=s,this.unregisterOnDestroy=i?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.();let e=this.view?.[bn];e&&(this.view[bn]=e.filter(t=>t!==this))}};function kc(n,e){let t=e?.injector??M(rt);return Ds("NgAfterNextRender"),Xy(n,t,e,!0)}function Jy(n){return n instanceof Function?[void 0,void 0,n,void 0]:[n.earlyRead,n.write,n.mixedReadWrite,n.read]}function Xy(n,e,t,r){let o=e.get(Rc);o.impl??=e.get(Dp);let i=e.get(Nn,null,{optional:!0}),s=t?.manualCleanup!==!0?e.get($t):null,a=e.get(Wi,null,{optional:!0}),l=new as(o.impl,Jy(n),a?.view,r,s,i?.snapshot(null));return o.impl.register(l),l}var ev=new R("",{providedIn:"root",factory:()=>({queue:new Set,isScheduled:!1,scheduler:null})});function Cp(n,e,t){let r=n.get(ev);if(Array.isArray(e))for(let o of e)r.queue.add(o),t?.detachedLeaveAnimationFns?.push(o);else r.queue.add(e),t?.detachedLeaveAnimationFns?.push(e);r.scheduler&&r.scheduler(n)}function tv(n,e){for(let[t,r]of e)Cp(n,r.animateFns)}function _f(n,e,t,r){let o=n?.[Gr]?.enter;e!==null&&o&&o.has(t.index)&&tv(r,o)}function ir(n,e,t,r,o,i,s,a){if(o!=null){let l,c=!1;at(o)?l=o:ft(o)&&(c=!0,o=o[st]);let u=Ge(o);n===0&&r!==null?(_f(a,r,i,t),s==null?dp(e,r,u):os(e,r,u,s||null,!0)):n===1&&r!==null?(_f(a,r,i,t),os(e,r,u,s||null,!0)):n===2?wf(a,i,t,d=>{jy(e,u,c,d)}):n===3&&wf(a,i,t,()=>{e.destroyNode(u)}),l!=null&&fv(e,n,t,l,i,r,s)}}function nv(n,e){bp(n,e),e[st]=null,e[xe]=null}function rv(n,e,t,r,o,i){r[st]=o,r[xe]=e,Cs(n,r,t,1,o,i)}function bp(n,e){e[Mt].changeDetectionScheduler?.notify(9),Cs(n,e,e[J],2,null,null)}function ov(n){let e=n[Xn];if(!e)return $l(n[O],n);for(;e;){let t=null;if(ft(e))t=e[Xn];else{let r=e[ke];r&&(t=r)}if(!t){for(;e&&!e[We]&&e!==n;)ft(e)&&$l(e[O],e),e=e[ve];e===null&&(e=n),ft(e)&&$l(e[O],e),t=e&&e[We]}e=t}}function Oc(n,e){let t=n[Qr],r=t.indexOf(e);t.splice(r,1)}function _p(n,e){if(_n(e))return;let t=e[J];t.destroyNode&&Cs(n,e,t,3,null,null),ov(e)}function $l(n,e){if(_n(e))return;let t=F(null);try{e[P]&=-129,e[P]|=256,e[Be]&&Yo(e[Be]),av(n,e),sv(n,e),e[O].type===1&&e[J].destroy();let r=e[En];if(r!==null&&at(e[ve])){r!==e[ve]&&Oc(r,e);let o=e[Cn];o!==null&&o.detachView(n)}Xl(e)}finally{F(t)}}function wf(n,e,t,r){let o=n?.[Gr];if(o==null||o.leave==null||!o.leave.has(e.index))return r(!1);n&&cr.add(n),Cp(t,()=>{if(o.leave&&o.leave.has(e.index)){let s=o.leave.get(e.index),a=[];if(s){for(let l=0;l<s.animateFns.length;l++){let c=s.animateFns[l],{promise:u}=c();a.push(u)}o.detachedLeaveAnimationFns=void 0}o.running=Promise.allSettled(a),iv(n,r)}else n&&cr.delete(n),r(!1)},o)}function iv(n,e){let t=n[Gr]?.running;if(t){t.then(()=>{n[Gr].running=void 0,cr.delete(n),e(!0)});return}e(!1)}function sv(n,e){let t=n.cleanup,r=e[Jn];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let a=t[s+3];a>=0?r[a]():r[-a].unsubscribe(),s+=2}else{let a=r[t[s+1]];t[s].call(a)}r!==null&&(e[Jn]=null);let o=e[It];if(o!==null){e[It]=null;for(let s=0;s<o.length;s++){let a=o[s];a()}}let i=e[Wr];if(i!==null){e[Wr]=null;for(let s of i)s.destroy()}}function av(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let o=e[t[r]];if(!(o instanceof Tn)){let i=t[r+1];if(Array.isArray(i))for(let s=0;s<i.length;s+=2){let a=o[i[s]],l=i[s+1];z(4,a,l);try{l.call(a)}finally{z(5,a,l)}}else{z(4,o,i);try{i.call(o)}finally{z(5,o,i)}}}}}function wp(n,e,t){return lv(n,e.parent,t)}function lv(n,e,t){let r=e;for(;r!==null&&r.type&168;)e=r,r=e.parent;if(r===null)return t[st];if(Bt(r)){let{encapsulation:o}=n.data[r.directiveStart+r.componentOffset];if(o===Nt.None||o===Nt.Emulated)return null}return lt(r,t)}function Ip(n,e,t){return uv(n,e,t)}function cv(n,e,t){return n.type&40?lt(n,t):null}var uv=cv,If;function Pc(n,e,t,r){let o=wp(n,r,e),i=e[J],s=r.parent||e[xe],a=Ip(s,r,e);if(o!=null)if(Array.isArray(t))for(let l=0;l<t.length;l++)vf(i,o,t[l],a,!1);else vf(i,o,t,a,!1);If!==void 0&&If(i,r,e,t,o)}function eo(n,e){if(e!==null){let t=e.type;if(t&3)return lt(e,n);if(t&4)return sc(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return eo(n,r);{let o=n[e.index];return at(o)?sc(-1,o):Ge(o)}}else{if(t&128)return eo(n,e.next);if(t&32)return xc(e,n)()||Ge(n[e.index]);{let r=Sp(n,e);if(r!==null){if(Array.isArray(r))return r[0];let o=Ft(n[Re]);return eo(o,r)}else return eo(n,e.next)}}}return null}function Sp(n,e){if(e!==null){let r=n[Re][xe],o=e.projection;return r.projection[o]}return null}function sc(n,e){let t=ke+n+1;if(t<e.length){let r=e[t],o=r[O].firstChild;if(o!==null)return eo(r,o)}return e[jt]}function Fc(n,e,t,r,o,i,s){for(;t!=null;){let a=r[Vt];if(t.type===128){t=t.next;continue}let l=r[t.index],c=t.type;if(s&&e===0&&(l&&lr(Ge(l),r),t.flags|=2),!ys(t))if(c&8)Fc(n,e,t.child,r,o,i,!1),ir(e,n,a,o,l,t,i,r);else if(c&32){let u=xc(t,r),d;for(;d=u();)ir(e,n,a,o,d,t,i,r);ir(e,n,a,o,l,t,i,r)}else c&16?Tp(n,e,r,t,o,i):ir(e,n,a,o,l,t,i,r);t=s?t.projectionNext:t.next}}function Cs(n,e,t,r,o,i){Fc(t,r,n.firstChild,e,o,i,!1)}function dv(n,e,t){let r=e[J],o=wp(n,t,e),i=t.parent||e[xe],s=Ip(i,t,e);Tp(r,0,e,t,o,s)}function Tp(n,e,t,r,o,i){let s=t[Re],l=s[xe].projection[r.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++){let u=l[c];ir(e,n,t[Vt],o,u,r,i,t)}else{let c=l,u=s[ve];Jf(r)&&(c.flags|=128),Fc(n,e,c,u,o,i,!0)}}function fv(n,e,t,r,o,i,s){let a=r[jt],l=Ge(r);a!==l&&ir(e,n,t,i,a,o,s);for(let c=ke;c<r.length;c++){let u=r[c];Cs(u[O],u,n,e,i,a)}}function pv(n,e,t,r,o){if(e)o?n.addClass(t,r):n.removeClass(t,r);else{let i=r.indexOf("-")===-1?void 0:gt.DashCase;o==null?n.removeStyle(t,r,i):(typeof o=="string"&&o.endsWith("!important")&&(o=o.slice(0,-10),i|=gt.Important),n.setStyle(t,r,o,i))}}function Mp(n,e,t,r,o){let i=xt(),s=r&2;try{Ut(-1),s&&e.length>oe&&mp(n,e,oe,!1),z(s?2:0,o,t),t(r,o)}finally{Ut(i),z(s?3:1,o,t)}}function bs(n,e,t){Ev(n,e,t),(t.flags&64)===64&&Dv(n,e,t)}function co(n,e,t=lt){let r=e.localNames;if(r!==null){let o=e.index+1;for(let i=0;i<r.length;i+=2){let s=r[i+1],a=s===-1?t(e,n):n[s];n[o++]=a}}}function hv(n,e,t,r){let i=r.get(ip,op)||t===Nt.ShadowDom,s=n.selectRootElement(e,i);return mv(s),s}function mv(n){gv(n)}var gv=()=>null;function yv(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function xp(n,e,t,r,o,i){let s=e[O];if(Bc(n,s,e,t,r)){Bt(n)&&vv(e,n.index);return}n.type&3&&(t=yv(t)),Np(n,e,t,r,o,i)}function Np(n,e,t,r,o,i){if(n.type&3){let s=lt(n,e);r=i!=null?i(r,n.value||"",t):r,o.setProperty(s,t,r)}else n.type&12}function vv(n,e){let t=ze(e,n);t[P]&16||(t[P]|=64)}function Ev(n,e,t){let r=t.directiveStart,o=t.directiveEnd;Bt(t)&&qy(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||ns(t,e);let i=t.initialInputs;for(let s=r;s<o;s++){let a=n.data[s],l=rs(e,n,s,t);if(lr(l,e),i!==null&&wv(e,s-r,l,a,t,i),pt(a)){let c=ze(t.index,e);c[Ie]=rs(e,n,s,t)}}}function Dv(n,e,t){let r=t.directiveStart,o=t.directiveEnd,i=t.index,s=Xd();try{Ut(i);for(let a=r;a<o;a++){let l=n.data[a],c=e[a];Hi(a),(l.hostBindings!==null||l.hostVars!==0||l.hostAttrs!==null)&&Cv(l,c)}}finally{Ut(-1),Hi(s)}}function Cv(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function Lc(n,e){let t=n.directiveRegistry,r=null;if(t)for(let o=0;o<t.length;o++){let i=t[o];cp(e,i.selectors,!1)&&(r??=[],pt(i)?r.unshift(i):r.push(i))}return r}function bv(n,e,t,r,o,i){let s=lt(n,e);_v(e[J],s,i,n.value,t,r,o)}function _v(n,e,t,r,o,i,s){if(i==null)n.removeAttribute(e,o,t);else{let a=s==null?Qn(i):s(i,r||"",o);n.setAttribute(e,o,a,t)}}function wv(n,e,t,r,o,i){let s=i[e];if(s!==null)for(let a=0;a<s.length;a+=2){let l=s[a],c=s[a+1];rc(r,t,l,c)}}function Vc(n,e,t,r,o){let i=oe+t,s=e[O],a=o(s,e,n,r,t);e[i]=a,rr(n,!0);let l=n.type===2;return l?(fp(e[J],a,n),(Wd()===0||er(n))&&lr(a,e),Gd()):lr(a,e),qi()&&(!l||!ys(n))&&Pc(s,e,a,n),n}function jc(n){let e=n;return xl()?Nl():(e=e.parent,rr(e,!1)),e}function Iv(n,e){let t=n[Vt];if(!t)return;let r;try{r=t.get(ht,null)}catch{r=null}r?.(e)}function Bc(n,e,t,r,o){let i=n.inputs?.[r],s=n.hostDirectiveInputs?.[r],a=!1;if(s)for(let l=0;l<s.length;l+=2){let c=s[l],u=s[l+1],d=e.data[c];rc(d,t[c],u,o),a=!0}if(i)for(let l of i){let c=t[l],u=e.data[l];rc(u,c,r,o),a=!0}return a}function Sv(n,e){let t=ze(e,n),r=t[O];Tv(r,t);let o=t[st];o!==null&&t[Kn]===null&&(t[Kn]=sp(o,t[Vt])),z(18),Hc(r,t,t[Ie]),z(19,t[Ie])}function Tv(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function Hc(n,e,t){Ui(e);try{let r=n.viewQuery;r!==null&&tc(1,r,t);let o=n.template;o!==null&&Mp(n,e,o,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[Cn]?.finishViewCreation(n),n.staticContentQueries&&ap(n,e),n.staticViewQueries&&tc(2,n.viewQuery,t);let i=n.components;i!==null&&Mv(e,i)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[P]&=-5,$i()}}function Mv(n,e){for(let t=0;t<e.length;t++)Sv(n,e[t])}function Ap(n,e,t,r){let o=F(null);try{let i=e.tView,a=n[P]&4096?4096:16,l=Tc(n,i,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),c=n[e.index];l[En]=c;let u=n[Cn];return u!==null&&(l[Cn]=u.createEmbeddedView(i)),Hc(i,l,t),l}finally{F(o)}}function ac(n,e){return!e||e.firstChild===null||Jf(n)}function no(n,e,t,r,o=!1){for(;t!==null;){if(t.type===128){t=o?t.projectionNext:t.next;continue}let i=e[t.index];i!==null&&r.push(Ge(i)),at(i)&&Rp(i,r);let s=t.type;if(s&8)no(n,e,t.child,r);else if(s&32){let a=xc(t,e),l;for(;l=a();)r.push(l)}else if(s&16){let a=Sp(e,t);if(Array.isArray(a))r.push(...a);else{let l=Ft(e[Re]);no(l[O],l,a,r,!0)}}t=o?t.projectionNext:t.next}return r}function Rp(n,e){for(let t=ke;t<n.length;t++){let r=n[t],o=r[O].firstChild;o!==null&&no(r[O],r,o,e)}n[jt]!==n[st]&&e.push(n[jt])}function kp(n){if(n[bn]!==null){for(let e of n[bn])e.impl.addSequence(e);n[bn].length=0}}var Op=[];function xv(n){return n[Be]??Nv(n)}function Nv(n){let e=Op.pop()??Object.create(Rv);return e.lView=n,e}function Av(n){n.lView[Be]!==n&&(n.lView=null,Op.push(n))}var Rv=k(E({},Bn),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{nr(n.lView)},consumerOnSignalRead(){this.lView[Be]=this}});function kv(n){let e=n[Be]??Object.create(Ov);return e.lView=n,e}var Ov=k(E({},Bn),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=Ft(n.lView);for(;e&&!Pp(e[O]);)e=Ft(e);e&&bl(e)},consumerOnSignalRead(){this.lView[Be]=this}});function Pp(n){return n.type!==2}function Fp(n){if(n[Wr]===null)return;let e=!0;for(;e;){let t=!1;for(let r of n[Wr])r.dirty&&(t=!0,r.zone===null||Zone.current===r.zone?r.run():r.zone.run(()=>r.run()));e=t&&!!(n[P]&8192)}}var Pv=100;function Lp(n,e=0){let r=n[Mt].rendererFactory,o=!1;o||r.begin?.();try{Fv(n,e)}finally{o||r.end?.()}}function Fv(n,e){let t=Al();try{Rl(!0),lc(n,e);let r=0;for(;Zr(n);){if(r===Pv)throw new N(103,!1);r++,lc(n,1)}}finally{Rl(t)}}function Lv(n,e,t,r){if(_n(e))return;let o=e[P],i=!1,s=!1;Ui(e);let a=!0,l=null,c=null;i||(Pp(n)?(c=xv(e),l=Rr(c)):Wo()===null?(a=!1,c=kv(e),l=Rr(c)):e[Be]&&(Yo(e[Be]),e[Be]=null));try{Cl(e),Yd(n.bindingStartIndex),t!==null&&Mp(n,e,t,2,r);let u=(o&3)===3;if(!i)if(u){let f=n.preOrderCheckHooks;f!==null&&Qi(e,f,null)}else{let f=n.preOrderHooks;f!==null&&Zi(e,f,0,null),Hl(e,0)}if(s||Vv(e),Fp(e),Vp(e,0),n.contentQueries!==null&&ap(n,e),!i)if(u){let f=n.contentCheckHooks;f!==null&&Qi(e,f)}else{let f=n.contentHooks;f!==null&&Zi(e,f,1),Hl(e,1)}Bv(n,e);let d=n.components;d!==null&&Bp(e,d,0);let p=n.viewQuery;if(p!==null&&tc(2,p,r),!i)if(u){let f=n.viewCheckHooks;f!==null&&Qi(e,f)}else{let f=n.viewHooks;f!==null&&Zi(e,f,2),Hl(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[Pi]){for(let f of e[Pi])f();e[Pi]=null}i||(kp(e),e[P]&=-73)}catch(u){throw i||nr(e),u}finally{c!==null&&(Qo(c,l),a&&Av(c)),$i()}}function Vp(n,e){for(let t=ep(n);t!==null;t=tp(t))for(let r=ke;r<t.length;r++){let o=t[r];jp(o,e)}}function Vv(n){for(let e=ep(n);e!==null;e=tp(e)){if(!(e[P]&2))continue;let t=e[Qr];for(let r=0;r<t.length;r++){let o=t[r];bl(o)}}}function jv(n,e,t){z(18);let r=ze(e,n);jp(r,t),z(19,r[Ie])}function jp(n,e){Li(n)&&lc(n,e)}function lc(n,e){let r=n[O],o=n[P],i=n[Be],s=!!(e===0&&o&16);if(s||=!!(o&64&&e===0),s||=!!(o&1024),s||=!!(i?.dirty&&Zo(i)),s||=!1,i&&(i.dirty=!1),n[P]&=-9217,s)Lv(r,n,r.template,n[Ie]);else if(o&8192){let a=F(null);try{Fp(n),Vp(n,1);let l=r.components;l!==null&&Bp(n,l,1),kp(n)}finally{F(a)}}}function Bp(n,e,t){for(let r=0;r<e.length;r++)jv(n,e[r],t)}function Bv(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let o=t[r];if(o<0)Ut(~o);else{let i=o,s=t[++r],a=t[++r];Jd(s,i);let l=e[i];z(24,l),a(2,l),z(25,l)}}}finally{Ut(-1)}}function Uc(n,e){let t=Al()?64:1088;for(n[Mt].changeDetectionScheduler?.notify(e);n;){n[P]|=t;let r=Ft(n);if(tr(n)&&!r)return n;n=r}return null}function Hp(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function Up(n,e,t,r=!0){let o=e[O];if(Hv(o,e,n,t),r){let s=sc(t,n),a=e[J],l=a.parentNode(n[jt]);l!==null&&rv(o,n[xe],a,e,l,s)}let i=e[Kn];i!==null&&i.firstChild!==null&&(i.firstChild=null)}function cc(n,e){if(n.length<=ke)return;let t=ke+e,r=n[t];if(r){let o=r[En];o!==null&&o!==n&&Oc(o,r),e>0&&(n[t-1][We]=r[We]);let i=Br(n,ke+e);nv(r[O],r);let s=i[Cn];s!==null&&s.detachView(i[O]),r[ve]=null,r[We]=null,r[P]&=-129}return r}function Hv(n,e,t,r){let o=ke+r,i=t.length;r>0&&(t[o-1][We]=e),r<i-ke?(e[We]=t[o],ll(t,ke+r,e)):(t.push(e),e[We]=null),e[ve]=t;let s=e[En];s!==null&&t!==s&&$p(s,e);let a=e[Cn];a!==null&&a.insertView(n),Vi(e),e[P]|=128}function $p(n,e){let t=n[Qr],r=e[ve];if(ft(r))n[P]|=2;else{let o=r[ve][Re];e[Re]!==o&&(n[P]|=2)}t===null?n[Qr]=[e]:t.push(e)}var Wt=class{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){let e=this._lView,t=e[O];return no(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t}get context(){return this._lView[Ie]}set context(e){this._lView[Ie]=e}get destroyed(){return _n(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[ve];if(at(e)){let t=e[zr],r=t?t.indexOf(this):-1;r>-1&&(cc(e,r),Br(t,r))}this._attachedToViewContainer=!1}_p(this._lView[O],this._lView)}onDestroy(e){_l(this._lView,e)}markForCheck(){Uc(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[P]&=-129}reattach(){Vi(this._lView),this._lView[P]|=128}detectChanges(){this._lView[P]|=1024,Lp(this._lView)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new N(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=tr(this._lView),t=this._lView[En];t!==null&&!e&&Oc(t,this._lView),bp(this._lView[O],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new N(902,!1);this._appRef=e;let t=tr(this._lView),r=this._lView[En];r!==null&&!t&&$p(r,this._lView),Vi(this._lView)}};var uo=(()=>{class n{_declarationLView;_declarationTContainer;elementRef;static __NG_ELEMENT_ID__=Uv;constructor(t,r,o){this._declarationLView=t,this._declarationTContainer=r,this.elementRef=o}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,r){return this.createEmbeddedViewImpl(t,r)}createEmbeddedViewImpl(t,r,o){let i=Ap(this._declarationLView,this._declarationTContainer,t,{embeddedViewInjector:r,dehydratedView:o});return new Wt(i)}}return n})();function Uv(){return qp(fe(),L())}function qp(n,e){return n.type&4?new uo(e,n,ps(n,e)):null}function fr(n,e,t,r,o){let i=n.data[e];if(i===null)i=$v(n,e,t,r,o),Kd()&&(i.flags|=32);else if(i.type&64){i.type=t,i.value=r,i.attrs=o;let s=zd();i.injectorIndex=s===null?-1:s.injectorIndex}return rr(i,!0),i}function $v(n,e,t,r,o){let i=Ml(),s=xl(),a=s?i:i&&i.parent,l=n.data[e]=Wv(n,a,t,e,r,o);return qv(n,l,i,s),l}function qv(n,e,t,r){n.firstChild===null&&(n.firstChild=e),t!==null&&(r?t.child==null&&e.parent!==null&&(t.child=e):t.next===null&&(t.next=e,e.prev=t))}function Wv(n,e,t,r,o,i){let s=e?e.injectorIndex:-1,a=0;return Il()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:o,attrs:i,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var UM=new RegExp(`^(\\d+)*(${gy}|${my})*(.*)`);var Gv=()=>null;function uc(n,e){return Gv(n,e)}var Wp=class{},_s=class{},dc=class{resolveComponentFactory(e){throw new N(917,!1)}},ws=class{static NULL=new dc},Mn=class{},Gt=(()=>{class n{destroyNode=null;static __NG_ELEMENT_ID__=()=>zv()}return n})();function zv(){let n=L(),e=fe(),t=ze(e.index,n);return(ft(t)?t:n)[J]}var Gp=(()=>{class n{static \u0275prov=I({token:n,providedIn:"root",factory:()=>null})}return n})();var Yi={},fc=class{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){let o=this.injector.get(e,Yi,r);return o!==Yi||t===Yi?o:this.parentInjector.get(e,t,r)}};function ls(n,e,t){let r=t?n.styles:null,o=t?n.classes:null,i=0;if(e!==null)for(let s=0;s<e.length;s++){let a=e[s];if(typeof a=="number")i=a;else if(i==1)o=Mi(o,a);else if(i==2){let l=a,c=e[++s];r=Mi(r,l+": "+c+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=o:n.classesWithoutHost=o}function _(n,e=0){let t=L();if(t===null)return C(n,e);let r=fe();return Zf(r,t,ye(n),e)}function zp(n,e,t,r,o){let i=r===null?null:{"":-1},s=o(n,t);if(s!==null){let a=s,l=null,c=null;for(let u of s)if(u.resolveHostDirectives!==null){[a,l,c]=u.resolveHostDirectives(s);break}Yv(n,e,t,a,i,l,c)}i!==null&&r!==null&&Qv(t,r,i)}function Qv(n,e,t){let r=n.localNames=[];for(let o=0;o<e.length;o+=2){let i=t[e[o+1]];if(i==null)throw new N(-301,!1);r.push(e[o],i)}}function Zv(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function Yv(n,e,t,r,o,i,s){let a=r.length,l=!1;for(let p=0;p<a;p++){let f=r[p];!l&&pt(f)&&(l=!0,Zv(n,t,p)),Kl(ns(t,e),n,f.type)}nE(t,n.data.length,a);for(let p=0;p<a;p++){let f=r[p];f.providersResolver&&f.providersResolver(f)}let c=!1,u=!1,d=hp(n,e,a,null);a>0&&(t.directiveToIndex=new Map);for(let p=0;p<a;p++){let f=r[p];if(t.mergedAttrs=ar(t.mergedAttrs,f.hostAttrs),Jv(n,t,e,d,f),tE(d,f,o),s!==null&&s.has(f)){let[x,S]=s.get(f);t.directiveToIndex.set(f.type,[d,x+t.directiveStart,S+t.directiveStart])}else(i===null||!i.has(f))&&t.directiveToIndex.set(f.type,d);f.contentQueries!==null&&(t.flags|=4),(f.hostBindings!==null||f.hostAttrs!==null||f.hostVars!==0)&&(t.flags|=64);let b=f.type.prototype;!c&&(b.ngOnChanges||b.ngOnInit||b.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),c=!0),!u&&(b.ngOnChanges||b.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),u=!0),d++}Kv(n,t,i)}function Kv(n,e,t){for(let r=e.directiveStart;r<e.directiveEnd;r++){let o=n.data[r];if(t===null||!t.has(o))Sf(0,e,o,r),Sf(1,e,o,r),Mf(e,r,!1);else{let i=t.get(o);Tf(0,e,i,r),Tf(1,e,i,r),Mf(e,r,!0)}}}function Sf(n,e,t,r){let o=n===0?t.inputs:t.outputs;for(let i in o)if(o.hasOwnProperty(i)){let s;n===0?s=e.inputs??={}:s=e.outputs??={},s[i]??=[],s[i].push(r),Qp(e,i)}}function Tf(n,e,t,r){let o=n===0?t.inputs:t.outputs;for(let i in o)if(o.hasOwnProperty(i)){let s=o[i],a;n===0?a=e.hostDirectiveInputs??={}:a=e.hostDirectiveOutputs??={},a[s]??=[],a[s].push(r,i),Qp(e,s)}}function Qp(n,e){e==="class"?n.flags|=8:e==="style"&&(n.flags|=16)}function Mf(n,e,t){let{attrs:r,inputs:o,hostDirectiveInputs:i}=n;if(r===null||!t&&o===null||t&&i===null||Ic(n)){n.initialInputs??=[],n.initialInputs.push(null);return}let s=null,a=0;for(;a<r.length;){let l=r[a];if(l===0){a+=4;continue}else if(l===5){a+=2;continue}else if(typeof l=="number")break;if(!t&&o.hasOwnProperty(l)){let c=o[l];for(let u of c)if(u===e){s??=[],s.push(l,r[a+1]);break}}else if(t&&i.hasOwnProperty(l)){let c=i[l];for(let u=0;u<c.length;u+=2)if(c[u]===e){s??=[],s.push(c[u+1],r[a+1]);break}}a+=2}n.initialInputs??=[],n.initialInputs.push(s)}function Jv(n,e,t,r,o){n.data[r]=o;let i=o.factory||(o.factory=Pt(o.type,!0)),s=new Tn(i,pt(o),_,null);n.blueprint[r]=s,t[r]=s,Xv(n,e,r,hp(n,t,o.hostVars,Oe),o)}function Xv(n,e,t,r,o){let i=o.hostBindings;if(i){let s=n.hostBindingOpCodes;s===null&&(s=n.hostBindingOpCodes=[]);let a=~e.index;eE(s)!=a&&s.push(a),s.push(t,r,i)}}function eE(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function tE(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;pt(e)&&(t[""]=n)}}function nE(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function $c(n,e,t,r,o,i,s,a){let l=e[O],c=l.consts,u=Ht(c,s),d=fr(l,n,t,r,u);return i&&zp(l,e,d,Ht(c,a),o),d.mergedAttrs=ar(d.mergedAttrs,d.attrs),d.attrs!==null&&ls(d,d.attrs,!1),d.mergedAttrs!==null&&ls(d,d.mergedAttrs,!0),l.queries!==null&&l.queries.elementStart(l,d),d}function qc(n,e){Hf(n,e),yl(e)&&n.queries.elementEnd(e)}function rE(n,e,t,r,o,i){let s=e.consts,a=Ht(s,o),l=fr(e,n,t,r,a);if(l.mergedAttrs=ar(l.mergedAttrs,l.attrs),i!=null){let c=Ht(s,i);l.localNames=[];for(let u=0;u<c.length;u+=2)l.localNames.push(c[u],-1)}return l.attrs!==null&&ls(l,l.attrs,!1),l.mergedAttrs!==null&&ls(l,l.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,l),l}function Wc(n){return Yp(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function Zp(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),r;for(;!(r=t.next()).done;)e(r.value)}}function Yp(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function fo(n,e,t){return n[e]=t}function Kp(n,e){return n[e]}function Qe(n,e,t){if(t===Oe)return!1;let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function cs(n,e,t,r){let o=Qe(n,e,t);return Qe(n,e+1,r)||o}function oE(n,e,t,r,o){let i=cs(n,e,t,r);return Qe(n,e+2,o)||i}function Jp(n,e,t,r,o,i){let s=cs(n,e,t,r);return cs(n,e+2,o,i)||s}function Ki(n,e,t){return function r(o){let i=Bt(n)?ze(n.index,e):e;Uc(i,5);let s=e[Ie],a=xf(e,s,t,o),l=r.__ngNextListenerFn__;for(;l;)a=xf(e,s,l,o)&&a,l=l.__ngNextListenerFn__;return a}}function xf(n,e,t,r){let o=F(null);try{return z(6,e,t),t(r)!==!1}catch(i){return Iv(n,i),!1}finally{z(7,e,t),F(o)}}function Xp(n,e,t,r,o,i,s,a){let l=er(n),c=!1,u=null;if(!r&&l&&(u=sE(e,t,i,n.index)),u!==null){let d=u.__ngLastListenerFn__||u;d.__ngNextListenerFn__=s,u.__ngLastListenerFn__=s,c=!0}else{let d=lt(n,t),p=r?r(d):d;vy(t,p,i,a);let f=o.listen(p,i,a);if(!iE(i)){let b=r?x=>r(Ge(x[n.index])):n.index;eh(b,e,t,i,a,f,!1)}}return c}function iE(n){return n.startsWith("animation")||n.startsWith("transition")}function sE(n,e,t,r){let o=n.cleanup;if(o!=null)for(let i=0;i<o.length-1;i+=2){let s=o[i];if(s===t&&o[i+1]===r){let a=e[Jn],l=o[i+2];return a&&a.length>l?a[l]:null}typeof s=="string"&&(i+=2)}return null}function eh(n,e,t,r,o,i,s){let a=e.firstCreatePass?qd(e):null,l=$d(t),c=l.length;l.push(o,i),a&&a.push(r,n,c,(c+1)*(s?-1:1))}function Nf(n,e,t,r,o,i){let s=e[t],a=e[O],c=a.data[t].outputs[r],d=s[c].subscribe(i);eh(n.index,a,e,o,i,d,!0)}var pc=Symbol("BINDING");var hc=class extends ws{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=yn(e);return new ro(t,this.ngModule)}};function aE(n){return Object.keys(n).map(e=>{let[t,r,o]=n[e],i={propName:t,templateName:e,isSignal:(r&vs.SignalBased)!==0};return o&&(i.transform=o),i})}function lE(n){return Object.keys(n).map(e=>({propName:n[e],templateName:e}))}function cE(n,e,t){let r=e instanceof Ae?e:e?.injector;return r&&n.getStandaloneInjector!==null&&(r=n.getStandaloneInjector(r)||r),r?new fc(t,r):t}function uE(n){let e=n.get(Mn,null);if(e===null)throw new N(407,!1);let t=n.get(Gp,null),r=n.get(St,null);return{rendererFactory:e,sanitizer:t,changeDetectionScheduler:r,ngReflect:!1}}function dE(n,e){let t=th(n);return up(e,t,t==="svg"?Vd:t==="math"?jd:null)}function th(n){return(n.selectors[0][0]||"div").toLowerCase()}var ro=class extends _s{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=aE(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=lE(this.componentDef.outputs),this.cachedOutputs}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=Oy(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!t}create(e,t,r,o,i,s){z(22);let a=F(null);try{let l=this.componentDef,c=fE(r,l,s,i),u=cE(l,o||this.ngModule,e),d=uE(u),p=d.rendererFactory.createRenderer(null,l),f=r?hv(p,r,l.encapsulation,u):dE(l,p),b=s?.some(Af)||i?.some(T=>typeof T!="function"&&T.bindings.some(Af)),x=Tc(null,c,null,512|pp(l),null,null,d,p,u,null,sp(f,u,!0));x[oe]=f,Ui(x);let S=null;try{let T=$c(oe,x,2,"#host",()=>c.directiveRegistry,!0,0);fp(p,f,T),lr(f,x),bs(c,x,T),_c(c,T,x),qc(c,T),t!==void 0&&hE(T,this.ngContentSelectors,t),S=ze(T.index,x),x[Ie]=S[Ie],Hc(c,x,null)}catch(T){throw S!==null&&Xl(S),Xl(x),T}finally{z(23),$i()}return new us(this.componentType,x,!!b)}finally{F(a)}}};function fE(n,e,t,r){let o=n?["ng-version","20.3.12"]:Py(e.selectors[0]),i=null,s=null,a=0;if(t)for(let u of t)a+=u[pc].requiredVars,u.create&&(u.targetIdx=0,(i??=[]).push(u)),u.update&&(u.targetIdx=0,(s??=[]).push(u));if(r)for(let u=0;u<r.length;u++){let d=r[u];if(typeof d!="function")for(let p of d.bindings){a+=p[pc].requiredVars;let f=u+1;p.create&&(p.targetIdx=f,(i??=[]).push(p)),p.update&&(p.targetIdx=f,(s??=[]).push(p))}}let l=[e];if(r)for(let u of r){let d=typeof u=="function"?u:u.type,p=dl(d);l.push(p)}return Sc(0,null,pE(i,s),1,a,l,null,null,null,[o],null)}function pE(n,e){return!n&&!e?null:t=>{if(t&1&&n)for(let r of n)r.create();if(t&2&&e)for(let r of e)r.update()}}function Af(n){let e=n[pc].kind;return e==="input"||e==="twoWay"}var us=class extends Wp{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,t,r){super(),this._rootLView=t,this._hasInputBindings=r,this._tNode=Fi(t[O],oe),this.location=ps(this._tNode,t),this.instance=ze(this._tNode.index,t)[Ie],this.hostView=this.changeDetectorRef=new Wt(t,void 0),this.componentType=e}setInput(e,t){this._hasInputBindings;let r=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let o=this._rootLView,i=Bc(r,o[O],o,e,t);this.previousInputValues.set(e,t);let s=ze(r.index,o);Uc(s,1)}get injector(){return new Sn(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function hE(n,e,t){let r=n.projection=[];for(let o=0;o<e.length;o++){let i=t[o];r.push(i!=null&&i.length?Array.from(i):null)}}var po=(()=>{class n{static __NG_ELEMENT_ID__=mE}return n})();function mE(){let n=fe();return yE(n,L())}var gE=po,nh=class extends gE{_lContainer;_hostTNode;_hostLView;constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return ps(this._hostTNode,this._hostLView)}get injector(){return new Sn(this._hostTNode,this._hostLView)}get parentInjector(){let e=Dc(this._hostTNode,this._hostLView);if($f(e)){let t=es(e,this._hostLView),r=Xi(e),o=t[O].data[r+8];return new Sn(o,t)}else return new Sn(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=Rf(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-ke}createEmbeddedView(e,t,r){let o,i;typeof r=="number"?o=r:r!=null&&(o=r.index,i=r.injector);let s=uc(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},i,s);return this.insertImpl(a,o,ac(this._hostTNode,s)),a}createComponent(e,t,r,o,i,s,a){let l=e&&!qg(e),c;if(l)c=t;else{let S=t||{};c=S.index,r=S.injector,o=S.projectableNodes,i=S.environmentInjector||S.ngModuleRef,s=S.directives,a=S.bindings}let u=l?e:new ro(yn(e)),d=r||this.parentInjector;if(!i&&u.ngModule==null){let T=(l?d:this.parentInjector).get(Ae,null);T&&(i=T)}let p=yn(u.componentType??{}),f=uc(this._lContainer,p?.id??null),b=f?.firstChild??null,x=u.create(d,o,b,i,s,a);return this.insertImpl(x.hostView,c,ac(this._hostTNode,f)),x}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let o=e._lView;if(Bd(o)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let l=o[ve],c=new nh(l,l[xe],l[ve]);c.detach(c.indexOf(e))}}let i=this._adjustIndex(t),s=this._lContainer;return Up(s,o,i,r),e.attachToViewContainerRef(),ll(ql(s),i,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=Rf(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=cc(this._lContainer,t);r&&(Br(ql(this._lContainer),t),_p(r[O],r))}detach(e){let t=this._adjustIndex(e,-1),r=cc(this._lContainer,t);return r&&Br(ql(this._lContainer),t)!=null?new Wt(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function Rf(n){return n[zr]}function ql(n){return n[zr]||(n[zr]=[])}function yE(n,e){let t,r=e[n.index];return at(r)?t=r:(t=Hp(r,e,null,n),e[n.index]=t,Mc(e,t)),EE(t,e,n,r),new nh(t,n,e)}function vE(n,e){let t=n[J],r=t.createComment(""),o=lt(e,n),i=t.parentNode(o);return os(t,i,r,t.nextSibling(o),!1),r}var EE=bE,DE=()=>!1;function CE(n,e,t){return DE(n,e,t)}function bE(n,e,t,r){if(n[jt])return;let o;t.type&8?o=Ge(r):o=vE(e,t),n[jt]=o}var oo=class{};var io=class extends oo{injector;componentFactoryResolver=new hc(this);instance=null;constructor(e){super();let t=new hn([...e.providers,{provide:oo,useValue:this},{provide:ws,useValue:this.componentFactoryResolver}],e.parent||$r(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function rh(n,e,t=null){return new io({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var _E=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let r=fl(!1,t.type),o=r.length>0?rh([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,o)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=I({token:n,providedIn:"environment",factory:()=>new n(C(Ae))})}return n})();function Q(n){return ao(()=>{let e=oh(n),t=k(E({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===Cc.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?o=>o.get(_E).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Nt.Emulated,styles:n.styles||Me,_:null,schemas:n.schemas||null,tView:null,id:""});e.standalone&&Ds("NgStandalone"),ih(t);let r=n.dependencies;return t.directiveDefs=kf(r,wE),t.pipeDefs=kf(r,Ad),t.id=TE(t),t})}function wE(n){return yn(n)||dl(n)}function zt(n){return ao(()=>({type:n.type,bootstrap:n.bootstrap||Me,declarations:n.declarations||Me,imports:n.imports||Me,exports:n.exports||Me,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function IE(n,e){if(n==null)return Lt;let t={};for(let r in n)if(n.hasOwnProperty(r)){let o=n[r],i,s,a,l;Array.isArray(o)?(a=o[0],i=o[1],s=o[2]??i,l=o[3]||null):(i=o,s=o,a=vs.None,l=null),t[i]=[r,a,l],e[i]=s}return t}function SE(n){if(n==null)return Lt;let e={};for(let t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function ce(n){return ao(()=>{let e=oh(n);return ih(e),e})}function Gc(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone??!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function oh(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputConfig:n.inputs||Lt,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||Me,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:IE(n.inputs,e),outputs:SE(n.outputs),debugInfo:null}}function ih(n){n.features?.forEach(e=>e(n))}function kf(n,e){return n?()=>{let t=typeof n=="function"?n():n,r=[];for(let o of t){let i=e(o);i!==null&&r.push(i)}return r}:null}function TE(n){let e=0,t=typeof n.consts=="function"?"":n.consts,r=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,t,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let i of r.join("|"))e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function ME(n){return Object.getPrototypeOf(n.prototype).constructor}function Ze(n){let e=ME(n.type),t=!0,r=[n];for(;e;){let o;if(pt(n))o=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new N(903,!1);o=e.\u0275dir}if(o){if(t){r.push(o);let s=n;s.inputs=Wl(n.inputs),s.declaredInputs=Wl(n.declaredInputs),s.outputs=Wl(n.outputs);let a=o.hostBindings;a&&kE(n,a);let l=o.viewQuery,c=o.contentQueries;if(l&&AE(n,l),c&&RE(n,c),xE(n,o),wd(n.outputs,o.outputs),pt(o)&&o.data.animation){let u=n.data;u.animation=(u.animation||[]).concat(o.data.animation)}}let i=o.features;if(i)for(let s=0;s<i.length;s++){let a=i[s];a&&a.ngInherit&&a(n),a===Ze&&(t=!1)}}e=Object.getPrototypeOf(e)}NE(r)}function xE(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let r=e.inputs[t];r!==void 0&&(n.inputs[t]=r,n.declaredInputs[t]=e.declaredInputs[t])}}function NE(n){let e=0,t=null;for(let r=n.length-1;r>=0;r--){let o=n[r];o.hostVars=e+=o.hostVars,o.hostAttrs=ar(o.hostAttrs,t=ar(t,o.hostAttrs))}}function Wl(n){return n===Lt?{}:n===Me?[]:n}function AE(n,e){let t=n.viewQuery;t?n.viewQuery=(r,o)=>{e(r,o),t(r,o)}:n.viewQuery=e}function RE(n,e){let t=n.contentQueries;t?n.contentQueries=(r,o,i)=>{e(r,o,i),t(r,o,i)}:n.contentQueries=e}function kE(n,e){let t=n.hostBindings;t?n.hostBindings=(r,o)=>{e(r,o),t(r,o)}:n.hostBindings=e}function sh(n,e,t,r,o,i,s,a){if(t.firstCreatePass){n.mergedAttrs=ar(n.mergedAttrs,n.attrs);let u=n.tView=Sc(2,n,o,i,s,t.directiveRegistry,t.pipeRegistry,null,t.schemas,t.consts,null);t.queries!==null&&(t.queries.template(t,n),u.queries=t.queries.embeddedTView(n))}a&&(n.flags|=a),rr(n,!1);let l=FE(t,e,n,r);qi()&&Pc(t,e,l,n),lr(l,e);let c=Hp(l,e,l,n);e[r+oe]=c,Mc(e,c),CE(c,n,e)}function OE(n,e,t,r,o,i,s,a,l,c,u){let d=t+oe,p;return e.firstCreatePass?(p=fr(e,d,4,s||null,a||null),ji()&&zp(e,n,p,Ht(e.consts,c),Lc),Hf(e,p)):p=e.data[d],sh(p,n,e,t,r,o,i,l),er(p)&&bs(e,n,p),c!=null&&co(n,p,u),p}function PE(n,e,t,r,o,i,s,a,l,c,u){let d=t+oe,p;if(e.firstCreatePass){if(p=fr(e,d,4,s||null,a||null),c!=null){let f=Ht(e.consts,c);p.localNames=[];for(let b=0;b<f.length;b+=2)p.localNames.push(f[b],-1)}}else p=e.data[d];return sh(p,n,e,t,r,o,i,l),c!=null&&co(n,p,u),p}function A(n,e,t,r,o,i,s,a){let l=L(),c=le(),u=Ht(c.consts,i);return OE(l,c,n,e,t,r,o,u,void 0,s,a),A}var FE=LE;function LE(n,e,t,r){return Kr(!0),e[J].createComment("")}var zc=new R("");function pr(n){return!!n&&typeof n.then=="function"}function Qc(n){return!!n&&typeof n.subscribe=="function"}var ah=new R("");var Zc=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r});appInits=M(ah,{optional:!0})??[];injector=M(rt);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let o of this.appInits){let i=Yn(this.injector,o);if(pr(i))t.push(i);else if(Qc(i)){let s=new Promise((a,l)=>{i.subscribe({complete:a,error:l})});t.push(s)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(o=>{this.reject(o)}),t.length===0&&r(),this.initialized=!0}static \u0275fac=function(r){return new(r||n)};static \u0275prov=I({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),lh=new R("");function ch(){Ia(()=>{let n="";throw new N(600,n)})}function uh(n){return n.isBoundToModule}var VE=10;var An=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=M(ht);afterRenderManager=M(Rc);zonelessEnabled=M(Jr);rootEffectScheduler=M(Bl);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new nt;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=M(qt);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe(de(t=>!t))}constructor(){M(Nn,{optional:!0})}whenStable(){let t;return new Promise(r=>{t=this.isStable.subscribe({next:o=>{o&&r()}})}).finally(()=>{t.unsubscribe()})}_injector=M(Ae);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,r){return this.bootstrapImpl(t,r)}bootstrapImpl(t,r,o=rt.NULL){return this._injector.get(se).run(()=>{z(10);let s=t instanceof _s;if(!this._injector.get(Zc).done){let b="";throw new N(405,b)}let l;s?l=t:l=this._injector.get(ws).resolveComponentFactory(t),this.componentTypes.push(l.componentType);let c=uh(l)?void 0:this._injector.get(oo),u=r||l.selector,d=l.create(o,[],u,c),p=d.location.nativeElement,f=d.injector.get(zc,null);return f?.registerApplication(p),d.onDestroy(()=>{this.detachView(d.hostView),to(this.components,d),f?.unregisterApplication(p)}),this._loadComponent(d),z(11,d),d})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){z(12),this.tracingSnapshot!==null?this.tracingSnapshot.run(Es.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw new N(101,!1);let t=F(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,F(t),this.afterTick.next(),z(13)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(Mn,null,{optional:!0}));let t=0;for(;this.dirtyFlags!==0&&t++<VE;)z(14),this.synchronizeOnce(),z(15)}synchronizeOnce(){this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let t=!1;if(this.dirtyFlags&7){let r=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:o}of this.allViews){if(!r&&!Zr(o))continue;let i=r&&!this.zonelessEnabled?0:1;Lp(o,i),t=!0}if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}t||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>Zr(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){let r=t;to(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView);try{this.tick()}catch(o){this.internalErrorHandler(o)}this.components.push(t),this._injector.get(lh,[]).forEach(o=>o(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>to(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new N(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(r){return new(r||n)};static \u0275prov=I({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function to(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function yt(n,e,t,r){let o=L(),i=or();if(Qe(o,i,e)){let s=le(),a=Yr();bv(a,o,n,e,t,r)}return yt}var QM=typeof document<"u"&&typeof document?.documentElement?.getAnimations=="function";function D(n,e,t){let r=L(),o=or();if(Qe(r,o,e)){let i=le(),s=Yr();xp(s,r,n,e,r[J],t)}return D}function mc(n,e,t,r,o){Bc(e,n,t,o?"class":"style",r)}function h(n,e,t,r){let o=L(),i=o[O],s=n+oe,a=i.firstCreatePass?$c(s,o,2,e,Lc,ji(),t,r):i.data[s];if(Vc(a,o,n,e,dh),er(a)){let l=o[O];bs(l,o,a),_c(l,a,o)}return r!=null&&co(o,a),h}function g(){let n=le(),e=fe(),t=jc(e);return n.firstCreatePass&&qc(n,t),Sl(t)&&Tl(),wl(),t.classesWithoutHost!=null&&Yg(t)&&mc(n,t,L(),t.classesWithoutHost,!0),t.stylesWithoutHost!=null&&Kg(t)&&mc(n,t,L(),t.stylesWithoutHost,!1),g}function te(n,e,t,r){return h(n,e,t,r),g(),te}function $(n,e,t,r){let o=L(),i=o[O],s=n+oe,a=i.firstCreatePass?rE(s,i,2,e,t,r):i.data[s];return Vc(a,o,n,e,dh),r!=null&&co(o,a),$}function q(){let n=fe(),e=jc(n);return Sl(e)&&Tl(),wl(),q}var dh=(n,e,t,r,o)=>(Kr(!0),up(e[J],r,sf()));function vt(n,e,t){let r=L(),o=r[O],i=n+oe,s=o.firstCreatePass?$c(i,r,8,"ng-container",Lc,ji(),e,t):o.data[i];if(Vc(s,r,n,"ng-container",jE),er(s)){let a=r[O];bs(a,r,s),_c(a,s,r)}return t!=null&&co(r,s),vt}function Et(){let n=le(),e=fe(),t=jc(e);return n.firstCreatePass&&qc(n,t),Et}var jE=(n,e,t,r,o)=>(Kr(!0),Vy(e[J],""));function Pe(){return L()}function Qt(n,e,t){let r=L(),o=or();if(Qe(r,o,e)){let i=le(),s=Yr();Np(s,r,n,e,r[J],t)}return Qt}var ho="en-US";var BE=ho;function fh(n){typeof n=="string"&&(BE=n.toLowerCase().replace(/_/g,"-"))}function W(n,e,t){let r=L(),o=le(),i=fe();return ph(o,r,r[J],i,n,e,t),W}function Ye(n,e,t){let r=L(),o=le(),i=fe();return(i.type&3||t)&&Xp(i,o,r,t,r[J],n,e,Ki(i,r,e)),Ye}function ph(n,e,t,r,o,i,s){let a=!0,l=null;if((r.type&3||s)&&(l??=Ki(r,e,i),Xp(r,n,e,s,t,o,i,l)&&(a=!1)),a){let c=r.outputs?.[o],u=r.hostDirectiveOutputs?.[o];if(u&&u.length)for(let d=0;d<u.length;d+=2){let p=u[d],f=u[d+1];l??=Ki(r,e,i),Nf(r,e,p,f,o,l)}if(c&&c.length)for(let d of c)l??=Ki(r,e,i),Nf(r,e,d,o,o,l)}}function w(n=1){return of(n)}function HE(n,e){let t=null,r=xy(n);for(let o=0;o<e.length;o++){let i=e[o];if(i==="*"){t=o;continue}if(r===null?cp(n,i,!0):Ry(r,i))return o}return t}function mo(n){let e=L()[Re][xe];if(!e.projection){let t=n?n.length:1,r=e.projection=xd(t,null),o=r.slice(),i=e.child;for(;i!==null;){if(i.type!==128){let s=n?HE(i,n):0;s!==null&&(o[s]?o[s].projectionNext=i:r[s]=i,o[s]=i)}i=i.next}}}function go(n,e=0,t,r,o,i){let s=L(),a=le(),l=r?n+1:null;l!==null&&PE(s,a,l,r,o,i,null,t);let c=fr(a,oe+n,16,null,t||null);c.projection===null&&(c.projection=e),Nl();let d=!s[Kn]||Il();s[Re][xe].projection[c.projection]===null&&l!==null?UE(s,a,l):d&&!ys(c)&&dv(a,s,c)}function UE(n,e,t){let r=oe+t,o=e.data[r],i=n[r],s=uc(i,o.tView.ssrId),a=Ap(n,o,void 0,{dehydratedView:s});Up(i,a,0,ac(o,s))}function Se(n){let e=Qd();return El(e,oe+n)}function zi(n,e){return n<<17|e<<2}function xn(n){return n>>17&32767}function $E(n){return(n&2)==2}function qE(n,e){return n&131071|e<<17}function gc(n){return n|2}function ur(n){return(n&131068)>>2}function Gl(n,e){return n&-131069|e<<2}function WE(n){return(n&1)===1}function yc(n){return n|1}function GE(n,e,t,r,o,i){let s=i?e.classBindings:e.styleBindings,a=xn(s),l=ur(s);n[r]=t;let c=!1,u;if(Array.isArray(t)){let d=t;u=d[1],(u===null||Zn(d,u)>0)&&(c=!0)}else u=t;if(o)if(l!==0){let p=xn(n[a+1]);n[r+1]=zi(p,a),p!==0&&(n[p+1]=Gl(n[p+1],r)),n[a+1]=qE(n[a+1],r)}else n[r+1]=zi(a,0),a!==0&&(n[a+1]=Gl(n[a+1],r)),a=r;else n[r+1]=zi(l,0),a===0?a=r:n[l+1]=Gl(n[l+1],r),l=r;c&&(n[r+1]=gc(n[r+1])),Of(n,u,r,!0),Of(n,u,r,!1),zE(e,u,n,r,i),s=zi(a,l),i?e.classBindings=s:e.styleBindings=s}function zE(n,e,t,r,o){let i=o?n.residualClasses:n.residualStyles;i!=null&&typeof e=="string"&&Zn(i,e)>=0&&(t[r+1]=yc(t[r+1]))}function Of(n,e,t,r){let o=n[t+1],i=e===null,s=r?xn(o):ur(o),a=!1;for(;s!==0&&(a===!1||i);){let l=n[s],c=n[s+1];QE(l,e)&&(a=!0,n[s+1]=r?yc(c):gc(c)),s=r?xn(c):ur(c)}a&&(n[t+1]=r?gc(o):yc(o))}function QE(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?Zn(n,e)>=0:!1}var ut={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function ZE(n){return n.substring(ut.key,ut.keyEnd)}function YE(n){return KE(n),hh(n,mh(n,0,ut.textEnd))}function hh(n,e){let t=ut.textEnd;return t===e?-1:(e=ut.keyEnd=JE(n,ut.key=e,t),mh(n,e,t))}function KE(n){ut.key=0,ut.keyEnd=0,ut.value=0,ut.valueEnd=0,ut.textEnd=n.length}function mh(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function JE(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}function Is(n,e,t){return gh(n,e,t,!1),Is}function Ue(n,e){return gh(n,e,null,!0),Ue}function Rn(n){eD(sD,XE,n,!0)}function XE(n,e){for(let t=YE(e);t>=0;t=hh(e,t))ki(n,ZE(e),!0)}function gh(n,e,t,r){let o=L(),i=le(),s=Bi(2);if(i.firstUpdatePass&&vh(i,n,s,r),e!==Oe&&Qe(o,s,e)){let a=i.data[xt()];Eh(i,a,o,o[J],n,o[s+1]=lD(e,t),r,s)}}function eD(n,e,t,r){let o=le(),i=Bi(2);o.firstUpdatePass&&vh(o,null,i,r);let s=L();if(t!==Oe&&Qe(s,i,t)){let a=o.data[xt()];if(Dh(a,r)&&!yh(o,i)){let l=r?a.classesWithoutHost:a.stylesWithoutHost;l!==null&&(t=Mi(l,t||"")),mc(o,a,s,t,r)}else aD(o,a,s,s[J],s[i+1],s[i+1]=iD(n,e,t),r,i)}}function yh(n,e){return e>=n.expandoStartIndex}function vh(n,e,t,r){let o=n.data;if(o[t+1]===null){let i=o[xt()],s=yh(n,t);Dh(i,r)&&e===null&&!s&&(e=!1),e=tD(o,i,e,r),GE(o,i,e,t,s,r)}}function tD(n,e,t,r){let o=ef(n),i=r?e.residualClasses:e.residualStyles;if(o===null)(r?e.classBindings:e.styleBindings)===0&&(t=zl(null,n,e,t,r),t=so(t,e.attrs,r),i=null);else{let s=e.directiveStylingLast;if(s===-1||n[s]!==o)if(t=zl(o,n,e,t,r),i===null){let l=nD(n,e,r);l!==void 0&&Array.isArray(l)&&(l=zl(null,n,e,l[1],r),l=so(l,e.attrs,r),rD(n,e,r,l))}else i=oD(n,e,r)}return i!==void 0&&(r?e.residualClasses=i:e.residualStyles=i),t}function nD(n,e,t){let r=t?e.classBindings:e.styleBindings;if(ur(r)!==0)return n[xn(r)]}function rD(n,e,t,r){let o=t?e.classBindings:e.styleBindings;n[xn(o)]=r}function oD(n,e,t){let r,o=e.directiveEnd;for(let i=1+e.directiveStylingLast;i<o;i++){let s=n[i].hostAttrs;r=so(r,s,t)}return so(r,e.attrs,t)}function zl(n,e,t,r,o){let i=null,s=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<s&&(i=e[a],r=so(r,i.hostAttrs,o),i!==n);)a++;return n!==null&&(t.directiveStylingLast=a),r}function so(n,e,t){let r=t?1:2,o=-1;if(e!==null)for(let i=0;i<e.length;i++){let s=e[i];typeof s=="number"?o=s:o===r&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),ki(n,s,t?!0:e[++i]))}return n===void 0?null:n}function iD(n,e,t){if(t==null||t==="")return Me;let r=[],o=wc(t);if(Array.isArray(o))for(let i=0;i<o.length;i++)n(r,o[i],!0);else if(typeof o=="object")for(let i in o)o.hasOwnProperty(i)&&n(r,i,o[i]);else typeof o=="string"&&e(r,o);return r}function sD(n,e,t){let r=String(e);r!==""&&!r.includes(" ")&&ki(n,r,t)}function aD(n,e,t,r,o,i,s,a){o===Oe&&(o=Me);let l=0,c=0,u=0<o.length?o[0]:null,d=0<i.length?i[0]:null;for(;u!==null||d!==null;){let p=l<o.length?o[l+1]:void 0,f=c<i.length?i[c+1]:void 0,b=null,x;u===d?(l+=2,c+=2,p!==f&&(b=d,x=f)):d===null||u!==null&&u<d?(l+=2,b=u):(c+=2,b=d,x=f),b!==null&&Eh(n,e,t,r,b,x,s,a),u=l<o.length?o[l]:null,d=c<i.length?i[c]:null}}function Eh(n,e,t,r,o,i,s,a){if(!(e.type&3))return;let l=n.data,c=l[a+1],u=WE(c)?Pf(l,e,t,o,ur(c),s):void 0;if(!ds(u)){ds(i)||$E(c)&&(i=Pf(l,null,t,o,a,s));let d=vl(xt(),t);pv(r,s,d,o,i)}}function Pf(n,e,t,r,o,i){let s=e===null,a;for(;o>0;){let l=n[o],c=Array.isArray(l),u=c?l[1]:l,d=u===null,p=t[o+1];p===Oe&&(p=d?Me:void 0);let f=d?Oi(p,r):u===r?p:void 0;if(c&&!ds(f)&&(f=Oi(l,r)),ds(f)&&(a=f,s))return a;let b=n[o+1];o=s?xn(b):ur(b)}if(e!==null){let l=i?e.residualClasses:e.residualStyles;l!=null&&(a=Oi(l,r))}return a}function ds(n){return n!==void 0}function lD(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=Ot(wc(n)))),n}function Dh(n,e){return(n.flags&(e?8:16))!==0}function y(n,e=""){let t=L(),r=le(),o=n+oe,i=r.firstCreatePass?fr(r,o,1,e,null):r.data[o],s=cD(r,t,i,e,n);t[o]=s,qi()&&Pc(r,t,s,i),rr(i,!1)}var cD=(n,e,t,r,o)=>(Kr(!0),Fy(e[J],r));function uD(n,e,t,r=""){return Qe(n,or(),t)?e+Qn(t)+r:Oe}function dD(n,e,t,r,o,i=""){let s=Zd(),a=cs(n,s,t,o);return Bi(2),a?e+Qn(t)+r+Qn(o)+i:Oe}function Z(n){return Y("",n),Z}function Y(n,e,t){let r=L(),o=uD(r,n,e,t);return o!==Oe&&Ch(r,xt(),o),Y}function Zt(n,e,t,r,o){let i=L(),s=dD(i,n,e,t,r,o);return s!==Oe&&Ch(i,xt(),s),Zt}function Ch(n,e,t){let r=vl(e,n);Ly(n[J],r,t)}function ne(n,e,t){Ll(e)&&(e=e());let r=L(),o=or();if(Qe(r,o,e)){let i=le(),s=Yr();xp(s,r,n,e,r[J],t)}return ne}function ie(n,e){let t=Ll(n);return t&&n.set(e),t}function re(n,e){let t=L(),r=le(),o=fe();return ph(r,t,t[J],o,n,e),re}function fD(n,e,t){let r=le();if(r.firstCreatePass){let o=pt(n);vc(t,r.data,r.blueprint,o,!0),vc(e,r.data,r.blueprint,o,!1)}}function vc(n,e,t,r,o){if(n=ye(n),Array.isArray(n))for(let i=0;i<n.length;i++)vc(n[i],e,t,r,o);else{let i=le(),s=L(),a=fe(),l=pn(n)?n:ye(n.provide),c=hl(n),u=a.providerIndexes&1048575,d=a.directiveStart,p=a.providerIndexes>>20;if(pn(n)||!n.multi){let f=new Tn(c,o,_,null),b=Zl(l,e,o?u:u+p,d);b===-1?(Kl(ns(a,s),i,l),Ql(i,n,e.length),e.push(l),a.directiveStart++,a.directiveEnd++,o&&(a.providerIndexes+=1048576),t.push(f),s.push(f)):(t[b]=f,s[b]=f)}else{let f=Zl(l,e,u+p,d),b=Zl(l,e,u,u+p),x=f>=0&&t[f],S=b>=0&&t[b];if(o&&!S||!o&&!x){Kl(ns(a,s),i,l);let T=mD(o?hD:pD,t.length,o,r,c,n);!o&&S&&(t[b].providerFactory=T),Ql(i,n,e.length,0),e.push(l),a.directiveStart++,a.directiveEnd++,o&&(a.providerIndexes+=1048576),t.push(T),s.push(T)}else{let T=bh(t[o?b:f],c,!o&&r);Ql(i,n,f>-1?f:b,T)}!o&&r&&S&&t[b].componentProviders++}}}function Ql(n,e,t,r){let o=pn(e),i=Pd(e);if(o||i){let l=(i?ye(e.useClass):e).prototype.ngOnDestroy;if(l){let c=n.destroyHooks||(n.destroyHooks=[]);if(!o&&e.multi){let u=c.indexOf(t);u===-1?c.push(t,[r,l]):c[u+1].push(r,l)}else c.push(t,l)}}}function bh(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function Zl(n,e,t,r){for(let o=t;o<r;o++)if(e[o]===n)return o;return-1}function pD(n,e,t,r,o){return Ec(this.multi,[])}function hD(n,e,t,r,o){let i=this.multi,s;if(this.providerFactory){let a=this.providerFactory.componentProviders,l=rs(r,r[O],this.providerFactory.index,o);s=l.slice(0,a),Ec(i,s);for(let c=a;c<l.length;c++)s.push(l[c])}else s=[],Ec(i,s);return s}function Ec(n,e){for(let t=0;t<n.length;t++){let r=n[t];e.push(r())}return e}function mD(n,e,t,r,o,i){let s=new Tn(n,t,_,null);return s.multi=[],s.index=e,s.componentProviders=0,bh(s,o,r&&!t),s}function Yt(n,e=[]){return t=>{t.providersResolver=(r,o)=>fD(r,o?o(n):n,e)}}function ue(n,e,t){let r=wn()+n,o=L();return o[r]===Oe?fo(o,r,t?e.call(t):e()):Kp(o,r)}function yo(n,e,t,r){return _h(L(),wn(),n,e,t,r)}function Yc(n,e,t,r,o,i){return gD(L(),wn(),n,e,t,r,o,i)}function Kc(n,e,t,r,o,i,s){return yD(L(),wn(),n,e,t,r,o,i,s)}function Jc(n,e,t,r,o,i,s,a){let l=wn()+n,c=L(),u=Jp(c,l,t,r,o,i);return Qe(c,l+4,s)||u?fo(c,l+5,a?e.call(a,t,r,o,i,s):e(t,r,o,i,s)):Kp(c,l+5)}function Xc(n,e){let t=n[e];return t===Oe?void 0:t}function _h(n,e,t,r,o,i){let s=e+t;return Qe(n,s,o)?fo(n,s+1,i?r.call(i,o):r(o)):Xc(n,s+1)}function gD(n,e,t,r,o,i,s,a){let l=e+t;return oE(n,l,o,i,s)?fo(n,l+3,a?r.call(a,o,i,s):r(o,i,s)):Xc(n,l+3)}function yD(n,e,t,r,o,i,s,a,l){let c=e+t;return Jp(n,c,o,i,s,a)?fo(n,c+4,l?r.call(l,o,i,s,a):r(o,i,s,a)):Xc(n,c+4)}function kn(n,e){let t=le(),r,o=n+oe;t.firstCreatePass?(r=vD(e,t.pipeRegistry),t.data[o]=r,r.onDestroy&&(t.destroyHooks??=[]).push(o,r.onDestroy)):r=t.data[o];let i=r.factory||(r.factory=Pt(r.type,!0)),s,a=Te(_);try{let l=ts(!1),c=i();return ts(l),Dl(t,L(),o,c),c}finally{Te(a)}}function vD(n,e){if(e)for(let t=e.length-1;t>=0;t--){let r=e[t];if(n===r.name)return r}}function On(n,e,t){let r=n+oe,o=L(),i=El(o,r);return ED(o,r)?_h(o,wn(),e,i.transform,t,i):i.transform(t)}function ED(n,e){return n[O].data[e].pure}function Fe(n,e){return qp(n,e)}var DD=(()=>{class n{zone=M(se);changeDetectionScheduler=M(St);applicationRef=M(An);applicationErrorHandler=M(ht);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{try{this.applicationRef.dirtyFlags|=1,this.applicationRef._tick()}catch(t){this.applicationErrorHandler(t)}})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(r){return new(r||n)};static \u0275prov=I({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),wh=new R("",{factory:()=>!1});function eu({ngZoneFactory:n,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return n??=()=>new se(k(E({},nu()),{scheduleInRootZone:t})),[{provide:se,useFactory:n},{provide:gn,multi:!0,useFactory:()=>{let r=M(DD,{optional:!0});return()=>r.initialize()}},{provide:gn,multi:!0,useFactory:()=>{let r=M(CD);return()=>{r.initialize()}}},e===!0?{provide:Vl,useValue:!0}:[],{provide:jl,useValue:t??gp},{provide:ht,useFactory:()=>{let r=M(se),o=M(Ae),i;return s=>{r.runOutsideAngular(()=>{o.destroyed&&!i?setTimeout(()=>{throw s}):(i??=o.get(ot),i.handleError(s))})}}}]}function tu(n){let e=n?.ignoreChangesOutsideZone,t=n?.scheduleInRootZone,r=eu({ngZoneFactory:()=>{let o=nu(n);return o.scheduleInRootZone=t,o.shouldCoalesceEventChangeDetection&&Ds("NgZone_CoalesceEvent"),new se(o)},ignoreChangesOutsideZone:e,scheduleInRootZone:t});return Hr([{provide:wh,useValue:!0},{provide:Jr,useValue:!1},r])}function nu(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var CD=(()=>{class n{subscription=new ge;initialized=!1;zone=M(se);pendingTasks=M(qt);initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{se.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{se.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(r){return new(r||n)};static \u0275prov=I({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Ih=(()=>{class n{applicationErrorHandler=M(ht);appRef=M(An);taskService=M(qt);ngZone=M(se);zonelessEnabled=M(Jr);tracing=M(Nn,{optional:!0});disableScheduling=M(Vl,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new ge;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(is):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(M(jl,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof ss||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&t===5)return;let r=!1;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2,r=!0;break}case 12:{this.appRef.dirtyFlags|=16,r=!0;break}case 13:{this.appRef.dirtyFlags|=2,r=!0;break}case 11:{r=!0;break}case 9:case 8:case 7:case 10:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(r))return;let o=this.useMicrotaskScheduler?Df:yp;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>o(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>o(()=>this.tick()))}shouldScheduleTick(t){return!(this.disableScheduling&&!t||this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(is+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){this.taskService.remove(t),this.applicationErrorHandler(r)}finally{this.cleanup()}this.useMicrotaskScheduler=!0,Df(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(r){return new(r||n)};static \u0275prov=I({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function bD(){return typeof $localize<"u"&&$localize.locale||ho}var Ss=new R("",{providedIn:"root",factory:()=>M(Ss,{optional:!0,skipSelf:!0})||bD()});function Dt(n){return Cd(n)}function hr(n,e){return Xo(n,e?.equal)}var Sh=class{[Ne];constructor(e){this[Ne]=e}destroy(){this[Ne].destroy()}};var FD=new R("");FD.__NG_ELEMENT_ID__=n=>{let e=fe();if(e===null)throw new N(204,!1);if(e.type&2)return e.value;if(n&8)return null;throw new N(204,!1)};var ru=new R(""),LD=new R("");function vo(n){return!n.moduleRef}function VD(n){let e=vo(n)?n.r3Injector:n.moduleRef.injector,t=e.get(se);return t.run(()=>{vo(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let r=e.get(ht),o;if(t.runOutsideAngular(()=>{o=t.onError.subscribe({next:r})}),vo(n)){let i=()=>e.destroy(),s=n.platformInjector.get(ru);s.add(i),e.onDestroy(()=>{o.unsubscribe(),s.delete(i)})}else{let i=()=>n.moduleRef.destroy(),s=n.platformInjector.get(ru);s.add(i),n.moduleRef.onDestroy(()=>{to(n.allPlatformModules,n.moduleRef),o.unsubscribe(),s.delete(i)})}return BD(r,t,()=>{let i=e.get(qt),s=i.add(),a=e.get(Zc);return a.runInitializers(),a.donePromise.then(()=>{let l=e.get(Ss,ho);if(fh(l||ho),!e.get(LD,!0))return vo(n)?e.get(An):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(vo(n)){let u=e.get(An);return n.rootComponent!==void 0&&u.bootstrap(n.rootComponent),u}else return jD?.(n.moduleRef,n.allPlatformModules),n.moduleRef}).finally(()=>void i.remove(s))})})}var jD;function BD(n,e,t){try{let r=t();return pr(r)?r.catch(o=>{throw e.runOutsideAngular(()=>n(o)),o}):r}catch(r){throw e.runOutsideAngular(()=>n(r)),r}}var Ts=null;function HD(n=[],e){return rt.create({name:e,providers:[{provide:Ur,useValue:"platform"},{provide:ru,useValue:new Set([()=>Ts=null])},...n]})}function UD(n=[]){if(Ts)return Ts;let e=HD(n);return Ts=e,ch(),$D(e),e}function $D(n){let e=n.get(ms,null);Yn(n,()=>{e?.forEach(t=>t())})}var xs=(()=>{class n{static __NG_ELEMENT_ID__=qD}return n})();function qD(n){return WD(fe(),L(),(n&16)===16)}function WD(n,e,t){if(Bt(n)&&!t){let r=ze(n.index,e);return new Wt(r,r)}else if(n.type&175){let r=e[Re];return new Wt(r,e)}return null}var ou=class{constructor(){}supports(e){return Wc(e)}create(e){return new iu(e)}},GD=(n,e)=>e,iu=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(e){this._trackByFn=e||GD}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,o=0,i=null;for(;t||r;){let s=!r||t&&t.currentIndex<Th(r,o,i)?t:r,a=Th(s,o,i),l=s.currentIndex;if(s===r)o--,r=r._nextRemoved;else if(t=t._next,s.previousIndex==null)o++;else{i||(i=[]);let c=a-o,u=l-o;if(c!=u){for(let p=0;p<c;p++){let f=p<i.length?i[p]:i[p]=0,b=f+p;u<=b&&b<c&&(i[p]=f+1)}let d=s.previousIndex;i[d]=u-c}}a!==l&&e(s,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!Wc(e))throw new N(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,r=!1,o,i,s;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)i=e[a],s=this._trackByFn(a,i),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,i,s,a),r=!0):(r&&(t=this._verifyReinsertion(t,i,s,a)),Object.is(t.item,i)||this._addIdentityChange(t,i)),t=t._next}else o=0,Zp(e,a=>{s=this._trackByFn(o,a),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,a,s,o),r=!0):(r&&(t=this._verifyReinsertion(t,a,s,o)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,o++}),this.length=o;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,o){let i;return e===null?i=this._itTail:(i=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,i,o)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,o),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,i,o)):e=this._addAfter(new su(t,r),i,o)),e}_verifyReinsertion(e,t,r,o){let i=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return i!==null?e=this._reinsertAfter(i,e._prev,o):e.currentIndex!=o&&(e.currentIndex=o,this._addToMoves(e,o)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let o=e._prevRemoved,i=e._nextRemoved;return o===null?this._removalsHead=i:o._nextRemoved=i,i===null?this._removalsTail=o:i._prevRemoved=o,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){let o=t===null?this._itHead:t._next;return e._next=o,e._prev=t,o===null?this._itTail=e:o._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new Ms),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,r=e._next;return t===null?this._itHead=r:t._next=r,r===null?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Ms),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},su=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(e,t){this.item=e,this.trackById=t}},au=class{_head=null;_tail=null;add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;r!==null;r=r._nextDup)if((t===null||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let t=e._prevDup,r=e._nextDup;return t===null?this._head=r:t._nextDup=r,r===null?this._tail=t:r._prevDup=t,this._head===null}},Ms=class{map=new Map;put(e){let t=e.trackById,r=this.map.get(t);r||(r=new au,this.map.set(t,r)),r.add(e)}get(e,t){let r=e,o=this.map.get(r);return o?o.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function Th(n,e,t){let r=n.previousIndex;if(r===null)return r;let o=0;return t&&r<t.length&&(o=t[r]),r+e+o}function Mh(){return new lu([new ou])}var lu=(()=>{class n{factories;static \u0275prov=I({token:n,providedIn:"root",factory:Mh});constructor(t){this.factories=t}static create(t,r){if(r!=null){let o=r.factories.slice();t=t.concat(o)}return new n(t)}static extend(t){return{provide:n,useFactory:()=>{let r=M(n,{optional:!0,skipSelf:!0});return n.create(t,r||Mh())}}}find(t){let r=this.factories.find(o=>o.supports(t));if(r!=null)return r;throw new N(901,!1)}}return n})();function xh(n){let{rootComponent:e,appProviders:t,platformProviders:r,platformRef:o}=n;z(8);try{let i=o?.injector??UD(r),s=[eu({}),{provide:St,useExisting:Ih},cf,...t||[]],a=new io({providers:s,parent:i,debugName:"",runEnvironmentInitializers:!1});return VD({r3Injector:a.injector,platformInjector:i,rootComponent:e})}catch(i){return Promise.reject(i)}finally{z(9)}}function Nh(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}var Ah=null;function Kt(){return Ah}function cu(n){Ah??=n}var Eo=class{};var uu=/\s+/,Rh=[],Do=(()=>{class n{_ngEl;_renderer;initialClasses=Rh;rawClass;stateMap=new Map;constructor(t,r){this._ngEl=t,this._renderer=r}set klass(t){this.initialClasses=t!=null?t.trim().split(uu):Rh}set ngClass(t){this.rawClass=typeof t=="string"?t.trim().split(uu):t}ngDoCheck(){for(let r of this.initialClasses)this._updateState(r,!0);let t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(let r of t)this._updateState(r,!0);else if(t!=null)for(let r of Object.keys(t))this._updateState(r,!!t[r]);this._applyStateDiff()}_updateState(t,r){let o=this.stateMap.get(t);o!==void 0?(o.enabled!==r&&(o.changed=!0,o.enabled=r),o.touched=!0):this.stateMap.set(t,{enabled:r,changed:!0,touched:!0})}_applyStateDiff(){for(let t of this.stateMap){let r=t[0],o=t[1];o.changed?(this._toggleClass(r,o.enabled),o.changed=!1):o.touched||(o.enabled&&this._toggleClass(r,!1),this.stateMap.delete(r)),o.touched=!1}}_toggleClass(t,r){t=t.trim(),t.length>0&&t.split(uu).forEach(o=>{r?this._renderer.addClass(this._ngEl.nativeElement,o):this._renderer.removeClass(this._ngEl.nativeElement,o)})}static \u0275fac=function(r){return new(r||n)(_(At),_(Gt))};static \u0275dir=ce({type:n,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"}})}return n})();var Ns=class{$implicit;ngForOf;index;count;constructor(e,t,r,o){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=o}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},Ct=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,r,o){this._viewContainer=t,this._template=r,this._differs=o}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let r=this._viewContainer;t.forEachOperation((o,i,s)=>{if(o.previousIndex==null)r.createEmbeddedView(this._template,new Ns(o.item,this._ngForOf,-1,-1),s===null?void 0:s);else if(s==null)r.remove(i===null?void 0:i);else if(i!==null){let a=r.get(i);r.move(a,s),kh(a,o)}});for(let o=0,i=r.length;o<i;o++){let a=r.get(o).context;a.index=o,a.count=i,a.ngForOf=this._ngForOf}t.forEachIdentityChange(o=>{let i=r.get(o.currentIndex);kh(i,o)})}static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(_(po),_(uo),_(lu))};static \u0275dir=ce({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function kh(n,e){n.context.$implicit=e.item}var ee=(()=>{class n{_viewContainer;_context=new As;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(t,r){this._viewContainer=t,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){Oh(t,!1),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){Oh(t,!1),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(_(po),_(uo))};static \u0275dir=ce({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})(),As=class{$implicit=null;ngIf=null};function Oh(n,e){if(n&&!n.createEmbeddedView)throw new N(2020,!1)}var Co=(()=>{class n{transform(t){return JSON.stringify(t,null,2)}static \u0275fac=function(r){return new(r||n)};static \u0275pipe=Gc({name:"json",type:n,pure:!1})}return n})();var G=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=zt({type:n});static \u0275inj=Tt({})}return n})();function bo(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[o,i]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(o.trim()===e)return decodeURIComponent(i)}return null}var Pn=class{};var Ph="browser";var _o=class{_doc;constructor(e){this._doc=e}manager},Rs=(()=>{class n extends _o{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,o,i){return t.addEventListener(r,o,i),()=>this.removeEventListener(t,r,o,i)}removeEventListener(t,r,o,i){return t.removeEventListener(r,o,i)}static \u0275fac=function(r){return new(r||n)(C(He))};static \u0275prov=I({token:n,factory:n.\u0275fac})}return n})(),Os=new R(""),mu=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,r){this._zone=r,t.forEach(s=>{s.manager=this});let o=t.filter(s=>!(s instanceof Rs));this._plugins=o.slice().reverse();let i=t.find(s=>s instanceof Rs);i&&this._plugins.push(i)}addEventListener(t,r,o,i){return this._findPluginFor(r).addEventListener(t,r,o,i)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(i=>i.supports(t)),!r)throw new N(5101,!1);return this._eventNameToPlugin.set(t,r),r}static \u0275fac=function(r){return new(r||n)(C(Os),C(se))};static \u0275prov=I({token:n,factory:n.\u0275fac})}return n})(),du="ng-app-id";function Fh(n){for(let e of n)e.remove()}function Lh(n,e){let t=e.createElement("style");return t.textContent=n,t}function zD(n,e,t,r){let o=n.head?.querySelectorAll(`style[${du}="${e}"],link[${du}="${e}"]`);if(o)for(let i of o)i.removeAttribute(du),i instanceof HTMLLinkElement?r.set(i.href.slice(i.href.lastIndexOf("/")+1),{usage:0,elements:[i]}):i.textContent&&t.set(i.textContent,{usage:0,elements:[i]})}function pu(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var gu=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(t,r,o,i={}){this.doc=t,this.appId=r,this.nonce=o,zD(t,r,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,r){for(let o of t)this.addUsage(o,this.inline,Lh);r?.forEach(o=>this.addUsage(o,this.external,pu))}removeStyles(t,r){for(let o of t)this.removeUsage(o,this.inline);r?.forEach(o=>this.removeUsage(o,this.external))}addUsage(t,r,o){let i=r.get(t);i?i.usage++:r.set(t,{usage:1,elements:[...this.hosts].map(s=>this.addElement(s,o(t,this.doc)))})}removeUsage(t,r){let o=r.get(t);o&&(o.usage--,o.usage<=0&&(Fh(o.elements),r.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])Fh(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[r,{elements:o}]of this.inline)o.push(this.addElement(t,Lh(r,this.doc)));for(let[r,{elements:o}]of this.external)o.push(this.addElement(t,pu(r,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,r){return this.nonce&&r.setAttribute("nonce",this.nonce),t.appendChild(r)}static \u0275fac=function(r){return new(r||n)(C(He),C(hs),C(gs,8),C(lo))};static \u0275prov=I({token:n,factory:n.\u0275fac})}return n})(),fu={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},yu=/%COMP%/g;var jh="%COMP%",QD=`_nghost-${jh}`,ZD=`_ngcontent-${jh}`,YD=!0,KD=new R("",{providedIn:"root",factory:()=>YD});function JD(n){return ZD.replace(yu,n)}function XD(n){return QD.replace(yu,n)}function Bh(n,e){return e.map(t=>t.replace(yu,n))}var vu=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(t,r,o,i,s,a,l=null,c=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=o,this.removeStylesOnCompDestroy=i,this.doc=s,this.ngZone=a,this.nonce=l,this.tracingService=c,this.platformIsServer=!1,this.defaultRenderer=new wo(t,s,a,this.platformIsServer,this.tracingService)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;let o=this.getOrCreateRenderer(t,r);return o instanceof ks?o.applyToHost(t):o instanceof Io&&o.applyStyles(),o}getOrCreateRenderer(t,r){let o=this.rendererByCompId,i=o.get(r.id);if(!i){let s=this.doc,a=this.ngZone,l=this.eventManager,c=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,d=this.platformIsServer,p=this.tracingService;switch(r.encapsulation){case Nt.Emulated:i=new ks(l,c,r,this.appId,u,s,a,d,p);break;case Nt.ShadowDom:return new hu(l,c,t,r,s,a,this.nonce,d,p);default:i=new Io(l,c,r,u,s,a,d,p);break}o.set(r.id,i)}return i}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(r){return new(r||n)(C(mu),C(gu),C(hs),C(KD),C(He),C(se),C(gs),C(Nn,8))};static \u0275prov=I({token:n,factory:n.\u0275fac})}return n})(),wo=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,r,o,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=o,this.tracingService=i}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(fu[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(Vh(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(Vh(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new N(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,o){if(o){t=o+":"+t;let i=fu[o];i?e.setAttributeNS(i,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let o=fu[r];o?e.removeAttributeNS(o,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,o){o&(gt.DashCase|gt.Important)?e.style.setProperty(t,r,o&gt.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&gt.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r,o){if(typeof e=="string"&&(e=Kt().getGlobalEventTarget(this.doc,e),!e))throw new N(5102,!1);let i=this.decoratePreventDefault(r);return this.tracingService?.wrapEventListener&&(i=this.tracingService.wrapEventListener(e,t,i)),this.eventManager.addEventListener(e,t,i,o)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;e(t)===!1&&t.preventDefault()}}};function Vh(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var hu=class extends wo{sharedStylesHost;hostEl;shadowRoot;constructor(e,t,r,o,i,s,a,l,c){super(e,i,s,l,c),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let u=o.styles;u=Bh(o.id,u);for(let p of u){let f=document.createElement("style");a&&f.setAttribute("nonce",a),f.textContent=p,this.shadowRoot.appendChild(f)}let d=o.getExternalStyles?.();if(d)for(let p of d){let f=pu(p,i);a&&f.setAttribute("nonce",a),this.shadowRoot.appendChild(f)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Io=class extends wo{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,r,o,i,s,a,l,c){super(e,i,s,a,l),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=o;let u=r.styles;this.styles=c?Bh(c,u):u,this.styleUrls=r.getExternalStyles?.(c)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&cr.size===0&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},ks=class extends Io{contentAttr;hostAttr;constructor(e,t,r,o,i,s,a,l,c){let u=o+"-"+r.id;super(e,t,r,i,s,a,l,c,u),this.contentAttr=JD(u),this.hostAttr=XD(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}};var Ps=class n extends Eo{supportsDOMEvents=!0;static makeCurrent(){cu(new n)}onAndCancel(e,t,r,o){return e.addEventListener(t,r,o),()=>{e.removeEventListener(t,r,o)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=eC();return t==null?null:tC(t)}resetBaseElement(){So=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return bo(document.cookie,e)}},So=null;function eC(){return So=So||document.head.querySelector("base"),So?So.getAttribute("href"):null}function tC(n){return new URL(n,document.baseURI).pathname}var nC=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||n)};static \u0275prov=I({token:n,factory:n.\u0275fac})}return n})(),Hh=["alt","control","meta","shift"],rC={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},oC={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},Uh=(()=>{class n extends _o{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,o,i){let s=n.parseEventName(r),a=n.eventCallback(s.fullKey,o,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Kt().onAndCancel(t,s.domEventName,a,i))}static parseEventName(t){let r=t.toLowerCase().split("."),o=r.shift();if(r.length===0||!(o==="keydown"||o==="keyup"))return null;let i=n._normalizeKey(r.pop()),s="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),s="code."),Hh.forEach(c=>{let u=r.indexOf(c);u>-1&&(r.splice(u,1),s+=c+".")}),s+=i,r.length!=0||i.length===0)return null;let l={};return l.domEventName=o,l.fullKey=s,l}static matchEventFullKeyCode(t,r){let o=rC[t.key]||t.key,i="";return r.indexOf("code.")>-1&&(o=t.code,i="code."),o==null||!o?!1:(o=o.toLowerCase(),o===" "?o="space":o==="."&&(o="dot"),Hh.forEach(s=>{if(s!==o){let a=oC[s];a(t)&&(i+=s+".")}}),i+=o,i===r)}static eventCallback(t,r,o){return i=>{n.matchEventFullKeyCode(i,t)&&o.runGuarded(()=>r(i))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(r){return new(r||n)(C(He))};static \u0275prov=I({token:n,factory:n.\u0275fac})}return n})();function Eu(n,e,t){let r=E({rootComponent:n,platformRef:t?.platformRef},iC(e));return xh(r)}function iC(n){return{appProviders:[...uC,...n?.providers??[]],platformProviders:cC}}function sC(){Ps.makeCurrent()}function aC(){return new ot}function lC(){return bc(document),document}var cC=[{provide:lo,useValue:Ph},{provide:ms,useValue:sC,multi:!0},{provide:He,useFactory:lC}];var uC=[{provide:Ur,useValue:"root"},{provide:ot,useFactory:aC},{provide:Os,useClass:Rs,multi:!0,deps:[He]},{provide:Os,useClass:Uh,multi:!0,deps:[He]},vu,gu,mu,{provide:Mn,useExisting:vu},{provide:Pn,useClass:nC},[]];var yr=class{},To=class{},bt=class n{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(e){e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let r=t.indexOf(":");if(r>0){let o=t.slice(0,r),i=t.slice(r+1).trim();this.addHeaderEntry(o,i)}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,r)=>{this.addHeaderEntry(r,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,r])=>{this.setHeaderEntries(t,r)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new n;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(e.name,t);let o=(e.op==="a"?this.headers.get(t):void 0)||[];o.push(...r),this.headers.set(t,o);break;case"d":let i=e.value;if(!i)this.headers.delete(t),this.normalizedNames.delete(t);else{let s=this.headers.get(t);if(!s)return;s=s.filter(a=>i.indexOf(a)===-1),s.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,s)}break}}addHeaderEntry(e,t){let r=e.toLowerCase();this.maybeSetNormalizedName(e,r),this.headers.has(r)?this.headers.get(r).push(t):this.headers.set(r,[t])}setHeaderEntries(e,t){let r=(Array.isArray(t)?t:[t]).map(i=>i.toString()),o=e.toLowerCase();this.headers.set(o,r),this.maybeSetNormalizedName(e,o)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var Ls=class{encodeKey(e){return $h(e)}encodeValue(e){return $h(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function dC(n,e){let t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(o=>{let i=o.indexOf("="),[s,a]=i==-1?[e.decodeKey(o),""]:[e.decodeKey(o.slice(0,i)),e.decodeValue(o.slice(i+1))],l=t.get(s)||[];l.push(a),t.set(s,l)}),t}var fC=/%(\d[a-f0-9])/gi,pC={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function $h(n){return encodeURIComponent(n).replace(fC,(e,t)=>pC[t]??e)}function Fs(n){return`${n}`}var Rt=class n{map;encoder;updates=null;cloneFrom=null;constructor(e={}){if(this.encoder=e.encoder||new Ls,e.fromString){if(e.fromObject)throw new N(2805,!1);this.map=dC(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{let r=e.fromObject[t],o=Array.isArray(r)?r.map(Fs):[Fs(r)];this.map.set(t,o)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){let t=[];return Object.keys(e).forEach(r=>{let o=e[r];Array.isArray(o)?o.forEach(i=>{t.push({param:r,value:i,op:"a"})}):t.push({param:r,value:o,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let t=this.encoder.encodeKey(e);return this.map.get(e).map(r=>t+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let t=new n({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let t=(e.op==="a"?this.map.get(e.param):void 0)||[];t.push(Fs(e.value)),this.map.set(e.param,t);break;case"d":if(e.value!==void 0){let r=this.map.get(e.param)||[],o=r.indexOf(Fs(e.value));o!==-1&&r.splice(o,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var Vs=class{map=new Map;set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function hC(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function qh(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function Wh(n){return typeof Blob<"u"&&n instanceof Blob}function Gh(n){return typeof FormData<"u"&&n instanceof FormData}function mC(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}var zh="Content-Type",Qh="Accept",Zh="X-Request-URL",Yh="text/plain",Kh="application/json",gC=`${Kh}, ${Yh}, */*`,mr=class n{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;credentials;keepalive=!1;cache;priority;mode;redirect;referrer;integrity;responseType="json";method;params;urlWithParams;transferCache;timeout;constructor(e,t,r,o){this.url=t,this.method=e.toUpperCase();let i;if(hC(this.method)||o?(this.body=r!==void 0?r:null,i=o):i=r,i){if(this.reportProgress=!!i.reportProgress,this.withCredentials=!!i.withCredentials,this.keepalive=!!i.keepalive,i.responseType&&(this.responseType=i.responseType),i.headers&&(this.headers=i.headers),i.context&&(this.context=i.context),i.params&&(this.params=i.params),i.priority&&(this.priority=i.priority),i.cache&&(this.cache=i.cache),i.credentials&&(this.credentials=i.credentials),typeof i.timeout=="number"){if(i.timeout<1||!Number.isInteger(i.timeout))throw new N(2822,"");this.timeout=i.timeout}i.mode&&(this.mode=i.mode),i.redirect&&(this.redirect=i.redirect),i.integrity&&(this.integrity=i.integrity),i.referrer&&(this.referrer=i.referrer),this.transferCache=i.transferCache}if(this.headers??=new bt,this.context??=new Vs,!this.params)this.params=new Rt,this.urlWithParams=t;else{let s=this.params.toString();if(s.length===0)this.urlWithParams=t;else{let a=t.indexOf("?"),l=a===-1?"?":a<t.length-1?"&":"";this.urlWithParams=t+l+s}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||qh(this.body)||Wh(this.body)||Gh(this.body)||mC(this.body)?this.body:this.body instanceof Rt?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||Gh(this.body)?null:Wh(this.body)?this.body.type||null:qh(this.body)?null:typeof this.body=="string"?Yh:this.body instanceof Rt?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?Kh:null}clone(e={}){let t=e.method||this.method,r=e.url||this.url,o=e.responseType||this.responseType,i=e.keepalive??this.keepalive,s=e.priority||this.priority,a=e.cache||this.cache,l=e.mode||this.mode,c=e.redirect||this.redirect,u=e.credentials||this.credentials,d=e.referrer||this.referrer,p=e.integrity||this.integrity,f=e.transferCache??this.transferCache,b=e.timeout??this.timeout,x=e.body!==void 0?e.body:this.body,S=e.withCredentials??this.withCredentials,T=e.reportProgress??this.reportProgress,me=e.headers||this.headers,et=e.params||this.params,Ee=e.context??this.context;return e.setHeaders!==void 0&&(me=Object.keys(e.setHeaders).reduce((on,sn)=>on.set(sn,e.setHeaders[sn]),me)),e.setParams&&(et=Object.keys(e.setParams).reduce((on,sn)=>on.set(sn,e.setParams[sn]),et)),new n(t,r,x,{params:et,headers:me,context:Ee,reportProgress:T,responseType:o,withCredentials:S,transferCache:f,keepalive:i,cache:a,priority:s,timeout:b,mode:l,redirect:c,credentials:u,referrer:d,integrity:p})}},Fn=(function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n})(Fn||{}),vr=class{headers;status;statusText;url;ok;type;redirected;constructor(e,t=200,r="OK"){this.headers=e.headers||new bt,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||r,this.url=e.url||null,this.redirected=e.redirected,this.ok=this.status>=200&&this.status<300}},js=class n extends vr{constructor(e={}){super(e)}type=Fn.ResponseHeader;clone(e={}){return new n({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Mo=class n extends vr{body;constructor(e={}){super(e),this.body=e.body!==void 0?e.body:null}type=Fn.Response;clone(e={}){return new n({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0,redirected:e.redirected??this.redirected})}},gr=class extends vr{name="HttpErrorResponse";message;error;ok=!1;constructor(e){super(e,0,"Unknown Error"),this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},yC=200,vC=204;function Du(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,credentials:n.credentials,transferCache:n.transferCache,timeout:n.timeout,keepalive:n.keepalive,priority:n.priority,cache:n.cache,mode:n.mode,redirect:n.redirect,integrity:n.integrity,referrer:n.referrer}}var Hs=(()=>{class n{handler;constructor(t){this.handler=t}request(t,r,o={}){let i;if(t instanceof mr)i=t;else{let l;o.headers instanceof bt?l=o.headers:l=new bt(o.headers);let c;o.params&&(o.params instanceof Rt?c=o.params:c=new Rt({fromObject:o.params})),i=new mr(t,r,o.body!==void 0?o.body:null,{headers:l,context:o.context,params:c,reportProgress:o.reportProgress,responseType:o.responseType||"json",withCredentials:o.withCredentials,transferCache:o.transferCache,keepalive:o.keepalive,priority:o.priority,cache:o.cache,mode:o.mode,redirect:o.redirect,credentials:o.credentials,referrer:o.referrer,integrity:o.integrity,timeout:o.timeout})}let s=bi(i).pipe(Ba(l=>this.handler.handle(l)));if(t instanceof mr||o.observe==="events")return s;let a=s.pipe(ja(l=>l instanceof Mo));switch(o.observe||"body"){case"body":switch(i.responseType){case"arraybuffer":return a.pipe(de(l=>{if(l.body!==null&&!(l.body instanceof ArrayBuffer))throw new N(2806,!1);return l.body}));case"blob":return a.pipe(de(l=>{if(l.body!==null&&!(l.body instanceof Blob))throw new N(2807,!1);return l.body}));case"text":return a.pipe(de(l=>{if(l.body!==null&&typeof l.body!="string")throw new N(2808,!1);return l.body}));case"json":default:return a.pipe(de(l=>l.body))}case"response":return a;default:throw new N(2809,!1)}}delete(t,r={}){return this.request("DELETE",t,r)}get(t,r={}){return this.request("GET",t,r)}head(t,r={}){return this.request("HEAD",t,r)}jsonp(t,r){return this.request("JSONP",t,{params:new Rt().append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,r={}){return this.request("OPTIONS",t,r)}patch(t,r,o={}){return this.request("PATCH",t,Du(o,r))}post(t,r,o={}){return this.request("POST",t,Du(o,r))}put(t,r,o={}){return this.request("PUT",t,Du(o,r))}static \u0275fac=function(r){return new(r||n)(C(yr))};static \u0275prov=I({token:n,factory:n.\u0275fac})}return n})();var EC=new R("");function DC(n,e){return e(n)}function CC(n,e,t){return(r,o)=>Yn(t,()=>e(r,i=>n(i,o)))}var Jh=new R(""),Xh=new R(""),em=new R("",{providedIn:"root",factory:()=>!0});var Bs=(()=>{class n extends yr{backend;injector;chain=null;pendingTasks=M(Gi);contributeToStability=M(em);constructor(t,r){super(),this.backend=t,this.injector=r}handle(t){if(this.chain===null){let r=Array.from(new Set([...this.injector.get(Jh),...this.injector.get(Xh,[])]));this.chain=r.reduceRight((o,i)=>CC(o,i,this.injector),DC)}if(this.contributeToStability){let r=this.pendingTasks.add();return this.chain(t,o=>this.backend.handle(o)).pipe(Ha(r))}else return this.chain(t,r=>this.backend.handle(r))}static \u0275fac=function(r){return new(r||n)(C(To),C(Ae))};static \u0275prov=I({token:n,factory:n.\u0275fac})}return n})();var bC=/^\)\]\}',?\n/,_C=RegExp(`^${Zh}:`,"m");function wC(n){return"responseURL"in n&&n.responseURL?n.responseURL:_C.test(n.getAllResponseHeaders())?n.getResponseHeader(Zh):null}var Cu=(()=>{class n{xhrFactory;constructor(t){this.xhrFactory=t}handle(t){if(t.method==="JSONP")throw new N(-2800,!1);let r=this.xhrFactory;return bi(null).pipe(Ua(()=>new X(i=>{let s=r.build();if(s.open(t.method,t.urlWithParams),t.withCredentials&&(s.withCredentials=!0),t.headers.forEach((S,T)=>s.setRequestHeader(S,T.join(","))),t.headers.has(Qh)||s.setRequestHeader(Qh,gC),!t.headers.has(zh)){let S=t.detectContentTypeHeader();S!==null&&s.setRequestHeader(zh,S)}if(t.timeout&&(s.timeout=t.timeout),t.responseType){let S=t.responseType.toLowerCase();s.responseType=S!=="json"?S:"text"}let a=t.serializeBody(),l=null,c=()=>{if(l!==null)return l;let S=s.statusText||"OK",T=new bt(s.getAllResponseHeaders()),me=wC(s)||t.url;return l=new js({headers:T,status:s.status,statusText:S,url:me}),l},u=()=>{let{headers:S,status:T,statusText:me,url:et}=c(),Ee=null;T!==vC&&(Ee=typeof s.response>"u"?s.responseText:s.response),T===0&&(T=Ee?yC:0);let on=T>=200&&T<300;if(t.responseType==="json"&&typeof Ee=="string"){let sn=Ee;Ee=Ee.replace(bC,"");try{Ee=Ee!==""?JSON.parse(Ee):null}catch(Lm){Ee=sn,on&&(on=!1,Ee={error:Lm,text:Ee})}}on?(i.next(new Mo({body:Ee,headers:S,status:T,statusText:me,url:et||void 0})),i.complete()):i.error(new gr({error:Ee,headers:S,status:T,statusText:me,url:et||void 0}))},d=S=>{let{url:T}=c(),me=new gr({error:S,status:s.status||0,statusText:s.statusText||"Unknown Error",url:T||void 0});i.error(me)},p=d;t.timeout&&(p=S=>{let{url:T}=c(),me=new gr({error:new DOMException("Request timed out","TimeoutError"),status:s.status||0,statusText:s.statusText||"Request timeout",url:T||void 0});i.error(me)});let f=!1,b=S=>{f||(i.next(c()),f=!0);let T={type:Fn.DownloadProgress,loaded:S.loaded};S.lengthComputable&&(T.total=S.total),t.responseType==="text"&&s.responseText&&(T.partialText=s.responseText),i.next(T)},x=S=>{let T={type:Fn.UploadProgress,loaded:S.loaded};S.lengthComputable&&(T.total=S.total),i.next(T)};return s.addEventListener("load",u),s.addEventListener("error",d),s.addEventListener("timeout",p),s.addEventListener("abort",d),t.reportProgress&&(s.addEventListener("progress",b),a!==null&&s.upload&&s.upload.addEventListener("progress",x)),s.send(a),i.next({type:Fn.Sent}),()=>{s.removeEventListener("error",d),s.removeEventListener("abort",d),s.removeEventListener("load",u),s.removeEventListener("timeout",p),t.reportProgress&&(s.removeEventListener("progress",b),a!==null&&s.upload&&s.upload.removeEventListener("progress",x)),s.readyState!==s.DONE&&s.abort()}})))}static \u0275fac=function(r){return new(r||n)(C(Pn))};static \u0275prov=I({token:n,factory:n.\u0275fac})}return n})(),tm=new R(""),IC="XSRF-TOKEN",SC=new R("",{providedIn:"root",factory:()=>IC}),TC="X-XSRF-TOKEN",MC=new R("",{providedIn:"root",factory:()=>TC}),xo=class{},xC=(()=>{class n{doc;cookieName;lastCookieString="";lastToken=null;parseCount=0;constructor(t,r){this.doc=t,this.cookieName=r}getToken(){let t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=bo(t,this.cookieName),this.lastCookieString=t),this.lastToken}static \u0275fac=function(r){return new(r||n)(C(He),C(SC))};static \u0275prov=I({token:n,factory:n.\u0275fac})}return n})();function NC(n,e){let t=n.url.toLowerCase();if(!M(tm)||n.method==="GET"||n.method==="HEAD"||t.startsWith("http://")||t.startsWith("https://"))return e(n);let r=M(xo).getToken(),o=M(MC);return r!=null&&!n.headers.has(o)&&(n=n.clone({headers:n.headers.set(o,r)})),e(n)}function bu(...n){let e=[Hs,Cu,Bs,{provide:yr,useExisting:Bs},{provide:To,useFactory:()=>M(EC,{optional:!0})??M(Cu)},{provide:Jh,useValue:NC,multi:!0},{provide:tm,useValue:!0},{provide:xo,useClass:xC}];for(let t of n)e.push(...t.\u0275providers);return Hr(e)}var um=(()=>{class n{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,r){this._renderer=t,this._elementRef=r}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(r){return new(r||n)(_(Gt),_(At))};static \u0275dir=ce({type:n})}return n})(),Ys=(()=>{class n extends um{static \u0275fac=(()=>{let t;return function(o){return(t||(t=dr(n)))(o||n)}})();static \u0275dir=ce({type:n,features:[Ze]})}return n})(),Fo=new R(""),AC={provide:Fo,useExisting:it(()=>Iu),multi:!0},Iu=(()=>{class n extends Ys{writeValue(t){this.setProperty("checked",t)}static \u0275fac=(()=>{let t;return function(o){return(t||(t=dr(n)))(o||n)}})();static \u0275dir=ce({type:n,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(r,o){r&1&&W("change",function(s){return o.onChange(s.target.checked)})("blur",function(){return o.onTouched()})},standalone:!1,features:[Yt([AC]),Ze]})}return n})(),RC={provide:Fo,useExisting:it(()=>br),multi:!0};function kC(){let n=Kt()?Kt().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var OC=new R(""),br=(()=>{class n extends um{_compositionMode;_composing=!1;constructor(t,r,o){super(t,r),this._compositionMode=o,this._compositionMode==null&&(this._compositionMode=!kC())}writeValue(t){let r=t??"";this.setProperty("value",r)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(r){return new(r||n)(_(Gt),_(At),_(OC,8))};static \u0275dir=ce({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,o){r&1&&W("input",function(s){return o._handleInput(s.target.value)})("blur",function(){return o.onTouched()})("compositionstart",function(){return o._compositionStart()})("compositionend",function(s){return o._compositionEnd(s.target.value)})},standalone:!1,features:[Yt([RC]),Ze]})}return n})();var dm=new R(""),fm=new R("");function pm(n){return n!=null}function hm(n){return pr(n)?Pr(n):n}function mm(n){let e={};return n.forEach(t=>{e=t!=null?E(E({},e),t):e}),Object.keys(e).length===0?null:e}function gm(n,e){return e.map(t=>t(n))}function PC(n){return!n.validate}function ym(n){return n.map(e=>PC(e)?e:t=>e.validate(t))}function FC(n){if(!n)return null;let e=n.filter(pm);return e.length==0?null:function(t){return mm(gm(t,e))}}function Su(n){return n!=null?FC(ym(n)):null}function LC(n){if(!n)return null;let e=n.filter(pm);return e.length==0?null:function(t){let r=gm(t,e).map(hm);return La(r).pipe(de(mm))}}function Tu(n){return n!=null?LC(ym(n)):null}function nm(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function VC(n){return n._rawValidators}function jC(n){return n._rawAsyncValidators}function _u(n){return n?Array.isArray(n)?n:[n]:[]}function $s(n,e){return Array.isArray(n)?n.includes(e):n===e}function rm(n,e){let t=_u(e);return _u(n).forEach(o=>{$s(t,o)||t.push(o)}),t}function om(n,e){return _u(e).filter(t=>!$s(n,t))}var qs=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Su(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Tu(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},Cr=class extends qs{name;get formDirective(){return null}get path(){return null}},Po=class extends qs{_parent=null;name=null;valueAccessor=null},Ws=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},BC={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},xL=k(E({},BC),{"[class.ng-submitted]":"isSubmitted"}),_r=(()=>{class n extends Ws{constructor(t){super(t)}static \u0275fac=function(r){return new(r||n)(_(Po,2))};static \u0275dir=ce({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,o){r&2&&Ue("ng-untouched",o.isUntouched)("ng-touched",o.isTouched)("ng-pristine",o.isPristine)("ng-dirty",o.isDirty)("ng-valid",o.isValid)("ng-invalid",o.isInvalid)("ng-pending",o.isPending)},standalone:!1,features:[Ze]})}return n})(),vm=(()=>{class n extends Ws{constructor(t){super(t)}static \u0275fac=function(r){return new(r||n)(_(Cr,10))};static \u0275dir=ce({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,o){r&2&&Ue("ng-untouched",o.isUntouched)("ng-touched",o.isTouched)("ng-pristine",o.isPristine)("ng-dirty",o.isDirty)("ng-valid",o.isValid)("ng-invalid",o.isInvalid)("ng-pending",o.isPending)("ng-submitted",o.isSubmitted)},standalone:!1,features:[Ze]})}return n})();var No="VALID",Us="INVALID",Er="PENDING",Ao="DISABLED",Jt=class{},Gs=class extends Jt{value;source;constructor(e,t){super(),this.value=e,this.source=t}},ko=class extends Jt{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},Oo=class extends Jt{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},Dr=class extends Jt{status;source;constructor(e,t){super(),this.status=e,this.source=t}},wu=class extends Jt{source;constructor(e){super(),this.source=e}},zs=class extends Jt{source;constructor(e){super(),this.source=e}};function Em(n){return(Ks(n)?n.validators:n)||null}function HC(n){return Array.isArray(n)?Su(n):n||null}function Dm(n,e){return(Ks(e)?e.asyncValidators:n)||null}function UC(n){return Array.isArray(n)?Tu(n):n||null}function Ks(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function $C(n,e,t){let r=n.controls;if(!(e?Object.keys(r):r).length)throw new N(1e3,"");if(!r[t])throw new N(1001,"")}function qC(n,e,t){n._forEachChild((r,o)=>{if(t[o]===void 0)throw new N(1002,"")})}var Qs=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return Dt(this.statusReactive)}set status(e){Dt(()=>this.statusReactive.set(e))}_status=hr(()=>this.statusReactive());statusReactive=In(void 0);get valid(){return this.status===No}get invalid(){return this.status===Us}get pending(){return this.status==Er}get disabled(){return this.status===Ao}get enabled(){return this.status!==Ao}errors;get pristine(){return Dt(this.pristineReactive)}set pristine(e){Dt(()=>this.pristineReactive.set(e))}_pristine=hr(()=>this.pristineReactive());pristineReactive=In(!0);get dirty(){return!this.pristine}get touched(){return Dt(this.touchedReactive)}set touched(e){Dt(()=>this.touchedReactive.set(e))}_touched=hr(()=>this.touchedReactive());touchedReactive=In(!1);get untouched(){return!this.touched}_events=new nt;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(rm(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(rm(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(om(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(om(e,this._rawAsyncValidators))}hasValidator(e){return $s(this._rawValidators,e)}hasAsyncValidator(e){return $s(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(k(E({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new Oo(!0,r))}markAllAsDirty(e={}){this.markAsDirty({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsDirty(e))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=e.sourceControl??this;this._forEachChild(o=>{o.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:r})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,r),t&&e.emitEvent!==!1&&this._events.next(new Oo(!1,r))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(k(E({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new ko(!1,r))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=e.sourceControl??this;this._forEachChild(o=>{o.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,r),t&&e.emitEvent!==!1&&this._events.next(new ko(!0,r))}markAsPending(e={}){this.status=Er;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Dr(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(k(E({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Ao,this.errors=null,this._forEachChild(o=>{o.disable(k(E({},e),{onlySelf:!0}))}),this._updateValue();let r=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Gs(this.value,r)),this._events.next(new Dr(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(k(E({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(o=>o(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=No,this._forEachChild(r=>{r.enable(k(E({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(k(E({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===No||this.status===Er)&&this._runAsyncValidator(r,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Gs(this.value,t)),this._events.next(new Dr(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(k(E({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Ao:No}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=Er,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1,shouldHaveEmitted:e!==!1};let r=hm(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(o=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(o,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,o)=>r&&r._find(o),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,r){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||r)&&this._events.next(new Dr(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,r)}_initObservables(){this.valueChanges=new pe,this.statusChanges=new pe}_calculateStatus(){return this._allControlsDisabled()?Ao:this.errors?Us:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Er)?Er:this._anyControlsHaveStatus(Us)?Us:No}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let r=!this._anyControlsDirty(),o=this.pristine!==r;this.pristine=r,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),o&&this._events.next(new ko(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new Oo(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Ks(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=HC(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=UC(this._rawAsyncValidators)}},Zs=class extends Qs{constructor(e,t,r){super(Em(t),Dm(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){qC(this,!0,e),Object.keys(e).forEach(r=>{$C(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(r=>{let o=this.controls[r];o&&o.patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,o)=>{r.reset(e?e[o]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t),t?.emitEvent!==!1&&this._events.next(new zs(this))}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>r._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,r]of Object.entries(this.controls))if(this.contains(t)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,r,o)=>((r.enabled||this.disabled)&&(t[o]=r.value),t))}_reduceChildren(e,t){let r=e;return this._forEachChild((o,i)=>{r=t(r,o,i)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var Mu=new R("",{providedIn:"root",factory:()=>xu}),xu="always";function WC(n,e){return[...e.path,n]}function Cm(n,e,t=xu){bm(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),zC(n,e),ZC(n,e),QC(n,e),GC(n,e)}function im(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function GC(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function bm(n,e){let t=VC(n);e.validator!==null?n.setValidators(nm(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=jC(n);e.asyncValidator!==null?n.setAsyncValidators(nm(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let o=()=>n.updateValueAndValidity();im(e._rawValidators,o),im(e._rawAsyncValidators,o)}function zC(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&_m(n,e)})}function QC(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&_m(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function _m(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function ZC(n,e){let t=(r,o)=>{e.valueAccessor.writeValue(r),o&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function YC(n,e){n==null,bm(n,e)}function KC(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function JC(n){return Object.getPrototypeOf(n.constructor)===Ys}function XC(n,e){n._syncPendingControls(),e.forEach(t=>{let r=t.control;r.updateOn==="submit"&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function eb(n,e){if(!e)return null;Array.isArray(e);let t,r,o;return e.forEach(i=>{i.constructor===br?t=i:JC(i)?r=i:o=i}),o||r||t||null}var tb={provide:Cr,useExisting:it(()=>Nu)},Ro=Promise.resolve(),Nu=(()=>{class n extends Cr{callSetDisabledState;get submitted(){return Dt(this.submittedReactive)}_submitted=hr(()=>this.submittedReactive());submittedReactive=In(!1);_directives=new Set;form;ngSubmit=new pe;options;constructor(t,r,o){super(),this.callSetDisabledState=o,this.form=new Zs({},Su(t),Tu(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){Ro.then(()=>{let r=this._findContainer(t.path);t.control=r.registerControl(t.name,t.control),Cm(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){Ro.then(()=>{let r=this._findContainer(t.path);r&&r.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){Ro.then(()=>{let r=this._findContainer(t.path),o=new Zs({});YC(o,t),r.registerControl(t.name,o),o.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){Ro.then(()=>{let r=this._findContainer(t.path);r&&r.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,r){Ro.then(()=>{this.form.get(t.path).setValue(r)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submittedReactive.set(!0),XC(this.form,this._directives),this.ngSubmit.emit(t),this.form._events.next(new wu(this.control)),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submittedReactive.set(!1)}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}static \u0275fac=function(r){return new(r||n)(_(dm,10),_(fm,10),_(Mu,8))};static \u0275dir=ce({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(r,o){r&1&&W("submit",function(s){return o.onSubmit(s)})("reset",function(){return o.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Yt([tb]),Ze]})}return n})();function sm(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function am(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var nb=class extends Qs{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,r){super(Em(t),Dm(r,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Ks(t)&&(t.nonNullable||t.initialValueIsDefault)&&(am(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1,t?.emitEvent!==!1&&this._events.next(new zs(this))}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){sm(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){sm(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){am(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var rb={provide:Po,useExisting:it(()=>Ln)},lm=Promise.resolve(),Ln=(()=>{class n extends Po{_changeDetectorRef;callSetDisabledState;control=new nb;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new pe;constructor(t,r,o,i,s,a){super(),this._changeDetectorRef=s,this.callSetDisabledState=a,this._parent=t,this._setValidators(r),this._setAsyncValidators(o),this.valueAccessor=eb(this,i)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let r=t.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),KC(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){Cm(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){lm.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let r=t.isDisabled.currentValue,o=r!==0&&Nh(r);lm.then(()=>{o&&!this.control.disabled?this.control.disable():!o&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?WC(t,this._parent):[t]}static \u0275fac=function(r){return new(r||n)(_(Cr,9),_(dm,10),_(fm,10),_(Fo,10),_(xs,8),_(Mu,8))};static \u0275dir=ce({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[Yt([rb]),Ze,fs]})}return n})();var wm=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275dir=ce({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return n})();var ob={provide:Fo,useExisting:it(()=>Xt),multi:!0};function Im(n,e){return n==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function ib(n){return n.split(":")[0]}var Xt=(()=>{class n extends Ys{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;appRefInjector=M(An).injector;destroyRef=M($t);cdr=M(xs);_queuedWrite=!1;_writeValueAfterRender(){this._queuedWrite||this.appRefInjector.destroyed||(this._queuedWrite=!0,kc({write:()=>{this.destroyRef.destroyed||(this._queuedWrite=!1,this.writeValue(this.value))}},{injector:this.appRefInjector}))}writeValue(t){this.cdr.markForCheck(),this.value=t;let r=this._getOptionId(t),o=Im(r,t);this.setProperty("value",o)}registerOnChange(t){this.onChange=r=>{this.value=this._getOptionValue(r),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r),t))return r;return null}_getOptionValue(t){let r=ib(t);return this._optionMap.has(r)?this._optionMap.get(r):t}static \u0275fac=(()=>{let t;return function(o){return(t||(t=dr(n)))(o||n)}})();static \u0275dir=ce({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(r,o){r&1&&W("change",function(s){return o.onChange(s.target.value)})("blur",function(){return o.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Yt([ob]),Ze]})}return n})(),wr=(()=>{class n{_element;_renderer;_select;id;constructor(t,r,o){this._element=t,this._renderer=r,this._select=o,this._select&&(this.id=this._select._registerOption())}set ngValue(t){this._select!=null&&(this._select._optionMap.set(this.id,t),this._setElementValue(Im(this.id,t)),this._select._writeValueAfterRender())}set value(t){this._setElementValue(t),this._select&&this._select._writeValueAfterRender()}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select._writeValueAfterRender())}static \u0275fac=function(r){return new(r||n)(_(At),_(Gt),_(Xt,9))};static \u0275dir=ce({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})(),sb={provide:Fo,useExisting:it(()=>Sm),multi:!0};function cm(n,e){return n==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function ab(n){return n.split(":")[0]}var Sm=(()=>{class n extends Ys{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;writeValue(t){this.value=t;let r;if(Array.isArray(t)){let o=t.map(i=>this._getOptionId(i));r=(i,s)=>{i._setSelected(o.indexOf(s.toString())>-1)}}else r=(o,i)=>{o._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(t){this.onChange=r=>{let o=[],i=r.selectedOptions;if(i!==void 0){let s=i;for(let a=0;a<s.length;a++){let l=s[a],c=this._getOptionValue(l.value);o.push(c)}}else{let s=r.options;for(let a=0;a<s.length;a++){let l=s[a];if(l.selected){let c=this._getOptionValue(l.value);o.push(c)}}}this.value=o,t(o)}}_registerOption(t){let r=(this._idCounter++).toString();return this._optionMap.set(r,t),r}_getOptionId(t){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r)._value,t))return r;return null}_getOptionValue(t){let r=ab(t);return this._optionMap.has(r)?this._optionMap.get(r)._value:t}static \u0275fac=(()=>{let t;return function(o){return(t||(t=dr(n)))(o||n)}})();static \u0275dir=ce({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(r,o){r&1&&W("change",function(s){return o.onChange(s.target)})("blur",function(){return o.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Yt([sb]),Ze]})}return n})(),Ir=(()=>{class n{_element;_renderer;_select;id;_value;constructor(t,r,o){this._element=t,this._renderer=r,this._select=o,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){this._select!=null&&(this._value=t,this._setElementValue(cm(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(cm(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(r){return new(r||n)(_(At),_(Gt),_(Sm,9))};static \u0275dir=ce({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})();var lb=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=zt({type:n});static \u0275inj=Tt({})}return n})();var en=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:Mu,useValue:t.callSetDisabledState??xu}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=zt({type:n});static \u0275inj=Tt({imports:[lb]})}return n})();function Tm(n,e=10){return n?n.length>e?n.slice(0,e)+"\u2026":n:null}function cb(n,e){n&1&&te(0,"span",2)}var Sr=class n{label="";variant="primary";size="md";disabled=!1;iconName=null;clicked=new pe;get buttonClass(){return["btn",this.mapVariantToClass(this.variant),this.mapSizeToClass(this.size)].filter(Boolean).join(" ")}mapVariantToClass(e){switch(e){case"primary":return"btn-primary";case"secondary":return"btn-secondary";case"ghost":return"btn-ghost";default:return""}}mapSizeToClass(e){switch(e){case"sm":return"btn-sm";case"md":return"btn-md";case"lg":return"btn-lg";default:return""}}handleClick(){this.disabled||this.clicked.emit()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Q({type:n,selectors:[["app-button"]],inputs:{label:"label",variant:"variant",size:"size",disabled:"disabled",iconName:"iconName"},outputs:{clicked:"clicked"},decls:4,vars:4,consts:[["type","button",3,"click","ngClass","disabled"],["class","btn-icon","aria-hidden","true",4,"ngIf"],["aria-hidden","true",1,"btn-icon"]],template:function(t,r){t&1&&(h(0,"button",0),W("click",function(){return r.handleClick()}),A(1,cb,1,0,"span",1),h(2,"span"),y(3),g()()),t&2&&(D("ngClass",r.buttonClass)("disabled",r.disabled),m(),D("ngIf",r.iconName),m(2),Z(r.label))},dependencies:[G,Do,ee],encapsulation:2})};var ub=["*"];function db(n,e){if(n&1&&(h(0,"p",5),y(1),g()),n&2){let t=w(2);m(),Z(t.subtitle)}}function fb(n,e){if(n&1&&(h(0,"header",3)(1,"h3"),y(2),g(),A(3,db,2,1,"p",4),g()),n&2){let t=w();m(2),Z(t.title),m(),D("ngIf",t.subtitle)}}var Js=class n{title="";subtitle="";variant="default";static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Q({type:n,selectors:[["app-card"]],inputs:{title:"title",subtitle:"subtitle",variant:"variant"},ngContentSelectors:ub,decls:4,vars:3,consts:[[1,"card"],["class","card-header",4,"ngIf"],[1,"card-body"],[1,"card-header"],["class","card-subtitle",4,"ngIf"],[1,"card-subtitle"]],template:function(t,r){t&1&&(mo(),h(0,"article",0),A(1,fb,4,2,"header",1),h(2,"div",2),go(3),g()()),t&2&&(Ue("card-emphasis",r.variant==="emphasis"),m(),D("ngIf",r.title))},dependencies:[G,ee],encapsulation:2})};function pb(n,e){if(n&1&&(h(0,"span",5),y(1),g()),n&2){let t=w();D("id",t.labelId),m(),Z(t.label)}}function hb(n,e){if(n&1&&(h(0,"option",6),y(1),g()),n&2){let t=w();m(),Z(t.placeholder)}}function mb(n,e){if(n&1&&(h(0,"option",7),y(1),g()),n&2){let t=e.$implicit;D("value",t.value),m(),Z(t.label)}}var Xs=class n{static nextId=0;labelId=`dropdown-label-${n.nextId++}`;items=[];value=null;placeholder="";label="";required=!1;disabled=!1;valueChange=new pe;onChange(e){this.value=e,this.valueChange.emit(e)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Q({type:n,selectors:[["app-dropdown"]],inputs:{items:"items",value:"value",placeholder:"placeholder",label:"label",required:"required",disabled:"disabled"},outputs:{valueChange:"valueChange"},decls:5,vars:9,consts:[[1,"dropdown"],["class","dropdown-label",3,"id",4,"ngIf"],[3,"ngModelChange","ngModel","disabled"],["value","","disabled","","selected","",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],[1,"dropdown-label",3,"id"],["value","","disabled","","selected",""],[3,"value"]],template:function(t,r){t&1&&(h(0,"label",0),A(1,pb,2,2,"span",1),h(2,"select",2),W("ngModelChange",function(i){return r.onChange(i)}),A(3,hb,2,1,"option",3)(4,mb,2,2,"option",4),g()()),t&2&&(m(),D("ngIf",r.label),m(),D("ngModel",r.value)("disabled",r.disabled),yt("aria-labelledby",r.label?r.labelId:null)("aria-label",!r.label&&r.placeholder?r.placeholder:null)("aria-required",r.required)("aria-disabled",r.disabled),m(),D("ngIf",r.placeholder),m(),D("ngForOf",r.items))},dependencies:[G,Ct,ee,en,wr,Ir,Xt,_r,Ln],encapsulation:2})};function gb(n,e){if(n&1&&(vt(0),y(1),Et()),n&2){let t=w(2);m(),Y(" (current: ",t.currentItemId,")")}}function yb(n,e){if(n&1&&(h(0,"div",1)(1,"div",2),y(2),A(3,gb,2,1,"ng-container",3),g(),h(4,"div",4),te(5,"div",5),g()()),n&2){let t=w();m(2),Zt(" ",t.completed," / ",t.total," "),m(),D("ngIf",t.currentItemId),m(2),Is("width",t.percent,"%")}}var ea=class n{total=0;completed=0;currentItemId=null;get percent(){if(!this.total)return 0;let e=this.completed/this.total*100;return e>100?100:e}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Q({type:n,selectors:[["app-progress-indicator"]],inputs:{total:"total",completed:"completed",currentItemId:"currentItemId"},decls:1,vars:1,consts:[["class","app-progress-indicator",4,"ngIf"],[1,"app-progress-indicator"],[1,"app-progress-indicator__label"],[4,"ngIf"],[1,"app-progress-indicator__bar"],[1,"app-progress-indicator__bar-fill"]],template:function(t,r){t&1&&A(0,yb,6,5,"div",0),t&2&&D("ngIf",r.total>0)},dependencies:[G,ee],styles:[".app-progress-indicator[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;font-size:12px}.app-progress-indicator__label[_ngcontent-%COMP%]{color:#374151}.app-progress-indicator__bar[_ngcontent-%COMP%]{position:relative;width:100%;height:4px;border-radius:9999px;background-color:#e5e7eb;overflow:hidden}.app-progress-indicator__bar-fill[_ngcontent-%COMP%]{height:100%;background-color:#3b82f6;transition:width .12s ease-out}"],changeDetection:0})};var vb=["*"];function Eb(n,e){if(n&1&&(h(0,"p",4),y(1),g()),n&2){let t=w(2);m(),Z(t.subtitle)}}function Db(n,e){if(n&1&&(h(0,"header",2)(1,"h2"),y(2),g(),A(3,Eb,2,1,"p",3),g()),n&2){let t=w();m(2),Z(t.title),m(),D("ngIf",t.subtitle)}}var Ke=class n{title="";subtitle="";variant="default";get sectionClass(){return this.variant==="dense"?"section section-dense":"section"}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Q({type:n,selectors:[["app-section"]],inputs:{title:"title",subtitle:"subtitle",variant:"variant"},ngContentSelectors:vb,decls:4,vars:3,consts:[["class","section-header",4,"ngIf"],[1,"section-body"],[1,"section-header"],["class","section-subtitle",4,"ngIf"],[1,"section-subtitle"]],template:function(t,r){t&1&&(mo(),h(0,"section"),A(1,Db,4,2,"header",0),h(2,"div",1),go(3),g()()),t&2&&(Rn(r.sectionClass),m(),D("ngIf",r.title))},dependencies:[G,ee],encapsulation:2})};function Cb(n,e){if(n&1&&(h(0,"th",6),y(1),g()),n&2){let t=e.$implicit;m(),Z(t.header)}}function bb(n,e){if(n&1&&(h(0,"td",8),y(1),g()),n&2){let t=e.$implicit,r=w().$implicit;m(),Z(r[t.field])}}function _b(n,e){if(n&1&&(h(0,"tr",3),A(1,bb,2,1,"td",7),g()),n&2){let t=e.index,r=w(2);yt("aria-rowindex",t+2),m(),D("ngForOf",r.columns)}}function wb(n,e){if(n&1&&(h(0,"table",2)(1,"thead")(2,"tr",3),A(3,Cb,2,1,"th",4),g()(),h(4,"tbody"),A(5,_b,2,2,"tr",5),g()()),n&2){let t=w();yt("aria-label",t.ariaLabel),m(3),D("ngForOf",t.columns),m(2),D("ngForOf",t.rows)}}function Ib(n,e){if(n&1&&(h(0,"p",9),y(1),g()),n&2){let t=w();m(),Z(t.emptyMessage)}}var tn=class n{columns=[];rows=[];emptyMessage="";ariaLabel="Data table";static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Q({type:n,selectors:[["app-table"]],inputs:{columns:"columns",rows:"rows",emptyMessage:"emptyMessage",ariaLabel:"ariaLabel"},decls:3,vars:2,consts:[["empty",""],["role","grid",4,"ngIf","ngIfElse"],["role","grid"],["role","row"],["scope","col","role","columnheader",4,"ngFor","ngForOf"],["role","row",4,"ngFor","ngForOf"],["scope","col","role","columnheader"],["role","gridcell",4,"ngFor","ngForOf"],["role","gridcell"],["role","status"]],template:function(t,r){if(t&1&&A(0,wb,6,3,"table",1)(1,Ib,2,1,"ng-template",null,0,Fe),t&2){let o=Se(2);D("ngIf",r.rows==null?null:r.rows.length)("ngIfElse",o)}},dependencies:[G,Ct,ee],encapsulation:2})};function Sb(n,e){if(n&1&&(h(0,"div",19),y(1),g()),n&2){let t=w(2);m(),Y(" ",t.signInError," ")}}function Tb(n,e){if(n&1){let t=Pe();h(0,"div")(1,"app-card",3)(2,"form",4),W("ngSubmit",function(){j(t);let o=w();return B(o.signInWithJwt())}),h(3,"div",5)(4,"label",6),y(5,"Email"),g(),h(6,"input",7),re("ngModelChange",function(o){j(t);let i=w();return ie(i.email,o)||(i.email=o),B(o)}),g()(),h(7,"div",5)(8,"label",8),y(9,"Password"),g(),h(10,"input",9),re("ngModelChange",function(o){j(t);let i=w();return ie(i.password,o)||(i.password=o),B(o)}),g()(),h(11,"div",5)(12,"label",10),y(13,"Role"),g(),h(14,"select",11),re("ngModelChange",function(o){j(t);let i=w();return ie(i.selectedRole,o)||(i.selectedRole=o),B(o)}),h(15,"option",12),y(16,"Analyst"),g(),h(17,"option",13),y(18,"Admin"),g()()(),A(19,Sb,2,1,"div",14),h(20,"div",15)(21,"button",16),y(22),g()()(),h(23,"div",17)(24,"span"),y(25,"or"),g(),h(26,"button",18),W("click",function(){j(t);let o=w();return B(o.signIn())}),y(27," Mock SSO Sign-In "),g()()()()}if(n&2){let t=w();m(6),ne("ngModel",t.email),D("disabled",t.isLoading),m(4),ne("ngModel",t.password),D("disabled",t.isLoading),m(4),ne("ngModel",t.selectedRole),D("disabled",t.isLoading),m(5),D("ngIf",t.signInError),m(2),D("disabled",t.isLoading),m(),Y(" ",t.isLoading?"Signing in...":"Sign In"," ")}}function Mb(n,e){n&1&&(h(0,"span",23),y(1," (auto-refresh scheduled) "),g())}function xb(n,e){if(n&1&&(h(0,"p")(1,"strong"),y(2,"Token expires in:"),g(),h(3,"span"),y(4),g(),A(5,Mb,2,0,"span",22),g()),n&2){let t=w(2);m(3),Ue("expiring-soon",t.isTokenExpiringSoon),m(),Y(" ",t.tokenExpiryDisplay," "),m(),D("ngIf",t.isTokenExpiringSoon)}}function Nb(n,e){if(n&1){let t=Pe();h(0,"app-card",20)(1,"p")(2,"strong"),y(3,"User:"),g(),y(4),g(),h(5,"p")(6,"strong"),y(7,"Email:"),g(),y(8),g(),h(9,"p")(10,"strong"),y(11,"Token:"),g(),y(12),g(),h(13,"p")(14,"strong"),y(15,"Role:"),g(),y(16),g(),A(17,xb,6,4,"p",21),h(18,"div",15)(19,"button",18),W("click",function(){j(t);let o=w();return B(o.signOut())}),y(20," Sign Out "),g()()()}if(n&2){let t=w();m(4),Y(" ",t.userName),m(4),Y(" ",t.userEmail),m(4),Y(" ",t.tokenSnippet),m(4),Y(" ",t.roleSummary),m(),D("ngIf",t.tokenExpiryDisplay)}}var ta=class n{constructor(e){this.auth=e}email="";password="";selectedRole="analyst";signInError="";isLoading=!1;signInWithJwt(){return v(this,null,function*(){if(!this.email){this.signInError="Email is required";return}this.isLoading=!0,this.signInError="";try{yield this.auth.signInWithJwt(this.email,this.password,[this.selectedRole]),this.email="",this.password=""}catch(e){this.signInError=e instanceof Error?e.message:"Sign-in failed"}finally{this.isLoading=!1}})}signIn(){return v(this,null,function*(){yield this.auth.signIn()})}signOut(){this.auth.signOut()}get isSignedIn(){return this.auth.isAuthenticated}get userName(){return this.auth.user?.displayName??null}get userEmail(){return this.auth.user?.email??null}get tokenSnippet(){return Tm(this.auth.state.accessToken)}get roleSummary(){let e=this.auth.roles??[];return e.length?e.includes("admin")?"Admin role active: full query and settings access.":e.includes("analyst")?"Analyst role active: can run queries and view results.":`Roles: ${e.join(", ")}`:"No roles assigned (mock user)."}get isTokenExpiringSoon(){return this.auth.isAccessTokenExpiringSoon()}get tokenExpiryDisplay(){let e=this.auth.getAccessToken();if(!e)return null;try{let t=e.split(".");if(t.length!==3)return null;let r=JSON.parse(atob(t[1])),o=new Date(r.exp*1e3),i=new Date,s=o.getTime()-i.getTime();if(s<=0)return"Expired";let a=Math.floor(s/6e4),l=Math.floor(s%6e4/1e3);return a>0?`${a}m ${l}s`:`${l}s`}catch{return null}}static \u0275fac=function(t){return new(t||n)(_(he))};static \u0275cmp=Q({type:n,selectors:[["app-sso-home"]],decls:4,vars:2,consts:[["signedIn",""],["title","Authentication","subtitle","Sign in with JWT authentication (mock implementation for development).",1,"sso-home"],[4,"ngIf","ngIfElse"],["title","Sign In with JWT","variant","default"],[1,"sign-in-form",3,"ngSubmit"],[1,"form-group"],["for","email"],["type","email","id","email","name","email","placeholder","user@example.com",3,"ngModelChange","ngModel","disabled"],["for","password"],["type","password","id","password","name","password","placeholder","(any value - mock)",3,"ngModelChange","ngModel","disabled"],["for","role"],["id","role","name","role",3,"ngModelChange","ngModel","disabled"],["value","analyst"],["value","admin"],["class","error-message",4,"ngIf"],[1,"form-actions"],["type","submit",1,"btn-primary",3,"disabled"],[1,"alt-sign-in"],["type","button",1,"btn-secondary",3,"click"],[1,"error-message"],["title","Signed-in User","variant","emphasis"],[4,"ngIf"],["class","refresh-hint",4,"ngIf"],[1,"refresh-hint"]],template:function(t,r){if(t&1&&(h(0,"app-section",1),A(1,Tb,28,9,"div",2)(2,Nb,21,5,"ng-template",null,0,Fe),g()),t&2){let o=Se(3);m(),D("ngIf",!r.isSignedIn)("ngIfElse",o)}},dependencies:[G,ee,en,wm,wr,Ir,br,Xt,_r,vm,Ln,Nu,Ke,Js],styles:[".sso-home[_ngcontent-%COMP%]{padding:1rem}.sso-home[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-bottom:.5rem}.sso-home[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.25rem 0}.sign-in-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:var(--text-secondary, #666)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:.5rem;border:1px solid var(--border-color, #ccc);border-radius:4px;font-size:.875rem}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-color, #0078d4);box-shadow:0 0 0 2px #0078d433}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:disabled, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:disabled{background-color:var(--disabled-bg, #f5f5f5);cursor:not-allowed}.form-actions[_ngcontent-%COMP%]{margin-top:.5rem}.btn-primary[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%]{padding:.5rem 1rem;border:none;border-radius:4px;font-size:.875rem;cursor:pointer;transition:background-color .2s}.btn-primary[_ngcontent-%COMP%]{background-color:var(--primary-color, #0078d4);color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:var(--primary-hover, #106ebe)}.btn-primary[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.btn-secondary[_ngcontent-%COMP%]{background-color:var(--secondary-bg, #f0f0f0);color:var(--text-primary, #333);border:1px solid var(--border-color, #ccc)}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:var(--secondary-hover, #e0e0e0)}.error-message[_ngcontent-%COMP%]{color:var(--error-color, #d32f2f);font-size:.875rem;padding:.5rem;background-color:#d32f2f1a;border-radius:4px}.alt-sign-in[_ngcontent-%COMP%]{margin-top:1rem;padding-top:1rem;border-top:1px solid var(--border-color, #ccc);text-align:center}.alt-sign-in[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;color:var(--text-secondary, #666);font-size:.875rem}.expiring-soon[_ngcontent-%COMP%]{color:var(--warning-color, #ed6c02);font-weight:500}.refresh-hint[_ngcontent-%COMP%]{font-size:.75rem;color:var(--text-secondary, #666);font-style:italic}"]})};var Ve={ACCESS_TOKEN_LIFETIME_MS:9e5,REFRESH_TOKEN_LIFETIME_MS:6048e5,REFRESH_THRESHOLD_MS:3e5,TOKEN_CHECK_INTERVAL_MS:6e4,STORAGE_KEY:"jwt_tokens"};var na=class n{generateMockTokenPair(e,t){let r=Date.now(),o=this.generateUserId(e),i={sub:o,email:e,roles:t,iat:Math.floor(r/1e3),exp:Math.floor((r+Ve.ACCESS_TOKEN_LIFETIME_MS)/1e3)},s={sub:o,email:e,roles:t,iat:Math.floor(r/1e3),exp:Math.floor((r+Ve.REFRESH_TOKEN_LIFETIME_MS)/1e3)},a=this.encodeToken(i),l=this.encodeToken(s);return{access:{token:a,expiresAt:r+Ve.ACCESS_TOKEN_LIFETIME_MS},refresh:{token:l,expiresAt:r+Ve.REFRESH_TOKEN_LIFETIME_MS}}}refreshMockTokenPair(e){let t=this.validateToken(e.token);if(!t.valid||!t.payload)return null;let r=Date.now(),o=t.payload;if(this.isTokenExpired(e))return null;let i={sub:o.sub,email:o.email,roles:o.roles,iat:Math.floor(r/1e3),exp:Math.floor((r+Ve.ACCESS_TOKEN_LIFETIME_MS)/1e3)},s=this.encodeToken(i),a=1440*60*1e3;return e.expiresAt-r<a?this.generateMockTokenPair(o.email,o.roles):{access:{token:s,expiresAt:r+Ve.ACCESS_TOKEN_LIFETIME_MS},refresh:e}}decodeMockToken(e){try{let t=e.split(".");if(t.length!==3)return null;let r=this.base64UrlDecode(t[1]);return JSON.parse(r)}catch{return null}}validateToken(e){let t=this.decodeMockToken(e);if(!t)return{valid:!1,payload:null,error:"Invalid token format"};let r=Math.floor(Date.now()/1e3);return t.exp<r?{valid:!1,payload:t,error:"Token expired"}:{valid:!0,payload:t}}isTokenExpired(e){return Date.now()>=e.expiresAt}isTokenExpiringSoon(e,t=Ve.REFRESH_THRESHOLD_MS){return Date.now()+t>=e.expiresAt}getTimeUntilExpiry(e){return e.expiresAt-Date.now()}generateUserId(e){let t=0;for(let r=0;r<e.length;r++){let o=e.charCodeAt(r);t=(t<<5)-t+o,t=t&t}return`user-${Math.abs(t).toString(16)}`}encodeToken(e){let t={alg:"HS256",typ:"JWT"},r=this.base64UrlEncode(JSON.stringify(t)),o=this.base64UrlEncode(JSON.stringify(e)),i=this.generateMockSignature(r,o);return`${r}.${o}.${i}`}generateMockSignature(e,t){let r=`${e}.${t}`,o=0;for(let i=0;i<r.length;i++){let s=r.charCodeAt(i);o=(o<<5)-o+s,o=o&o}return this.base64UrlEncode(Math.abs(o).toString(16).padStart(32,"0"))}base64UrlEncode(e){return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}base64UrlDecode(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),r=t.length%4;return r&&(t+="=".repeat(4-r)),atob(t)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=I({token:n,factory:n.\u0275fac,providedIn:"root"})};function Mm(){return v(this,null,function*(){return{user:{id:"mock-user-id-123",displayName:"Mock User",email:"mock.user@example.com",roles:[]},accessToken:"mock-access-token-abc123"}})}function ra(){return v(this,null,function*(){let n=yield Mm();return{user:{id:n.user.id,displayName:n.user.displayName,email:n.user.email,roles:n.user.roles},accessToken:n.accessToken}})}var Tr=class n{getItem(e,t){if(typeof window>"u")return t;let r=localStorage.getItem(e);if(!r)return t;try{return JSON.parse(r)}catch{return t}}setItem(e,t){if(!(typeof window>"u"))try{localStorage.setItem(e,JSON.stringify(t))}catch{}}removeItem(e){typeof window>"u"||localStorage.removeItem(e)}clear(){typeof window>"u"||localStorage.clear()}static \u0275fac=function(t){return new(t||n)};static \u0275prov=I({token:n,factory:n.\u0275fac,providedIn:"root"})};var nn=class n{db=null;DB_NAME="ExcelExtensionDB";DB_VERSION=1;STORE_NAME="queryResults";init(){return v(this,null,function*(){if(!this.db)return new Promise((e,t)=>{let r=indexedDB.open(this.DB_NAME,this.DB_VERSION);r.onerror=()=>t(r.error),r.onsuccess=()=>{this.db=r.result,e()},r.onupgradeneeded=o=>{let i=o.target.result;if(!i.objectStoreNames.contains(this.STORE_NAME)){let s=i.createObjectStore(this.STORE_NAME,{keyPath:"id"});s.createIndex("queryId","queryId",{unique:!1}),s.createIndex("timestamp","timestamp",{unique:!1})}}})})}cacheQueryResult(e,t,r=36e5){return v(this,null,function*(){this.db||(yield this.init());let o={id:`${e}-${Date.now()}`,queryId:e,rows:t,timestamp:Date.now(),expiresAt:Date.now()+r};return new Promise((i,s)=>{let c=this.db.transaction([this.STORE_NAME],"readwrite").objectStore(this.STORE_NAME).put(o);c.onsuccess=()=>i(),c.onerror=()=>s(c.error)})})}getCachedQueryResult(e){return v(this,null,function*(){return this.db||(yield this.init()),new Promise((t,r)=>{let a=this.db.transaction([this.STORE_NAME],"readonly").objectStore(this.STORE_NAME).index("queryId").getAll(e);a.onsuccess=()=>{let l=a.result;if(!l.length){t(null);return}let c=l.filter(u=>u.expiresAt>Date.now()).sort((u,d)=>d.timestamp-u.timestamp);t(c.length>0?c[0].rows:null)},a.onerror=()=>r(a.error)})})}clearExpiredCache(){return v(this,null,function*(){return this.db||(yield this.init()),new Promise((e,t)=>{let s=this.db.transaction([this.STORE_NAME],"readwrite").objectStore(this.STORE_NAME).index("timestamp").openCursor();s.onsuccess=a=>{let l=a.target.result;l?(l.value.expiresAt<Date.now()&&l.delete(),l.continue()):e()},s.onerror=()=>t(s.error)})})}clearAllCache(){return v(this,null,function*(){return this.db||(yield this.init()),new Promise((e,t)=>{let i=this.db.transaction([this.STORE_NAME],"readwrite").objectStore(this.STORE_NAME).clear();i.onsuccess=()=>e(),i.onerror=()=>t(i.error)})})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=I({token:n,factory:n.\u0275fac,providedIn:"root"})};var _t=class n{constructor(e,t){this.base=e;this.indexedDB=t}getItem(e,t){return this.base.getItem(e,t)}setItem(e,t){this.base.setItem(e,t)}getLargeItem(e){return v(this,null,function*(){try{return yield this.indexedDB.getCachedQueryResult(e)}catch(t){return console.error("[storage] IndexedDB read error:",e,t),null}})}setLargeItem(e,t,r){return v(this,null,function*(){try{yield this.indexedDB.cacheQueryResult(e,t,r)}catch(o){console.error("[storage] IndexedDB write error:",e,o)}})}removeItem(e){this.base.removeItem(e)}clear(){this.base.clear()}clearExpiredCache(){return v(this,null,function*(){try{yield this.indexedDB.clearExpiredCache()}catch(e){console.error("[storage] Cache cleanup error:",e)}})}clearAllCache(){return v(this,null,function*(){try{yield this.indexedDB.clearAllCache()}catch(e){console.error("[storage] Cache clear-all error:",e)}})}static \u0275fac=function(t){return new(t||n)(C(Tr),C(nn))};static \u0275prov=I({token:n,factory:n.\u0275fac,providedIn:"root"})};var he=class n{constructor(e,t){this.storage=e;this.jwtHelper=t;let r={isAuthenticated:!1,user:null,accessToken:null},o=this.storage.getItem(n.STORAGE_KEY,r);this.stateSubject.next(o);let i=this.storage.getItem(Ve.STORAGE_KEY,null);i&&!this.jwtHelper.isTokenExpired(i.refresh)?(this.tokensSubject.next(i),this.startTokenRefreshTimer()):i&&this.storage.removeItem(Ve.STORAGE_KEY),this.stateSubscription=this.state$.subscribe(s=>{this.storage.setItem(n.STORAGE_KEY,s)}),this.tokensSubscription=this.tokens$.subscribe(s=>{s?this.storage.setItem(Ve.STORAGE_KEY,s):this.storage.removeItem(Ve.STORAGE_KEY)})}static STORAGE_KEY="excel-extension-auth-state";stateSubject=new _e({isAuthenticated:!1,user:null,accessToken:null});tokensSubject=new _e(null);tokenRefreshTimer;stateSubscription;tokensSubscription;refreshInProgress=!1;state$=this.stateSubject.asObservable();tokens$=this.tokensSubject.asObservable();get state(){return this.stateSubject.value}get tokens(){return this.tokensSubject.value}get isAuthenticated(){return this.state.isAuthenticated}get user(){return this.state.user}get roles(){return this.state.user?.roles??[]}hasRole(e){return this.roles.includes(e)}hasAnyRole(e){return e.some(t=>this.roles.includes(t))}ngOnDestroy(){this.stopTokenRefreshTimer(),this.stateSubscription?.unsubscribe(),this.tokensSubscription?.unsubscribe()}signInWithJwt(o,i){return v(this,arguments,function*(e,t,r=["analyst"]){let s=this.jwtHelper.generateMockTokenPair(e,r),a=this.jwtHelper.decodeMockToken(s.access.token);if(!a)throw new Error("Failed to decode generated token");let l={id:a.sub,displayName:e.split("@")[0],email:a.email,roles:a.roles};this.tokensSubject.next(s),this.stateSubject.next({isAuthenticated:!0,user:l,accessToken:s.access.token}),this.startTokenRefreshTimer()})}refreshAccessToken(){return v(this,null,function*(){if(this.refreshInProgress)return!1;let e=this.tokensSubject.value;if(!e)return!1;if(this.jwtHelper.isTokenExpired(e.refresh))return this.signOut(),!1;this.refreshInProgress=!0;try{let t=this.jwtHelper.refreshMockTokenPair(e.refresh);return t?(this.tokensSubject.next(t),this.stateSubject.next(k(E({},this.state),{accessToken:t.access.token})),!0):(this.signOut(),!1)}finally{this.refreshInProgress=!1}})}getAccessToken(){let e=this.tokensSubject.value;return!e||this.jwtHelper.isTokenExpired(e.access)?null:e.access.token}isAccessTokenExpiringSoon(){let e=this.tokensSubject.value;return e?this.jwtHelper.isTokenExpiringSoon(e.access):!1}startTokenRefreshTimer(){this.stopTokenRefreshTimer(),this.tokenRefreshTimer=Va(Ve.TOKEN_CHECK_INTERVAL_MS).subscribe(()=>{this.checkAndRefreshTokens()})}checkAndRefreshTokens(){return v(this,null,function*(){try{let e=this.tokensSubject.value;if(!e){this.stopTokenRefreshTimer();return}this.jwtHelper.isTokenExpiringSoon(e.access)&&(yield this.refreshAccessToken());let t=this.tokensSubject.value;t&&this.jwtHelper.isTokenExpired(t.refresh)&&this.signOut()}catch{this.signOut()}})}stopTokenRefreshTimer(){this.tokenRefreshTimer&&(this.tokenRefreshTimer.unsubscribe(),this.tokenRefreshTimer=void 0)}signInAsAnalyst(){return v(this,null,function*(){let e=yield ra(),t=k(E({},e.user),{roles:["analyst"]});this.stateSubject.next({isAuthenticated:!0,user:t,accessToken:e.accessToken})})}signInAsAdmin(){return v(this,null,function*(){let e=yield ra(),t=k(E({},e.user),{roles:["admin"]});this.stateSubject.next({isAuthenticated:!0,user:t,accessToken:e.accessToken})})}signIn(){return v(this,null,function*(){let e=yield ra();this.stateSubject.next({isAuthenticated:!0,user:e.user,accessToken:e.accessToken})})}signOut(){this.stopTokenRefreshTimer(),this.tokensSubject.next(null),this.stateSubject.next({isAuthenticated:!1,user:null,accessToken:null})}static \u0275fac=function(t){return new(t||n)(C(_t),C(na))};static \u0275prov=I({token:n,factory:n.\u0275fac,providedIn:"root"})};var rn=class n{constructor(e){this.auth=e;this.hostStatus={isExcel:typeof window<"u"&&!!window.Office,isOnline:typeof navigator<"u"?navigator.onLine:!0}}hostStatus;getAuthSummary(){let e=this.auth.user;return{isAuthenticated:this.auth.isAuthenticated,displayName:e?e.displayName:null,roles:this.auth.roles}}static \u0275fac=function(t){return new(t||n)(C(he))};static \u0275prov=I({token:n,factory:n.\u0275fac,providedIn:"root"})};var Am="excel-extension.settings",Lo={telemetry:{enableWorkbookLogging:!1,enableConsoleLogging:!0,sessionStrategy:"per-load",logWorksheetName:"_Extension_Log",logTableName:"_Extension_Log_Table",logColumns:{timestamp:"timestamp",level:"level",operation:"operation",message:"message",sessionId:"sessionId",correlationId:"correlationId"}},queryExecution:{maxRowsPerQuery:1e4,chunkSize:1e3,enableProgressiveLoading:!0,apiPageSize:1e3,chunkBackoffMs:100,disableFormulasDuringRun:!0}},Je=class n{constructor(e){this.storage=e;this.settings=this.load()}settings;get value(){return this.settings}update(e){this.settings=k(E(E({},this.settings),e),{telemetry:E(E({},this.settings.telemetry),e.telemetry??{}),queryExecution:E(E({},this.settings.queryExecution??Lo.queryExecution),e.queryExecution??{})}),this.save()}load(){let e=this.storage.getItem(Am,Lo);return k(E(E({},Lo),e),{telemetry:E(E({},Lo.telemetry),e.telemetry??{}),queryExecution:E(E({},Lo.queryExecution),e.queryExecution??{})})}save(){this.storage.setItem(Am,this.settings)}static \u0275fac=function(t){return new(t||n)(C(Tr))};static \u0275prov=I({token:n,factory:n.\u0275fac,providedIn:"root"})};var ae=class n{constructor(e,t){this.settings=e;this.appContext=t;this.sessionId=`sess_${Date.now().toString(36)}_${Math.random().toString(36).slice(2,8)}`}sessionId;createWorkflowEvent(e){let o=e,{category:t="system"}=o,r=jo(o,["category"]);return E({category:t},r)}createFeatureEvent(e){let o=e,{category:t="ui"}=o,r=jo(o,["category"]);return E({category:t},r)}normalizeError(e,t,r){let o=(typeof t=="object"&&t&&"message"in t&&typeof t.message=="string"?t.message:void 0)??r,i={operation:e,message:o,raw:t};return this.logEvent({category:"excel",name:e,severity:"error",message:o,context:{raw:t}}),{ok:!1,error:i}}logEvent(e){let{telemetry:t}=this.settings.value,r=k(E({},e),{sessionId:e.sessionId??this.sessionId,context:E({hostStatus:this.appContext.hostStatus,authSummary:this.appContext.getAuthSummary()},e.context??{})});t.enableConsoleLogging&&this.logToConsole(r),this.logToWorkbookIfEnabled({level:this.mapSeverityToWorkbookLevel(r.severity),operation:r.name,message:r.message,sessionId:r.sessionId,correlationId:r.correlationId})}logToConsole(e){let t=e.context??{},r=`[${e.category}]`;switch(e.severity){case"error":console.error(r,e.name,e.message??"",t);break;case"warn":console.warn(r,e.name,e.message??"",t);break;case"info":console.info(r,e.name,e.message??"",t);break;case"debug":default:console.debug(r,e.name,e.message??"",t);break}}mapSeverityToWorkbookLevel(e){return e==="error"?"error":"info"}logToWorkbookIfEnabled(e){return v(this,null,function*(){let{telemetry:t}=this.settings.value;if(t.enableWorkbookLogging&&!(typeof Office>"u"||Office?.context?.host!==Office.HostType.Excel))try{yield Excel.run(r=>v(this,null,function*(){let o=r.workbook.worksheets,i=t.logWorksheetName??"_Extension_Log",s=t.logTableName??"_Extension_Log_Table",a=t.logColumns??{timestamp:"timestamp",level:"level",operation:"operation",message:"message",sessionId:"sessionId",correlationId:"correlationId"},l=o.getItemOrNullObject(i);if(l.load("name"),yield r.sync(),l.isNullObject){l=o.add(i);let d=l.getRange("A1:F1");d.values=[[a.timestamp,a.level,a.operation,a.message,a.sessionId??"sessionId",a.correlationId??"correlationId"]]}let c=r.workbook.tables.getItemOrNullObject(s);if(c.load("name"),yield r.sync(),c.isNullObject){let d=l.getRange("A1:F1");c=r.workbook.tables.add(d,!0),c.name=s}c.rows.add(null,[[new Date().toISOString(),e.level,e.operation,e.message??"",e.sessionId??"",e.correlationId??""]]),yield r.sync()}))}catch{}})}static \u0275fac=function(t){return new(t||n)(C(Je),C(rn))};static \u0275prov=I({token:n,factory:n.\u0275fac,providedIn:"root"})};var je=class n{constructor(e,t){this.telemetry=e;this.settings=t}officeReadyPromise=null;get isExcel(){return typeof Office<"u"&&Office?.context?.host===Office.HostType.Excel}ensureOfficeReady(){return v(this,null,function*(){if(this.isExcel)return this.officeReadyPromise||(this.officeReadyPromise=new Promise((e,t)=>{try{typeof Office<"u"&&typeof Office.onReady=="function"?Office.onReady(()=>e()):e()}catch(r){t(r)}})),this.officeReadyPromise})}getWorksheets(){return v(this,null,function*(){return this.isExcel?(yield this.ensureOfficeReady(),Excel.run(e=>v(this,null,function*(){let t=e.workbook.worksheets.load("items/name");return yield e.sync(),t.items.map(r=>r.name)}))):[]})}getTables(){return v(this,null,function*(){return this.isExcel?(yield this.ensureOfficeReady(),Excel.run(e=>v(this,null,function*(){let t=e.workbook.tables.load("items/name,items/worksheet,items/rows");yield e.sync();for(let r of t.items)r.worksheet.load("name"),r.rows.load("count");return yield e.sync(),t.items.map(r=>({name:r.name,worksheet:r.worksheet.name,rows:r.rows.count}))}))):[]})}getWorkbookTables(){return v(this,null,function*(){return(yield this.getTables()).map(t=>({name:t.name,worksheet:t.worksheet,rows:t.rows}))})}getWorkbookOwnership(){return v(this,null,function*(){return this.isExcel?(yield this.ensureOfficeReady(),Excel.run(e=>v(this,null,function*(){let r=e.workbook.worksheets.getItemOrNullObject("_Extension_Ownership");if(r.load("name"),yield e.sync(),r.isNullObject)return[];let o=r.getUsedRangeOrNullObject();if(yield e.sync(),o.isNullObject)return[];o.load("values"),yield e.sync();let i=o.values||[];if(!i.length)return[];let[,...s]=i;return s.filter(l=>l&&l.length>=4).map(l=>{let[c,u,d,p,f]=l;return{sheetName:c??"",tableName:u??"",queryId:d||void 0,isManaged:String(p).toLowerCase()==="true",lastTouchedUtc:f||void 0}}).filter(l=>l.sheetName&&l.tableName)}))):[]})}upsertQueryTable(e,t,r,o){return v(this,null,function*(){return this.isExcel?(yield this.ensureOfficeReady(),Excel.run(i=>v(this,null,function*(){let{header:s,values:a}=this.computeHeaderAndValues(r),l="overwrite",c=o?.sheetName??t.sheetName,u=o?.tableName??t.tableName;this.telemetry.logEvent({category:"excel",name:"upsertQueryTable:start",severity:"debug",context:{apiId:e,writeMode:l,headerLength:s.length,rowCount:a.length,sheetName:c,tableName:u}});try{let d=i.workbook.worksheets,p=d.getItemOrNullObject(c);p.load("name"),yield i.sync(),p.isNullObject&&(p=d.add(c)),yield this.writeQueryTableData(i,p,u,s,a,e),yield i.sync(),this.telemetry.logEvent({category:"excel",name:"upsertQueryTable",severity:"info",message:"ok",context:{apiId:e,sheetName:c,tableName:u,rowCount:r.length}})}catch(d){return this.telemetry.normalizeError("upsertQueryTable",d,"Failed to write query results into Excel.")}return yield this.recordOwnership({tableName:u,sheetName:c,queryId:e}),{ok:!0,value:{sheetName:c,tableName:u}}}))):{ok:!1,error:{operation:"upsertQueryTable",message:"Excel is not available in the current host."}}})}appendLogEntry(e){return v(this,null,function*(){this.isExcel&&(yield this.ensureOfficeReady(),yield Excel.run(t=>v(this,null,function*(){let r=t.workbook.worksheets,o=r.getItemOrNullObject("_Extension_Log");if(o.load("name"),yield t.sync(),o.isNullObject){o=r.add("_Extension_Log");let l=[["timestamp","level","operation","message"]],c=o.getRange("A1:D1");c.values=l}let i=o.getUsedRangeOrNullObject();yield t.sync();let s=i.isNullObject?1:i.getLastRow().rowIndex+1,a=o.getRange(`A${s+1}:D${s+1}`);a.values=[[new Date().toISOString(),e.level,e.operation,e.message??""]],yield t.sync()})))})}writeOwnershipRecord(e){return v(this,null,function*(){this.isExcel&&(yield this.ensureOfficeReady(),yield Excel.run(t=>v(this,null,function*(){let r=t.workbook.worksheets,o=r.getItemOrNullObject("_Extension_Ownership");if(o.load("name"),yield t.sync(),o.isNullObject){o=r.add("_Extension_Ownership"),o.visibility=Excel.SheetVisibility.veryHidden;let p=[["sheetName","tableName","queryId","isManaged","lastTouchedUtc"]],f=o.getRange("A1:E1");f.values=p}let i=o.getUsedRangeOrNullObject();yield t.sync();let s=[];if(!i.isNullObject){i.load("values"),yield t.sync();let p=i.values||[];for(let f of p)s.push(f)}let a=1,l=new Date().toISOString(),c=-1;for(let p=a;p<s.length;p++){let f=s[p];if(!f)continue;let[b,x,S]=f;if(b===e.sheetName&&x===e.tableName&&S===e.queryId){c=p;break}}let u=c===-1?s.length:c,d=o.getRange(`A${u+1}:E${u+1}`);d.values=[[e.sheetName,e.tableName,e.queryId,"true",l]],yield t.sync()})))})}deleteOwnershipRecord(e){return v(this,null,function*(){this.isExcel&&(yield this.ensureOfficeReady(),yield Excel.run(t=>v(this,null,function*(){let o=t.workbook.worksheets.getItemOrNullObject("_Extension_Ownership");if(o.load("name"),yield t.sync(),o.isNullObject)return;let i=o.getUsedRangeOrNullObject();if(yield t.sync(),i.isNullObject)return;i.load("values"),yield t.sync();let s=i.values||[];if(s.length<=1)return;let a=1,l=-1;for(let u=a;u<s.length;u++){let d=s[u];if(!d)continue;let[p,f,b]=d;if(p===e.sheetName&&f===e.tableName&&b===e.queryId){l=u;break}}if(l===-1)return;o.getRange(`A${l+1}:E${l+1}`).delete(Excel.DeleteShiftDirection.up),yield t.sync()})))})}recordOwnership(e){return v(this,null,function*(){return this.writeOwnershipRecord(e)})}computeHeaderAndValues(e){let t=e.length?Object.keys(e[0]):[],r=e.map(s=>t.map(a=>s[a]??null)),o=t.length?t:["Value"],i=r.length?r:[[null]];return{header:o,values:i}}sleep(e){return new Promise(t=>setTimeout(t,e))}writeRowsInChunks(e,t,r,o=1e3,i=100,s){return v(this,null,function*(){if(r.length===0)return;let a=Math.ceil(r.length/o);for(let l=0;l<r.length;l+=o){let c=r.slice(l,l+o),u=Math.floor(l/o);t.rows.add(null,c),yield e.sync(),this.telemetry.logEvent({category:"excel",name:"writeRowsInChunks:chunk",severity:"debug",context:{chunkIndex:u,totalChunks:a,chunkSize:c.length,totalRows:r.length}}),s&&s(u,a),l+o<r.length&&(yield this.sleep(i))}})}writeQueryTableData(e,t,r,o,i,s){return v(this,null,function*(){let a=e.workbook.tables.getItemOrNullObject(r);a.load("name,worksheet,showHeaders"),yield e.sync();let l=()=>{let c=t.getRange("A1"),u=1+i.length,d=o.length,p=c.getResizedRange(u-1,d-1);p.values=[o,...i];let f=e.workbook.tables.add(p,!0);return f.name=r,f};if(a.isNullObject)this.telemetry.logEvent({category:"excel",name:"upsertQueryTable:createNewTable",severity:"debug",context:{queryId:s,tableName:r,totalRowCount:1+i.length,totalColumnCount:o.length}}),a=l();else{a.showHeaders||(a.showHeaders=!0);let c=a.getHeaderRowRange();c.load("values,columnCount");let u=a.getDataBodyRange();u.load("rowCount,columnCount"),yield e.sync();let d=c.values[0],p=c.columnCount,f=p===o.length&&d.length===o.length;if(this.telemetry.logEvent({category:"excel",name:"upsertQueryTable:headerShape",severity:"debug",context:{queryId:s,currentColumnCount:p,effectiveHeaderLength:o.length,currentHeaderLength:d.length,headerShapeMatches:f}}),!f)this.telemetry.logEvent({category:"excel",name:"upsertQueryTable:headerMismatch_recreate",severity:"debug",context:{queryId:s,tableName:r}}),a.delete(),a=l();else{if(c.values=[o],u.rowCount>0){let x=a.rows;x.load("count"),yield e.sync();for(let S=x.count-1;S>=0;S--)x.getItemAt(S).delete()}if(i.length>0){let x=this.settings.value.queryExecution,S=x?.chunkSize??1e3,T=x?.chunkBackoffMs??100;this.telemetry.logEvent({category:"excel",name:"upsertQueryTable:overwrite",severity:"debug",context:{queryId:s,overwriteRowCount:i.length,columnCount:o.length,chunkSize:S,willChunk:i.length>S}}),yield this.writeRowsInChunks(e,a,i,S,T,(me,et)=>{this.telemetry.logEvent({category:"excel",name:"writeQueryTableData:progress",severity:"debug",context:{queryId:s,chunk:me+1,total:et,rowsWritten:Math.min((me+1)*S,i.length),totalRows:i.length}})})}}}return a})}activateQueryLocation(e){return v(this,null,function*(){!this.isExcel||!e||(yield this.ensureOfficeReady(),yield Excel.run(t=>v(this,null,function*(){t.workbook.worksheets.getItem(e.sheetName).activate(),t.workbook.tables.getItem(e.tableName).getRange().select(),yield t.sync()})))})}static CalculationMode={Automatic:"Automatic",Manual:"Manual"};setCalculationMode(e){return v(this,null,function*(){if(!this.isExcel)return{ok:!1,error:{operation:"setCalculationMode",message:"Excel is not available in the current host."}};yield this.ensureOfficeReady();try{return yield Excel.run(t=>v(this,null,function*(){let r=t.workbook.application;r.load("calculationMode"),yield t.sync();let o=r.calculationMode,i=e==="Manual"?Excel.CalculationMode.manual:Excel.CalculationMode.automatic;return r.calculationMode=i,yield t.sync(),this.telemetry.logEvent({category:"excel",name:"setCalculationMode",severity:"info",context:{previousMode:o,newMode:e}}),{ok:!0,value:{previousMode:o}}}))}catch(t){return this.telemetry.normalizeError("setCalculationMode",t,"Failed to set calculation mode.")}})}getCalculationMode(){return v(this,null,function*(){if(!this.isExcel)return{ok:!1,error:{operation:"getCalculationMode",message:"Excel is not available in the current host."}};yield this.ensureOfficeReady();try{return yield Excel.run(e=>v(this,null,function*(){let t=e.workbook.application;return t.load("calculationMode"),yield e.sync(),{ok:!0,value:{mode:t.calculationMode}}}))}catch(e){return this.telemetry.normalizeError("getCalculationMode",e,"Failed to get calculation mode.")}})}purgeExtensionManagedContent(){return v(this,null,function*(){this.isExcel&&(yield this.ensureOfficeReady(),yield Excel.run(e=>v(this,null,function*(){let t=e.workbook.worksheets,r=t.getItemOrNullObject("_Extension_Ownership");if(r.load("name"),yield e.sync(),r.isNullObject)return;let o=r.getUsedRangeOrNullObject();if(yield e.sync(),o.isNullObject){r.delete(),yield e.sync();return}o.load("values"),yield e.sync();let i=o.values||[];if(i.length<=1){r.delete(),yield e.sync();return}let[,...s]=i,a=s.filter(u=>u&&u.length>=4).map(u=>{let[d,p,,f]=u;return{sheetName:d,tableName:p,isManaged:String(f).toLowerCase()==="true"}}).filter(u=>u.sheetName&&u.tableName&&u.isManaged),l=e.workbook.tables,c=new Set;for(let u of a){let d=l.getItemOrNullObject(u.tableName);if(d.load("name,worksheet"),yield e.sync(),!d.isNullObject){let p=d.worksheet;p.load("name"),yield e.sync(),c.add(p.name),d.delete(),yield e.sync()}}for(let u of c){let d=t.getItemOrNullObject(u);if(d.load("name"),yield e.sync(),d.isNullObject)continue;let p=d.getUsedRangeOrNullObject();yield e.sync(),p.isNullObject&&(d.delete(),yield e.sync())}r=t.getItemOrNullObject("_Extension_Ownership"),yield e.sync(),r.isNullObject||(r.delete(),yield e.sync())})))})}static \u0275fac=function(t){return new(t||n)(C(ae),C(Je))};static \u0275prov=I({token:n,factory:n.\u0275fac,providedIn:"root"})};var wt=class n{constructor(e){this.excel=e}get isExcel(){return this.excel.isExcel}getSheets(){return v(this,null,function*(){return this.excel.getWorksheets()})}getTables(){return v(this,null,function*(){return this.excel.getWorkbookTables()})}getTableByName(e){return v(this,null,function*(){return(yield this.getTables()).find(r=>r.name===e)})}getOwnership(){return v(this,null,function*(){return this.excel.getWorkbookOwnership()})}isExtensionManagedTable(e){return v(this,null,function*(){return(yield this.getOwnership()).some(r=>r.tableName===e.name&&r.sheetName===e.worksheet&&r.isManaged)})}getManagedTablesForQuery(e){return v(this,null,function*(){let[t,r]=yield Promise.all([this.getTables(),this.getOwnership()]),o=new Set(r.filter(i=>i.queryId===e&&i.isManaged).map(i=>`${i.sheetName}::${i.tableName}`));return t.filter(i=>o.has(`${i.worksheet}::${i.name}`))})}isManagedForQuery(e,t,r){return e.some(o=>o.isManaged&&o.queryId===r&&o.tableName===t.name&&o.sheetName===t.worksheet)}getManagedTableForQuery(e){return v(this,null,function*(){let[t,r]=yield Promise.all([this.getTables(),this.getOwnership()]);return t.find(o=>this.isManagedForQuery(r,o,e))})}getOrCreateManagedTableTarget(e){return v(this,null,function*(){if(!this.isExcel)return null;let[t,r]=yield Promise.all([this.getTables(),this.getOwnership()]),o=t.find(a=>this.isManagedForQuery(r,a,e.id));if(o)return{sheetName:o.worksheet,tableName:o.name,existing:o};let i=e.defaultTableName;if(t.find(a=>a.name===i)){let a=`${i}_${e.id}`;return{sheetName:e.defaultSheetName,tableName:a}}return{sheetName:e.defaultSheetName,tableName:i}})}resolveTableTarget(e,t){return v(this,null,function*(){if(!this.isExcel)return null;let[r,o]=yield Promise.all([this.getTables(),this.getOwnership()]),i=r.find(l=>o.some(c=>c.isManaged&&c.queryId===e&&c.tableName===l.name&&c.sheetName===l.worksheet));if(i)return{sheetName:i.worksheet,tableName:i.name,isExisting:!0};let a=r.find(l=>l.name===t.tableName)?`${t.tableName}_${e}`:t.tableName;return{sheetName:t.sheetName,tableName:a,isExisting:!1}})}recordOwnership(e){return v(this,null,function*(){this.isExcel&&(yield this.excel.writeOwnershipRecord(e))})}updateOwnership(e,t,r){return v(this,null,function*(){this.isExcel&&(yield this.excel.writeOwnershipRecord({queryId:e,sheetName:t,tableName:r}))})}deleteOwnership(e,t,r){return v(this,null,function*(){this.isExcel&&(yield this.excel.deleteOwnershipRecord({queryId:e,sheetName:t,tableName:r}))})}static \u0275fac=function(t){return new(t||n)(C(je))};static \u0275prov=I({token:n,factory:n.\u0275fac,providedIn:"root"})};var kb=()=>({field:"name",header:"Name"}),Ob=n=>[n];function Pb(n,e){n&1&&(h(0,"div",6)(1,"span"),y(2,"Loading worksheets..."),g()())}function Fb(n,e){if(n&1&&(h(0,"div",7),y(1),g()),n&2){let t=w(2);m(),Y(" ",t.loadError," ")}}function Lb(n,e){if(n&1&&te(0,"app-table",8),n&2){let t=w(2);D("columns",yo(3,Ob,ue(2,kb)))("rows",t.sheetsAsRows)}}function Vb(n,e){if(n&1&&(vt(0),A(1,Pb,3,0,"div",3)(2,Fb,2,1,"div",4)(3,Lb,1,5,"app-table",5),Et()),n&2){let t=w();m(),D("ngIf",t.isLoading),m(),D("ngIf",t.loadError),m(),D("ngIf",!t.isLoading&&!t.loadError)}}function jb(n,e){n&1&&(h(0,"p"),y(1,"Excel not detected."),g())}var sa=class n{constructor(e,t,r){this.excel=e;this.workbook=t;this.telemetry=r}sheets=[];sheetsAsRows=[];loadError=null;isLoading=!0;get isExcel(){return this.workbook.isExcel}ngOnInit(){return v(this,null,function*(){if(!this.isExcel){this.isLoading=!1;return}try{this.sheets=yield this.workbook.getSheets(),this.sheetsAsRows=this.sheets.map(e=>({name:e}))}catch(e){this.loadError="Failed to load worksheets",this.telemetry.logEvent({category:"excel",name:"worksheets.load.error",severity:"error",message:"Failed to load worksheets in ngOnInit",context:{error:e instanceof Error?e.message:String(e)}})}finally{this.isLoading=!1}})}static \u0275fac=function(t){return new(t||n)(_(je),_(wt),_(ae))};static \u0275cmp=Q({type:n,selectors:[["app-worksheets"]],decls:4,vars:2,consts:[["noExcel",""],["title","Worksheets"],[4,"ngIf","ngIfElse"],["class","loading","role","status","aria-live","polite",4,"ngIf"],["class","error","role","alert",4,"ngIf"],["emptyMessage","No worksheets found.",3,"columns","rows",4,"ngIf"],["role","status","aria-live","polite",1,"loading"],["role","alert",1,"error"],["emptyMessage","No worksheets found.",3,"columns","rows"]],template:function(t,r){if(t&1&&(h(0,"app-section",1),A(1,Vb,4,3,"ng-container",2)(2,jb,2,0,"ng-template",null,0,Fe),g()),t&2){let o=Se(3);m(),D("ngIf",r.isExcel)("ngIfElse",o)}},dependencies:[G,ee,Ke,tn],styles:["table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{border:1px solid #ccc;padding:.25rem}"]})};var Bb=()=>({field:"name",header:"Name"}),Hb=()=>({field:"worksheet",header:"Worksheet"}),Ub=()=>({field:"rows",header:"Rows"}),$b=()=>({field:"isManaged",header:"Managed by extension"}),qb=(n,e,t,r)=>[n,e,t,r];function Wb(n,e){n&1&&(h(0,"div",6)(1,"span"),y(2,"Loading tables..."),g()())}function Gb(n,e){if(n&1&&(h(0,"div",7),y(1),g()),n&2){let t=w(2);m(),Y(" ",t.loadError," ")}}function zb(n,e){if(n&1&&te(0,"app-table",8),n&2){let t=w(2);D("columns",Kc(6,qb,ue(2,Bb),ue(3,Hb),ue(4,Ub),ue(5,$b)))("rows",t.tables)}}function Qb(n,e){if(n&1&&(vt(0),A(1,Wb,3,0,"div",3)(2,Gb,2,1,"div",4)(3,zb,1,11,"app-table",5),Et()),n&2){let t=w();m(),D("ngIf",t.isLoading),m(),D("ngIf",t.loadError),m(),D("ngIf",!t.isLoading&&!t.loadError)}}function Zb(n,e){n&1&&(h(0,"p"),y(1,"Excel not detected."),g())}var aa=class n{constructor(e,t){this.workbook=e;this.telemetry=t}tables=[];loadError=null;isLoading=!0;get isExcel(){return this.workbook.isExcel}ngOnInit(){return v(this,null,function*(){if(!this.isExcel){this.isLoading=!1;return}try{let e=yield this.workbook.getTables(),t=yield this.workbook.getOwnership(),r=new Set(t.filter(o=>o.isManaged).map(o=>`${o.sheetName}::${o.tableName}`));this.tables=e.map(o=>({name:o.name,worksheet:o.worksheet,rows:o.rows,isManaged:r.has(`${o.worksheet}::${o.name}`)}))}catch(e){this.loadError="Failed to load tables",this.telemetry.logEvent({category:"excel",name:"tables.load.error",severity:"error",message:"Failed to load tables in ngOnInit",context:{error:e instanceof Error?e.message:String(e)}})}finally{this.isLoading=!1}})}static \u0275fac=function(t){return new(t||n)(_(wt),_(ae))};static \u0275cmp=Q({type:n,selectors:[["app-tables"]],decls:4,vars:2,consts:[["noExcel",""],["title","Tables"],[4,"ngIf","ngIfElse"],["class","loading","role","status","aria-live","polite",4,"ngIf"],["class","error","role","alert",4,"ngIf"],["emptyMessage","No tables found.",3,"columns","rows",4,"ngIf"],["role","status","aria-live","polite",1,"loading"],["role","alert",1,"error"],["emptyMessage","No tables found.",3,"columns","rows"]],template:function(t,r){if(t&1&&(h(0,"app-section",1),A(1,Qb,4,3,"ng-container",2)(2,Zb,2,0,"ng-template",null,0,Fe),g()),t&2){let o=Se(3);m(),D("ngIf",r.isExcel)("ngIfElse",o)}},dependencies:[G,ee,Ke,tn],styles:["table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{border:1px solid #ccc;padding:.25rem}"]})};function Yb(n,e){n&1&&(h(0,"p")(1,"strong"),y(2,"Admin capabilities:"),g(),y(3," You can manage global settings and queries. "),g())}function Kb(n,e){n&1&&(h(0,"p")(1,"strong"),y(2,"Analyst capabilities:"),g(),y(3," You can run queries and work with data tables. "),g())}function Jb(n,e){if(n&1&&(h(0,"section")(1,"p")(2,"strong"),y(3,"Name:"),g(),y(4),g(),h(5,"p")(6,"strong"),y(7,"Email:"),g(),y(8),g(),h(9,"p")(10,"strong"),y(11,"Roles:"),g(),y(12),g(),A(13,Yb,4,0,"p",5)(14,Kb,4,0,"p",5),g()),n&2){let t=w(2);m(4),Y(" ",t.user.displayName),m(4),Y(" ",t.user.email),m(4),Y(" ",t.roles.length?t.roles.join(", "):"(none)"),m(),D("ngIf",t.isAdmin),m(),D("ngIf",!t.isAdmin&&t.isAnalyst)}}function Xb(n,e){n&1&&(h(0,"p"),y(1,"No user profile available."),g())}function e_(n,e){if(n&1&&(h(0,"app-section",3),A(1,Jb,15,5,"section",4)(2,Xb,2,0,"ng-template",null,1,Fe),g()),n&2){let t=Se(3),r=w();m(),D("ngIf",r.user)("ngIfElse",t)}}function t_(n,e){n&1&&(h(0,"p"),y(1,"You are not signed in."),g())}var la=class n{constructor(e){this.auth=e}get user(){return this.auth.user}get roles(){return this.auth.roles}get isAuthenticated(){return this.auth.isAuthenticated}get isAdmin(){return this.auth.hasRole("admin")}get isAnalyst(){return this.auth.hasRole("analyst")}static \u0275fac=function(t){return new(t||n)(_(he))};static \u0275cmp=Q({type:n,selectors:[["app-user"]],decls:3,vars:2,consts:[["notSignedIn",""],["noUser",""],["class","user","title","User Profile",4,"ngIf","ngIfElse"],["title","User Profile",1,"user"],[4,"ngIf","ngIfElse"],[4,"ngIf"]],template:function(t,r){if(t&1&&A(0,e_,4,2,"app-section",2)(1,t_,2,0,"ng-template",null,0,Fe),t&2){let o=Se(2);D("ngIf",r.isAuthenticated)("ngIfElse",o)}},dependencies:[G,ee,Ke],styles:[".user[_ngcontent-%COMP%]{padding:.5rem 0}.user[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.25rem 0}"]})};var Rm={defaultViewId:"sso",navItems:[{id:"nav-sso",labelKey:"nav.ssoHome",viewId:"sso",domId:"nav-sso",actionType:"select-view"},{id:"nav-worksheets",labelKey:"nav.worksheets",viewId:"worksheets",requiresAuth:!0,domId:"nav-worksheets",actionType:"select-view"},{id:"nav-tables",labelKey:"nav.tables",viewId:"tables",requiresAuth:!0,domId:"nav-tables",actionType:"select-view"},{id:"nav-user",labelKey:"nav.user",viewId:"user",requiresAuth:!0,domId:"nav-user",actionType:"select-view"},{id:"nav-queries",labelKey:"nav.queries",viewId:"queries",requiresAuth:!0,requiredRoles:["analyst","admin"],domId:"nav-queries",actionType:"select-view"},{id:"nav-debug",labelKey:"nav.debug",viewId:"debug",requiresAuth:!0,requiredRoles:["admin"],domId:"nav-debug",actionType:"select-view"},{id:"nav-settings",labelKey:"nav.settings",viewId:"settings",requiresAuth:!0,domId:"nav-settings",actionType:"select-view"},{id:"nav-signin-analyst",labelKey:"auth.signInAnalyst",actionType:"sign-in-analyst",buttonVariant:"secondary",buttonSize:"sm"},{id:"nav-signin-admin",labelKey:"auth.signInAdmin",actionType:"sign-in-admin",buttonVariant:"secondary",buttonSize:"sm"},{id:"nav-signout",labelKey:"auth.signOut",actionType:"sign-out",buttonVariant:"ghost",buttonSize:"sm",requiresAuth:!0}],rootIdsAndClasses:{navClass:"mobile-nav",statusClass:"status",userBannerClass:"user-banner",hostStatusClass:"host-status",rootClass:"app-shell",extraRootClasses:""},roles:[{id:"analyst",labelKey:"role.analyst.label",descriptionKey:"role.analyst.description"},{id:"admin",labelKey:"role.admin.label",descriptionKey:"role.admin.description"}],ui:{navButtonVariant:"primary",navButtonSize:"md",hostStatusBannerType:"info",viewLayout:{sso:{sectionVariant:"default"},user:{sectionVariant:"default"},worksheets:{sectionVariant:"dense"},tables:{sectionVariant:"dense"},queries:{sectionVariant:"default"}}},apiCatalog:[{id:"sales-summary",name:"Sales Summary",description:"Summarized sales by region and month.",allowedRoles:["analyst","admin"],parameters:[{key:"startDate",type:"date",required:!0,label:"Start Date"},{key:"endDate",type:"date",required:!0,label:"End Date"}],responseSchema:[{key:"region",name:"Region",dataType:"string"},{key:"totalSales",name:"Total Sales",dataType:"number"},{key:"period",name:"Period",dataType:"string"}]},{id:"top-customers",name:"Top Customers",description:"Top customers by revenue.",allowedRoles:["analyst","admin"],parameters:[{key:"topN",type:"number",required:!1,defaultValue:10,label:"Top N"}],responseSchema:[{key:"customerName",name:"Customer Name",dataType:"string"},{key:"revenue",name:"Revenue",dataType:"number"},{key:"orderCount",name:"Order Count",dataType:"number"}]},{id:"inventory-status",name:"Inventory Status",description:"Current inventory levels by product.",allowedRoles:["analyst","admin"],parameters:[],responseSchema:[{key:"productId",name:"Product ID",dataType:"string"},{key:"productName",name:"Product Name",dataType:"string"},{key:"quantity",name:"Quantity",dataType:"number"},{key:"status",name:"Status",dataType:"string"}]},{id:"jsonapi-example",name:"JSONPlaceholder Users",description:"Fetches user data from jsonplaceholder.typicode.com and flattens it into Excel-friendly rows.",allowedRoles:["admin"],parameters:[],catalogUiConfig:{category:"External APIs",tags:["demo","api"]}},{id:"user-demographics",name:"User Demographics",description:"Comprehensive user demographic data with 25 columns and 5000 rows from randomuser.me.",allowedRoles:["admin"],parameters:[],catalogUiConfig:{category:"Large Datasets",tags:["demo","large"]}},{id:"large-dataset",name:"Large Dataset (Multiple Batches)",description:"10k rows with 30 columns from multiple paginated API calls.",allowedRoles:["admin"],parameters:[],catalogUiConfig:{category:"Large Datasets",tags:["demo","large","performance"]}},{id:"product-catalog",name:"Product Catalog",description:"1000 products with 20+ columns from DummyJSON API.",allowedRoles:["admin"],parameters:[],catalogUiConfig:{category:"Large Datasets",tags:["demo","products"]}},{id:"mixed-dataset",name:"Mixed Dataset (Users + Posts)",description:"8000 rows combining user and post data with 35+ columns.",allowedRoles:["admin"],parameters:[],catalogUiConfig:{category:"Large Datasets",tags:["demo","large","mixed"]}},{id:"synthetic-expansion",name:"Synthetic Expansion Dataset",description:"25k rows with 40 columns including synthetic transaction data.",allowedRoles:["admin"],parameters:[],catalogUiConfig:{category:"Large Datasets",tags:["demo","large","synthetic"]}}],text:{nav:{ssoHome:"SSO Home",worksheets:"Worksheets",tables:"Tables",user:"User",queries:"Queries",debug:"Debug",settings:"Settings"},auth:{signInAnalyst:"Sign in as analyst",signInAdmin:"Sign in as admin",signOut:"Sign out"},query:{},worksheet:{},table:{},user:{},role:{analyst:{label:"Analyst",description:"Analyst role with query access"},admin:{label:"Admin",description:"Administrator role with full access"}},hostStatus:{excelNotDetectedLabel:"Excel not detected.",excelNotDetectedMessage:"Open this add-in inside Excel to enable worksheet and query features.",excelConnectedLabel:"Excel connected.",onlineLabel:"Online",offlineLabel:"Offline",offlineMessage:"Some features may be unavailable until connectivity is restored."},userBanner:{noRolesAssigned:"No roles assigned"},ui:{}}};var ca=class n{validate(e){let t=[];return e.defaultViewId||t.push("Config missing required field: defaultViewId"),!e.navItems||!Array.isArray(e.navItems)?t.push("Config missing or invalid field: navItems (must be array)"):e.navItems.length===0&&t.push("Config navItems array is empty"),(!e.roles||!Array.isArray(e.roles))&&t.push("Config missing or invalid field: roles (must be array)"),e.rootIdsAndClasses||t.push("Config missing required field: rootIdsAndClasses"),e.navItems&&Array.isArray(e.navItems)&&e.navItems.forEach((r,o)=>{r.id||t.push(`navItems[${o}] missing required field: id`),r.labelKey||t.push(`navItems[${o}] missing required field: labelKey`),r.actionType||t.push(`navItems[${o}] missing required field: actionType`)}),e.apiCatalog!==void 0&&(Array.isArray(e.apiCatalog)?e.apiCatalog.forEach((r,o)=>{r.id||t.push(`apiCatalog[${o}] missing required field: id`),r.name||t.push(`apiCatalog[${o}] missing required field: name`),(!r.parameters||!Array.isArray(r.parameters))&&t.push(`apiCatalog[${o}] missing or invalid field: parameters (must be array)`)}):t.push("Config apiCatalog must be an array")),e.text!==void 0&&(typeof e.text!="object"||e.text===null?t.push("Config text must be an object"):["nav","auth","query","worksheet","table","user","ui"].forEach(o=>{o in e.text||t.push(`Config text missing required section: ${o}`)})),{valid:t.length===0,errors:t}}validateOrThrow(e){let t=this.validate(e);if(!t.valid)throw new Error(`Config validation failed:
${t.errors.join(`
`)}`)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=I({token:n,factory:n.\u0275fac,providedIn:"root"})};var xr=class n{http=M(Hs);validator=M(ca);injector=M(rt);configSubject=new _e(Rm);config$=this.configSubject.asObservable();getConfig(){return this.configSubject.value}setConfig(e){this.configSubject.next(e)}mergeConfig(e){let t=E(E({},this.configSubject.value),e);this.configSubject.next(t)}loadRemoteConfig(e){return v(this,null,function*(){try{let t=this.buildRequestOptions(),r=yield Fa(this.http.get(e,t));if(this.isFullConfig(r)){let s=this.validator.validate(r);if(!s.valid)return console.warn("Remote config validation failed:",s.errors),!1}let o=this.deepMergeConfigs(this.configSubject.value,r),i=this.validator.validate(o);return i.valid?(this.configSubject.next(o),console.log("Remote config loaded successfully from:",e),!0):(console.warn("Merged config validation failed:",i.errors),!1)}catch(t){return console.warn("Failed to load remote config from:",e,t),!1}})}reloadConfig(e="/assets/app-config.json"){return v(this,null,function*(){return this.loadRemoteConfig(e)})}deepMergeConfigs(e,t){let r=E({},e);return t.defaultViewId!==void 0&&(r.defaultViewId=t.defaultViewId),t.navItems!==void 0&&(r.navItems=t.navItems),t.roles!==void 0&&(r.roles=t.roles),t.apiCatalog!==void 0&&(r.apiCatalog=t.apiCatalog),t.rootIdsAndClasses!==void 0&&(r.rootIdsAndClasses=E(E({},e.rootIdsAndClasses),t.rootIdsAndClasses)),t.ui!==void 0&&(r.ui=E(E({},e.ui),t.ui)),t.text!==void 0&&(r.text={nav:E(E({},e.text?.nav),t.text.nav),auth:E(E({},e.text?.auth),t.text.auth),query:E(E({},e.text?.query),t.text.query),worksheet:E(E({},e.text?.worksheet),t.text.worksheet),table:E(E({},e.text?.table),t.text.table),user:E(E({},e.text?.user),t.text.user),role:E(E({},e.text?.role),t.text.role),hostStatus:E(E({},e.text?.hostStatus),t.text.hostStatus),userBanner:E(E({},e.text?.userBanner),t.text.userBanner),ui:E(E({},e.text?.ui),t.text.ui)}),r}isFullConfig(e){return!!(e.defaultViewId&&e.navItems&&e.roles&&e.rootIdsAndClasses)}buildRequestOptions(){try{let t=this.injector.get(he).getAccessToken();if(t)return{headers:new bt({Authorization:`Bearer ${t}`})}}catch{}return{}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=I({token:n,factory:n.\u0275fac,providedIn:"root"})};var Xe=class n{constructor(e){this.appConfig=e;this.apis$=this.appConfig.config$.pipe(de(t=>t.apiCatalog||[]))}apis$;_deprecatedApis=[{id:"sales-summary",name:"Sales Summary",description:"Summarized sales by region and month.",allowedRoles:["analyst","admin"],parameters:[{key:"startDate",type:"date",required:!0,label:"Start Date"},{key:"endDate",type:"date",required:!0,label:"End Date"}],responseSchema:[{key:"region",name:"Region",dataType:"string"},{key:"totalSales",name:"Total Sales",dataType:"number"},{key:"period",name:"Period",dataType:"string"}]},{id:"top-customers",name:"Top Customers",description:"Top customers by revenue.",allowedRoles:["analyst","admin"],parameters:[{key:"topN",type:"number",required:!1,defaultValue:10,label:"Top N"}],responseSchema:[{key:"customerName",name:"Customer Name",dataType:"string"},{key:"revenue",name:"Revenue",dataType:"number"},{key:"orderCount",name:"Order Count",dataType:"number"}]},{id:"inventory-status",name:"Inventory Status",description:"Current inventory levels by product.",allowedRoles:["analyst","admin"],parameters:[],responseSchema:[{key:"productId",name:"Product ID",dataType:"string"},{key:"productName",name:"Product Name",dataType:"string"},{key:"quantity",name:"Quantity",dataType:"number"},{key:"status",name:"Status",dataType:"string"}]},{id:"jsonapi-example",name:"JSONPlaceholder Users",description:"Fetches user data from jsonplaceholder.typicode.com and flattens it into Excel-friendly rows.",allowedRoles:["admin"],parameters:[],catalogUiConfig:{category:"External APIs",tags:["demo","api"]}},{id:"user-demographics",name:"User Demographics",description:"Comprehensive user demographic data with 25 columns and 5000 rows from randomuser.me.",allowedRoles:["admin"],parameters:[],catalogUiConfig:{category:"Large Datasets",tags:["demo","large"]}},{id:"large-dataset",name:"Large Dataset (Multiple Batches)",description:"10k rows with 30 columns from multiple paginated API calls.",allowedRoles:["admin"],parameters:[],catalogUiConfig:{category:"Large Datasets",tags:["demo","large","performance"]}},{id:"product-catalog",name:"Product Catalog",description:"1000 products with 20+ columns from DummyJSON API.",allowedRoles:["admin"],parameters:[],catalogUiConfig:{category:"Large Datasets",tags:["demo","products"]}},{id:"mixed-dataset",name:"Mixed Dataset (Users + Posts)",description:"8000 rows combining user and post data with 35+ columns.",allowedRoles:["admin"],parameters:[],catalogUiConfig:{category:"Large Datasets",tags:["demo","large","mixed"]}},{id:"synthetic-expansion",name:"Synthetic Expansion Dataset",description:"25k rows with 40 columns including synthetic transaction data.",allowedRoles:["admin"],parameters:[],catalogUiConfig:{category:"Large Datasets",tags:["demo","large","synthetic"]}}];getApis(){return this.appConfig.getConfig().apiCatalog||[]}getApiById(e){return(this.appConfig.getConfig().apiCatalog||[]).find(r=>r.id===e)}getApisByRole(e){return(this.appConfig.getConfig().apiCatalog||[]).filter(r=>!r.allowedRoles||r.allowedRoles.length===0?!0:r.allowedRoles.some(o=>e.includes(o)))}getApisByRole$(e){return this.apis$.pipe(de(t=>t.filter(r=>!r.allowedRoles||r.allowedRoles.length===0?!0:r.allowedRoles.some(o=>e.includes(o)))))}static \u0275fac=function(t){return new(t||n)(C(xr))};static \u0275prov=I({token:n,factory:n.\u0275fac,providedIn:"root"})};var ua=class n{constructor(e,t,r,o){this.apiCatalog=e;this.indexedDB=t;this.settings=r;this.telemetry=o}getGroupingOptions(){return v(this,null,function*(){return{groups:["All","Consumer","Enterprise","Government"],subGroups:["All","North","South","East","West"]}})}executeApi(r){return v(this,arguments,function*(e,t={}){if(!this.apiCatalog.getApiById(e))throw new Error(`API not found: ${e}`);let i=this.generateCacheKey(e,t),s=yield this.indexedDB.getCachedQueryResult(i);if(s)return s;let a=yield this.executeApiUncached(e,t);return yield this.indexedDB.cacheQueryResult(i,a),a})}executeApiUncached(e,t){return v(this,null,function*(){let o=this.settings.value.queryExecution?.maxRowsPerQuery??1e4,i;switch(e){case"jsonapi-example":i=yield this.fetchJsonPlaceholderUsers();break;case"user-demographics":i=yield this.fetchUserDemographics();break;case"large-dataset":i=yield this.fetchLargeDataset();break;case"product-catalog":i=yield this.fetchProductCatalog();break;case"mixed-dataset":i=yield this.fetchMixedDataset();break;case"synthetic-expansion":i=yield this.fetchSyntheticExpansion();break;default:i=yield this.loadAndFilterMockRows(e,t)}return i.length>o?(this.telemetry.logEvent({category:"query",name:"executeApi:rowLimitExceeded",severity:"warn",message:`Query result exceeded max row limit (${i.length} > ${o})`,context:{apiId:e,rowCount:i.length,maxRows:o,truncated:!0}}),i.slice(0,o)):i})}generateCacheKey(e,t){let r=Object.keys(t).sort().reduce((o,i)=>(o[i]=t[i],o),{});return`${e}:${JSON.stringify(r)}`}loadAndFilterMockRows(e,t){return v(this,null,function*(){let r=[];try{switch(e){case"sales-summary":r=(yield import("./chunk-A2D2D2JU.js")).default;break;case"top-customers":r=(yield import("./chunk-ZWWW3NHK.js")).default;break;case"inventory-status":r=(yield import("./chunk-OE5L4E2N.js")).default;break;default:return[]}}catch{return[]}let o=t.StartDate??t.startDate,i=t.EndDate??t.endDate,s=typeof t.Group=="string"?t.Group:"",a=typeof t.SubGroup=="string"?t.SubGroup:"",l=s&&s!=="All"?s:"",c=a&&a!=="All"?a:"",u=r;if(o||i){let d=o?new Date(String(o)):null,p=i?new Date(String(i)):null;u=u.filter(f=>{let b=f.AsOfDate?new Date(String(f.AsOfDate)):null;return!(!b||d&&b<d||p&&b>p)})}if(l&&(u=u.filter(d=>d.Group===l)),c&&(u=u.filter(d=>d.SubGroup===c)),e==="top-customers"){let d=t.topN,p=typeof d=="number"&&d>0?Math.min(d,200):50;u=u.slice().sort((f,b)=>(Number(f.Rank)||0)-(Number(b.Rank)||0)).filter(f=>(Number(f.Rank)||0)>=1&&(Number(f.Rank)||0)<=p)}return u})}buildJsonApiExampleRows(e){let t=e.resourceType;return(typeof t=="string"&&t.trim().length?t.trim():"articles")==="people"?[{Type:"people",Id:"9",Name:"Dan",Twitter:"@dan"},{Type:"people",Id:"2",Name:"John",Twitter:"@john"}]:[{Type:"articles",Id:"1",Title:"JSON:API paints my bikeshed!",AuthorId:"9",Created:new Date("2015-05-22T14:56:29.000Z")},{Type:"articles",Id:"2",Title:"Understanding JSON:API relationships",AuthorId:"2",Created:new Date("2015-05-23T10:12:00.000Z")}]}fetchJsonPlaceholderUsers(){return v(this,null,function*(){let t=yield fetch("https://jsonplaceholder.typicode.com/users",{method:"GET"});if(!t.ok)throw new Error(`JSONPlaceholder request failed: ${t.status}`);let r=yield t.json();return Array.isArray(r)?r.map(o=>({Id:o.id,Name:o.name,Username:o.username,Email:o.email,Phone:o.phone,Website:o.website,City:o.address?.city??"",Company:o.company?.name??""})):this.buildJsonPlaceholderFallbackRows()})}buildJsonPlaceholderFallbackRows(){return this.buildJsonApiExampleRows({})}fetchUserDemographics(){return v(this,null,function*(){try{let e=yield fetch("https://randomuser.me/api/?results=5000");if(!e.ok)throw new Error(`RandomUser API request failed: ${e.status}`);return(yield e.json()).results.map(r=>({id:r.login.uuid,firstName:r.name.first,lastName:r.name.last,title:r.name.title,gender:r.gender,email:r.email,phone:r.phone,cell:r.cell,streetNumber:r.location.street.number,streetName:r.location.street.name,city:r.location.city,state:r.location.state,country:r.location.country,postcode:r.location.postcode,latitude:r.location.coordinates.latitude,longitude:r.location.coordinates.longitude,timezoneOffset:r.location.timezone.offset,timezoneDesc:r.location.timezone.description,dob:r.dob.date,age:r.dob.age,registered:r.registered.date,registeredAge:r.registered.age,nationality:r.nat,picture:r.picture.large,thumbnail:r.picture.thumbnail}))}catch(e){return console.error("Error fetching user demographics:",e),[]}})}fetchLargeDataset(){return v(this,null,function*(){try{let e=yield Promise.all([fetch("https://randomuser.me/api/?results=5000&seed=a"),fetch("https://randomuser.me/api/?results=5000&seed=b")]);return(yield Promise.all(e.map(r=>r.json()))).flatMap(r=>r.results.map(o=>({uuid:o.login.uuid,username:o.login.username,password:o.login.password,salt:o.login.salt,md5:o.login.md5,sha1:o.login.sha1,sha256:o.login.sha256,title:o.name.title,first:o.name.first,last:o.name.last,gender:o.gender,email:o.email,dobDate:o.dob.date,dobAge:o.dob.age,regDate:o.registered.date,regAge:o.registered.age,phone:o.phone,cell:o.cell,nat:o.nat,street:`${o.location.street.number} ${o.location.street.name}`,city:o.location.city,state:o.location.state,country:o.location.country,postcode:o.location.postcode,lat:o.location.coordinates.latitude,lng:o.location.coordinates.longitude,tzOffset:o.location.timezone.offset,tzDesc:o.location.timezone.description,picLarge:o.picture.large,picMed:o.picture.medium,picThumb:o.picture.thumbnail})))}catch(e){return console.error("Error fetching large dataset:",e),[]}})}fetchProductCatalog(){return v(this,null,function*(){try{let e=Array.from({length:10},(o,i)=>fetch(`https://dummyjson.com/products?limit=100&skip=${i*100}`)),t=yield Promise.all(e);return(yield Promise.all(t.map(o=>o.json()))).flatMap(o=>o.products.map(i=>({id:i.id,title:i.title,description:i.description,category:i.category,price:i.price,discountPercentage:i.discountPercentage,rating:i.rating,stock:i.stock,brand:i.brand,sku:i.sku,weight:i.weight,width:i.dimensions?.width,height:i.dimensions?.height,depth:i.dimensions?.depth,warrantyInfo:i.warrantyInformation,shippingInfo:i.shippingInformation,availabilityStatus:i.availabilityStatus,returnPolicy:i.returnPolicy,minimumOrderQty:i.minimumOrderQuantity,thumbnail:i.thumbnail,image1:i.images?.[0],image2:i.images?.[1]})))}catch(e){return console.error("Error fetching product catalog:",e),[]}})}fetchMixedDataset(){return v(this,null,function*(){try{let[e,t]=yield Promise.all([fetch("https://randomuser.me/api/?results=3000").then(i=>i.json()),Promise.all(Array.from({length:50},(i,s)=>fetch(`https://dummyjson.com/posts?limit=100&skip=${s*100}`).then(a=>a.json())))]),r=e.results.map((i,s)=>({type:"USER",id:s+1,uuid:i.login.uuid,fullName:`${i.name.first} ${i.name.last}`,email:i.email,phone:i.phone,address:`${i.location.street.number} ${i.location.street.name}`,city:i.location.city,state:i.location.state,zip:i.location.postcode,country:i.location.country,lat:i.location.coordinates.latitude,lng:i.location.coordinates.longitude,age:i.dob.age,gender:i.gender,nationality:i.nat,title:null,body:null,tags:null,reactions:null,views:null})),o=t.flatMap(i=>i.posts.map(s=>({type:"POST",id:s.id,uuid:null,fullName:null,email:null,phone:null,address:null,city:null,state:null,zip:null,country:null,lat:null,lng:null,age:null,gender:null,nationality:null,title:s.title,body:s.body,tags:s.tags?.join(", "),reactions:s.reactions?.likes,views:s.views})));return[...r,...o]}catch(e){return console.error("Error fetching mixed dataset:",e),[]}})}fetchSyntheticExpansion(){return v(this,null,function*(){try{let e=yield fetch("https://randomuser.me/api/?results=5000");if(!e.ok)throw new Error(`RandomUser API request failed: ${e.status}`);return(yield e.json()).results.flatMap((r,o)=>Array.from({length:5},(i,s)=>({recordId:o*5+s+1,userId:r.login.uuid,variant:s+1,timestamp:new Date(Date.now()-Math.random()*31536e6).toISOString(),title:r.name.title,firstName:r.name.first,lastName:r.name.last,gender:r.gender,email:r.email,username:r.login.username,phone:r.phone,cell:r.cell,dob:r.dob.date,age:r.dob.age,registered:r.registered.date,streetNum:r.location.street.number,streetName:r.location.street.name,city:r.location.city,state:r.location.state,country:r.location.country,postcode:r.location.postcode,latitude:r.location.coordinates.latitude,longitude:r.location.coordinates.longitude,timezone:r.location.timezone.offset,nationality:r.nat,picture:r.picture.large,transactionId:`TXN-${o}-${s}`,amount:Math.random()*1e4,currency:["USD","EUR","GBP","JPY"][Math.floor(Math.random()*4)],status:["completed","pending","failed"][Math.floor(Math.random()*3)],category:["retail","food","transport","entertainment"][Math.floor(Math.random()*4)],merchant:`Merchant-${Math.floor(Math.random()*100)}`,paymentMethod:["credit","debit","cash","crypto"][Math.floor(Math.random()*4)],score:Math.random()*100,approved:Math.random()>.5,notes:`Transaction note ${s}`,refCode:Math.random().toString(36).substring(7).toUpperCase(),processed:Math.random()>.3,flagged:Math.random()>.9,reviewRequired:Math.random()>.85,region:["NA","EU","APAC","LATAM"][Math.floor(Math.random()*4)]})))}catch(e){return console.error("Error fetching synthetic expansion:",e),[]}})}static \u0275fac=function(t){return new(t||n)(C(Xe),C(nn),C(Je),C(ae))};static \u0275prov=I({token:n,factory:n.\u0275fac,providedIn:"root"})};var Nr=class n{constructor(e,t){this.apiCatalog=e;this.storage=t;let r=this.apiCatalog.getApis(),{globalParams:o,queryParams:i,queryRunFlags:s}=this.hydrateFromStorage();this.stateSubject=new _e({apis:r,lastParams:{},lastRuns:{},globalParams:o,queryParams:i,queryRunFlags:s}),this.state$=this.stateSubject.asObservable()}stateSubject;state$;static STORAGE_KEY_GLOBAL="excel-ext:queries:globalParams";static STORAGE_KEY_QUERY_PARAMS="excel-ext:queries:queryParams";static STORAGE_KEY_RUN_FLAGS="excel-ext:queries:runFlags";get snapshot(){return this.stateSubject.value}getApis(){return this.snapshot.apis}hydrateFromStorage(){let e=this.storage.getItem(n.STORAGE_KEY_GLOBAL,{}),t=this.storage.getItem(n.STORAGE_KEY_QUERY_PARAMS,{}),r=this.storage.getItem(n.STORAGE_KEY_RUN_FLAGS,{});return{globalParams:e,queryParams:t,queryRunFlags:r}}persistSlice(){let{globalParams:e,queryParams:t,queryRunFlags:r}=this.snapshot;this.storage.setItem(n.STORAGE_KEY_GLOBAL,e),this.storage.setItem(n.STORAGE_KEY_QUERY_PARAMS,t),this.storage.setItem(n.STORAGE_KEY_RUN_FLAGS,r)}getGlobalParams(){return this.snapshot.globalParams}setGlobalParams(e){this.stateSubject.next(k(E({},this.snapshot),{globalParams:E({},e)})),this.persistSlice()}getQueryParams(e){return this.snapshot.queryParams[e]}setQueryParams(e,t){let{queryParams:r}=this.snapshot;this.stateSubject.next(k(E({},this.snapshot),{queryParams:k(E({},r),{[e]:E({},t)})})),this.persistSlice()}getQueryRunFlag(e){return this.snapshot.queryRunFlags[e]??!1}setQueryRunFlag(e,t){let{queryRunFlags:r}=this.snapshot;this.stateSubject.next(k(E({},this.snapshot),{queryRunFlags:k(E({},r),{[e]:t})})),this.persistSlice()}getLastParams(e){return this.snapshot.lastParams[e]}setLastParams(e,t){let{lastParams:r}=this.snapshot;this.stateSubject.next(k(E({},this.snapshot),{lastParams:k(E({},r),{[e]:E({},t)})}))}getLastRun(e){return this.snapshot.lastRuns[e]}setLastRun(e,t){let{lastRuns:r}=this.snapshot;this.stateSubject.next(k(E({},this.snapshot),{lastRuns:k(E({},r),{[e]:t})}))}getEffectiveParams(e,t){let r=this.getGlobalParams(),o=this.getQueryParams(e.id),i={},s=(e.parameters??[]).map(a=>a.key);for(let a of s){if(t==="unique"){let c=o?.[a];if(c!=null){i[a]=c;continue}}let l=r[a];l!=null&&(i[a]=l)}return i}static \u0275fac=function(t){return new(t||n)(C(Xe),C(_t))};static \u0275prov=I({token:n,factory:n.\u0275fac,providedIn:"root"})};var da=class n{constructor(e){this.apiCatalog=e}validateConfiguration(e){let t=[];if(e.id||t.push("Configuration missing required field: id"),e.name||t.push("Configuration missing required field: name"),!e.items||e.items.length===0)t.push("Configuration must have at least one item");else for(let r of e.items){let o=this.validateConfigurationItem(r,e.parameterPresets?.perQuery[r.id]);o.valid||t.push(...o.errors.map(i=>`Item ${r.id}: ${i}`))}return{valid:t.length===0,errors:t}}validateConfigurationItem(e,t){let r=[];e.id||r.push("Item missing required field: id"),e.apiId||r.push("Item missing required field: apiId");let o=this.apiCatalog.getApiById(e.apiId);if(!o)return r.push(`API not found in catalog: ${e.apiId}`),{valid:!1,errors:r};if(t&&o.parameters){let i=this.validateParameters(o,t);i.valid||r.push(...i.errors)}return{valid:r.length===0,errors:r}}validateParameters(e,t){let r=[];for(let o of e.parameters)if(o.required){let i=t[o.key];(i==null||i==="")&&r.push(`Missing required parameter: ${o.key} (${o.label||o.key})`)}for(let o of e.parameters){let i=t[o.key];if(i!=null&&i!==""){let s=this.validateParameterType(o,i);s.valid||r.push(...s.errors)}}return{valid:r.length===0,errors:r}}validateParameterType(e,t){let r=[];switch(e.type){case"number":typeof t!="number"&&isNaN(Number(t))&&r.push(`Parameter ${e.key} must be a number, got: ${typeof t} (${t})`);break;case"boolean":typeof t!="boolean"&&t!=="true"&&t!=="false"&&r.push(`Parameter ${e.key} must be a boolean, got: ${typeof t} (${t})`);break;case"date":!(t instanceof Date)&&isNaN(Date.parse(t))&&r.push(`Parameter ${e.key} must be a valid date, got: ${typeof t} (${t})`);break;case"string":break;default:break}return{valid:r.length===0,errors:r}}apiExists(e){return this.apiCatalog.getApiById(e)!==void 0}static \u0275fac=function(t){return new(t||n)(C(Xe))};static \u0275prov=I({token:n,factory:n.\u0275fac,providedIn:"root"})};var fa=class n{constructor(e,t,r,o){this.auth=e;this.apiCatalog=t;this.storage=r;this.validator=o;let i=this.hydrateFromStorage();this.subject.next(i)}subject=new _e([]);configs$=this.subject.asObservable();static STORAGE_KEY_PREFIX="excel-ext:query-configs:";get snapshot(){return this.subject.value}list(){return this.snapshot}get(e){return this.snapshot.find(t=>t.id===e)}save(e){let t=this.validator.validateConfiguration(e);if(!t.valid)throw new Error(`Invalid configuration: ${t.errors.join(", ")}`);let r=this.snapshot,o=r.findIndex(s=>s.id===e.id),i=o===-1?[...r,e]:r.map((s,a)=>a===o?e:s);this.subject.next(i),this.persistToStorage(i)}delete(e){let t=this.snapshot.filter(r=>r.id!==e);this.subject.next(t),this.persistToStorage(t)}softDelete(e){this.delete(e)}storageKey(){let e=this.auth.state.user?.id??"anonymous";return`${n.STORAGE_KEY_PREFIX}${e}:default`}hydrateFromStorage(){let e=this.storage.getItem(this.storageKey(),[]);return Array.isArray(e)?e:[]}persistToStorage(e){this.storage.setItem(this.storageKey(),e)}static \u0275fac=function(t){return new(t||n)(C(he),C(Xe),C(_t),C(da))};static \u0275prov=I({token:n,factory:n.\u0275fac,providedIn:"root"})};var pa=class n{constructor(e){this.telemetry=e}running=!1;progressSubject=new _e({configId:null,total:0,completed:0,currentItemId:null});get isRunning(){return this.running}get progress$(){return this.progressSubject.asObservable()}runBatch(e,t){return v(this,null,function*(){if(!e.items.length)return;if(this.running){this.telemetry.logEvent(this.telemetry.createWorkflowEvent({category:"query",name:"query.queue.rejected",severity:"warn",context:{configId:e.configId}}));return}let{configId:r,items:o,backoffMs:i,maxRowsPerItem:s}=e;this.running=!0,this.progressSubject.next({configId:r,total:o.length,completed:0,currentItemId:null}),this.telemetry.logEvent(this.telemetry.createWorkflowEvent({category:"query",name:"query.queue.enqueued",severity:"info",context:{configId:r,itemIds:o.map(u=>u.id)}})),this.telemetry.logEvent(this.telemetry.createWorkflowEvent({category:"query",name:"query.queue.started",severity:"info",context:{configId:r,itemIds:o.map(u=>u.id)}}));let a=[],l=0;for(let u of o){this.progressSubject.next({configId:r,total:o.length,completed:l,currentItemId:u.id});try{(yield t(u,{maxRowsPerItem:s})).ok||a.push(u.id),l+=1,this.progressSubject.next({configId:r,total:o.length,completed:l,currentItemId:null}),i&&i>0&&(yield new Promise(p=>setTimeout(p,i)))}catch(d){a.push(u.id),l+=1,this.progressSubject.next({configId:r,total:o.length,completed:l,currentItemId:null}),this.telemetry.logEvent(this.telemetry.createWorkflowEvent({category:"query",name:"query.queue.item.error",severity:"error",context:{configId:r,itemId:u.id,apiId:u.apiId,error:d instanceof Error?d.message:String(d)}}))}}let c=a.length>0;this.telemetry.logEvent(this.telemetry.createWorkflowEvent({category:"query",name:c?"query.queue.failed":"query.queue.completed",severity:c?"error":"info",context:{configId:r,itemIds:o.map(u=>u.id),failedItemIds:a}})),this.running=!1,this.progressSubject.next({configId:null,total:0,completed:0,currentItemId:null})})}static \u0275fac=function(t){return new(t||n)(C(ae))};static \u0275prov=I({token:n,factory:n.\u0275fac,providedIn:"root"})};var a_=()=>({field:"id",header:"Id"}),l_=()=>({field:"name",header:"Name"}),c_=()=>({field:"description",header:"Description"}),u_=(n,e,t)=>[n,e,t],d_=()=>({field:"displayName",header:"Display name"}),f_=()=>({field:"apiId",header:"API"}),p_=()=>({field:"targetSheetName",header:"Sheet"}),h_=()=>({field:"targetTableName",header:"Table"}),m_=()=>({field:"writeMode",header:"Write mode"}),g_=(n,e,t,r,o)=>[n,e,t,r,o];function y_(n,e){if(n&1){let t=Pe();h(0,"li")(1,"span"),y(2),g(),h(3,"app-button",26),W("clicked",function(){let o=j(t).$implicit,i=w(2);return B(i.startEdit(o))}),g()()}if(n&2){let t=e.$implicit,r=w(2);Ue("query-actions__item--active",t.id===r.queueCurrentItemId),m(2),Zt("",t.displayName," (",t.apiId,")")}}function v_(n,e){if(n&1&&(h(0,"ul",24),A(1,y_,4,4,"li",25),g()),n&2){let t=w();m(),D("ngForOf",t.selectedItems)}}function E_(n,e){if(n&1){let t=Pe();h(0,"li")(1,"span"),y(2),g(),h(3,"app-button",29),W("clicked",function(){let o=j(t).$implicit,i=w(2);return B(i.loadConfiguration(o.id))}),g(),h(4,"app-button",30),W("clicked",function(){let o=j(t).$implicit,i=w(2);return B(i.startRename(o))}),g(),h(5,"app-button",31),W("clicked",function(){let o=j(t).$implicit,i=w(2);return B(i.deleteConfiguration(o.id))}),g()()}if(n&2){let t=e.$implicit;m(2),Y(" ",t.name," ")}}function D_(n,e){if(n&1&&(h(0,"div",27)(1,"p"),y(2,"Saved configurations:"),g(),h(3,"ul"),A(4,E_,6,1,"li",28),g()()),n&2){let t=w();m(4),D("ngForOf",t.savedConfigs)}}function C_(n,e){n&1&&(h(0,"div",38),y(1," Formulas paused during query execution "),g())}function b_(n,e){if(n&1&&(h(0,"span"),y(1),g()),n&2){let t=w(3);m(),Y(" Columns: ",t.formulaImpactAssessment.affectedColumns.join(", ")," ")}}function __(n,e){if(n&1&&(h(0,"div",39)(1,"strong"),y(2,"Formula Impact:"),g(),y(3),A(4,b_,2,1,"span",22),g()),n&2){let t=w(2);m(3),Zt(" ",t.formulaImpactAssessment.affectedFormulas.length,' formula(s) reference table "',t.formulaImpactAssessment.tableName,'". '),m(),D("ngIf",t.formulaImpactAssessment.affectedColumns.length)}}function w_(n,e){if(n&1){let t=Pe();h(0,"div",32),te(1,"app-progress-indicator",33),A(2,C_,2,0,"div",34)(3,__,5,3,"div",35),h(4,"app-button",36),W("clicked",function(){j(t);let o=w();return B(o.runCurrentConfiguration())}),g(),h(5,"app-button",37),W("clicked",function(){j(t);let o=w();return B(o.exportFormulaDependencies())}),g()()}if(n&2){let t=w();m(),D("total",t.queueTotal)("completed",t.queueCompleted)("currentItemId",t.queueCurrentItemId),m(),D("ngIf",t.formulasDisabled),m(),D("ngIf",t.showImpactWarning&&t.formulaImpactAssessment),m(),D("disabled",t.isRunningConfig||!t.excel.isExcel),m(),D("disabled",!t.excel.isExcel)}}function I_(n,e){n&1&&(h(0,"p"),y(1,"Choose a selected query and click Details to edit."),g())}function S_(n,e){if(n&1){let t=Pe();h(0,"fieldset",45)(1,"legend"),y(2,"Parameters (per configuration)"),g(),h(3,"label"),y(4," Start Date "),h(5,"input",46),re("ngModelChange",function(o){j(t);let i=w(2);return ie(i.editingParameters.StartDate,o)||(i.editingParameters.StartDate=o),B(o)}),g()(),h(6,"label"),y(7," End Date "),h(8,"input",46),re("ngModelChange",function(o){j(t);let i=w(2);return ie(i.editingParameters.EndDate,o)||(i.editingParameters.EndDate=o),B(o)}),g()(),h(9,"label"),y(10," Group "),h(11,"input",6),re("ngModelChange",function(o){j(t);let i=w(2);return ie(i.editingParameters.Group,o)||(i.editingParameters.Group=o),B(o)}),g()(),h(12,"label"),y(13," SubGroup "),h(14,"input",6),re("ngModelChange",function(o){j(t);let i=w(2);return ie(i.editingParameters.SubGroup,o)||(i.editingParameters.SubGroup=o),B(o)}),g()()()}if(n&2){let t=w(2);m(5),ne("ngModel",t.editingParameters.StartDate),m(3),ne("ngModel",t.editingParameters.EndDate),m(3),ne("ngModel",t.editingParameters.Group),m(3),ne("ngModel",t.editingParameters.SubGroup)}}function T_(n,e){if(n&1){let t=Pe();h(0,"div",40)(1,"p")(2,"strong"),y(3,"Editing:"),g(),y(4),g(),h(5,"label"),y(6," Display name "),h(7,"input",6),re("ngModelChange",function(o){j(t);let i=w();return ie(i.editingDisplayName,o)||(i.editingDisplayName=o),B(o)}),g()(),h(8,"label"),y(9," Target sheet name "),h(10,"input",6),re("ngModelChange",function(o){j(t);let i=w();return ie(i.editingTargetSheetName,o)||(i.editingTargetSheetName=o),B(o)}),g()(),h(11,"label"),y(12," Target table name "),h(13,"input",6),re("ngModelChange",function(o){j(t);let i=w();return ie(i.editingTargetTableName,o)||(i.editingTargetTableName=o),B(o)}),g()(),h(14,"label"),y(15," Write mode "),h(16,"select",7),re("ngModelChange",function(o){j(t);let i=w();return ie(i.editingWriteMode,o)||(i.editingWriteMode=o),B(o)}),h(17,"option",8),y(18,"Overwrite"),g(),h(19,"option",9),y(20,"Append"),g()()(),h(21,"label")(22,"input",10),re("ngModelChange",function(o){j(t);let i=w();return ie(i.editingIncludeInBatch,o)||(i.editingIncludeInBatch=o),B(o)}),g(),y(23," Include in batch runs "),g(),A(24,S_,15,4,"fieldset",41),h(25,"div",42)(26,"app-button",43),W("clicked",function(){j(t);let o=w();return B(o.saveEdit())}),g(),h(27,"app-button",44),W("clicked",function(){j(t);let o=w();return B(o.cancelEdit())}),g()()()}if(n&2){let t=w();m(4),Zt(" ",t.editingItem.displayName," (",t.editingItem.apiId,")"),m(3),ne("ngModel",t.editingDisplayName),m(3),ne("ngModel",t.editingTargetSheetName),m(3),ne("ngModel",t.editingTargetTableName),m(3),ne("ngModel",t.editingWriteMode),m(6),ne("ngModel",t.editingIncludeInBatch),m(2),D("ngIf",t.editingItem)}}var ha=class n{constructor(e,t,r,o,i,s,a,l,c,u,d){this.excel=e;this.auth=t;this.api=r;this.apiCatalog=o;this.state=i;this.telemetry=s;this.configs=a;this.queue=l;this.settings=c;this.formulaScanner=u;this.workbook=d;let p=this.auth.roles||[];this.apis=this.apiCatalog.getApisByRole(p),this.addApiItems=this.apis.map(f=>({value:f.id,label:f.name})),this.configs.configs$.pipe(wi(this.destroy$)).subscribe(f=>{this.savedConfigs=f}),this.queue.progress$.pipe(wi(this.destroy$)).subscribe(f=>{this.queueTotal=f.total,this.queueCompleted=f.completed,this.queueCurrentItemId=f.currentItemId}),this.telemetry.logEvent(this.telemetry.createFeatureEvent({category:"ui",name:"queries.feature.loaded",severity:"info",context:{apiCount:this.apis.length}}))}destroy$=new nt;apis=[];selectedItems=[];configName="";savedConfigs=[];selectedConfigId=null;isRenaming=!1;isRunningConfig=!1;addApiItems=[];selectedApiId=null;newDisplayName="";newTargetSheetName="";newTargetTableName="";newWriteMode="overwrite";newIncludeInBatch=!0;editingItem=null;editingDisplayName="";editingTargetSheetName="";editingTargetTableName="";editingWriteMode="overwrite";editingIncludeInBatch=!0;editingParameters={};queueTotal=0;queueCompleted=0;queueCurrentItemId=null;formulasDisabled=!1;previousCalculationMode=null;formulaImpactAssessment=null;showImpactWarning=!1;get debugState(){return{selectedApiId:this.selectedApiId,newDisplayName:this.newDisplayName,newTargetSheetName:this.newTargetSheetName,newTargetTableName:this.newTargetTableName,newWriteMode:this.newWriteMode,newIncludeInBatch:this.newIncludeInBatch,selectedItems:this.selectedItems,configName:this.configName,selectedConfigId:this.selectedConfigId,isRenaming:this.isRenaming,isRunningConfig:this.isRunningConfig,queue:{total:this.queueTotal,completed:this.queueCompleted,currentItemId:this.queueCurrentItemId},formulasDisabled:this.formulasDisabled,formulaImpact:this.formulaImpactAssessment?{hasImpact:this.formulaImpactAssessment.hasImpact,severity:this.formulaImpactAssessment.severity,affectedCount:this.formulaImpactAssessment.affectedFormulas.length}:null}}get canAddSelected(){return!!this.selectedApiId&&!!this.newTargetSheetName&&!!this.newTargetTableName}onSelectedApiChange(e){this.selectedApiId=e;let t=this.apis.find(r=>r.id===e);this.newDisplayName=t?.name??""}startEdit(e){this.editingItem=e,this.editingDisplayName=e.displayName,this.editingTargetSheetName=e.targetSheetName,this.editingTargetTableName=e.targetTableName,this.editingWriteMode=e.writeMode,this.editingIncludeInBatch=e.includeInBatch,this.editingParameters=E({},e.parameters)}cancelEdit(){this.editingItem=null}saveEdit(){if(!this.editingItem){this.telemetry.logEvent(this.telemetry.createWorkflowEvent({category:"query",name:"queryConfig.item.update.blocked.noEditingItem",severity:"warn"}));return}let e=k(E({},this.editingItem),{displayName:this.editingDisplayName||this.editingItem.displayName,targetSheetName:this.editingTargetSheetName,targetTableName:this.editingTargetTableName,writeMode:this.editingWriteMode,includeInBatch:this.editingIncludeInBatch,parameters:E({},this.editingParameters)});this.selectedItems=this.selectedItems.map(t=>t.id===e.id?e:t),this.telemetry.logEvent(this.telemetry.createWorkflowEvent({category:"query",name:"queryConfig.item.updated",severity:"info",context:{apiId:e.apiId,id:e.id}})),this.editingItem=null}addSelected(){if(this.telemetry.logEvent(this.telemetry.createWorkflowEvent({category:"query",name:"queryConfig.addSelected.clicked",severity:"debug",context:{selectedApiId:this.selectedApiId,targetSheetName:this.newTargetSheetName,targetTableName:this.newTargetTableName}})),!this.selectedApiId||!this.newTargetSheetName||!this.newTargetTableName){this.telemetry.logEvent(this.telemetry.createWorkflowEvent({category:"query",name:"queryConfig.addSelected.blocked.missingFields",severity:"warn",context:{hasSelectedApiId:!!this.selectedApiId,hasTargetSheetName:!!this.newTargetSheetName,hasTargetTableName:!!this.newTargetTableName}}));return}let t={id:`${this.selectedApiId}-${Date.now()}`,apiId:this.selectedApiId,displayName:this.newDisplayName||this.selectedApiId,parameters:{},targetSheetName:this.newTargetSheetName,targetTableName:this.newTargetTableName,writeMode:this.newWriteMode,includeInBatch:this.newIncludeInBatch};this.selectedItems=[...this.selectedItems,t],this.telemetry.logEvent(this.telemetry.createWorkflowEvent({category:"query",name:"queryConfig.item.created",severity:"info",context:{apiId:t.apiId,id:t.id}})),this.resetNewForm()}resetNewForm(){this.selectedApiId=null,this.newDisplayName="",this.newTargetSheetName="",this.newTargetTableName="",this.newWriteMode="overwrite",this.newIncludeInBatch=!0}saveCurrentConfiguration(){if(this.telemetry.logEvent(this.telemetry.createWorkflowEvent({category:"query",name:"queryConfig.save.clicked",severity:"debug",context:{selectedConfigId:this.selectedConfigId,itemCount:this.selectedItems.length,isRenaming:this.isRenaming}})),!this.selectedItems.length){this.telemetry.logEvent(this.telemetry.createWorkflowEvent({category:"query",name:"queryConfig.save.blocked.noItems",severity:"warn",context:{selectedConfigId:this.selectedConfigId}}));return}let e=this.selectedConfigId??`config-${Date.now()}`,t=(this.configName||"Untitled configuration").trim(),r={id:e,name:t,items:this.selectedItems.map(i=>E({},i)),parameterPresets:{global:this.state.getGlobalParams(),perQuery:E({},this.state.snapshot.queryParams)}};this.configs.save(r),this.selectedConfigId=e;let o=this.savedConfigs.some(i=>i.id===e);this.telemetry.logEvent(this.telemetry.createWorkflowEvent({category:"query",name:o?"queryConfig.saved.overwrite":"queryConfig.saved",severity:o?"warn":"info",context:{configId:e,name:t,itemCount:this.selectedItems.length,overwrite:o}}))}loadConfiguration(e){let t=this.configs.get(e);t&&(this.selectedConfigId=e,this.configName=t.name,this.selectedItems=t.items.map(r=>E({},r)),this.telemetry.logEvent(this.telemetry.createWorkflowEvent({category:"query",name:"queryConfig.loaded",severity:"info",context:{configId:e,name:t.name,itemCount:t.items.length}})))}startRename(e){this.selectedConfigId=e.id,this.configName=e.name,this.isRenaming=!0,this.telemetry.logEvent(this.telemetry.createWorkflowEvent({category:"query",name:"queryConfig.rename.started",severity:"debug",context:{configId:e.id,name:e.name}}))}newConfigurationFromCurrent(){this.selectedConfigId=null,this.isRenaming=!1,this.telemetry.logEvent(this.telemetry.createWorkflowEvent({category:"query",name:"queryConfig.saveAsNew.clicked",severity:"debug",context:{itemCount:this.selectedItems.length}})),this.saveCurrentConfiguration()}deleteConfiguration(e){this.configs.softDelete(e),this.selectedConfigId===e&&(this.selectedConfigId=null),this.telemetry.logEvent(this.telemetry.createWorkflowEvent({category:"query",name:"queryConfig.deleted",severity:"info",context:{configId:e}}))}runCurrentConfiguration(){return v(this,null,function*(){let e=this.selectedConfigId??"unsaved";if(!this.excel.isExcel){this.telemetry.logEvent(this.telemetry.createWorkflowEvent({category:"query",name:"queryConfig.run.blocked.notInExcel",severity:"warn",context:{configId:e,excelDetected:this.excel.isExcel}}));return}if(this.telemetry.logEvent(this.telemetry.createWorkflowEvent({category:"query",name:"queryConfig.run.clicked",severity:"debug",context:{configId:e,itemIds:this.selectedItems.map(o=>o.id)}})),!this.selectedItems.length){this.telemetry.logEvent(this.telemetry.createWorkflowEvent({category:"query",name:"queryConfig.run.blocked.noItems",severity:"warn",context:{configId:e}}));return}this.isRunningConfig=!0,this.showImpactWarning=!1,this.formulaImpactAssessment=null;let t=[...new Set(this.selectedItems.map(o=>o.targetTableName))];for(let o of t){let i=yield this.formulaScanner.checkQueryImpact(e,o);if(i.ok&&i.value&&i.value.hasImpact){this.formulaImpactAssessment=i.value,this.showImpactWarning=!0;break}}if(this.settings.value.queryExecution?.disableFormulasDuringRun??!0){let o=yield this.excel.setCalculationMode("Manual");o.ok&&o.value&&(this.previousCalculationMode=o.value.previousMode,this.formulasDisabled=!0,this.telemetry.logEvent({category:"excel",name:"formulas.disabled",severity:"info",context:{configId:e,previousMode:this.previousCalculationMode}}))}this.telemetry.logEvent(this.telemetry.createWorkflowEvent({category:"query",name:"queryConfig.run.requested",severity:"info",context:{configId:e,itemIds:this.selectedItems.map(o=>o.id),formulasDisabled:this.formulasDisabled}}));try{yield this.queue.runBatch({configId:e,items:this.selectedItems,backoffMs:50},o=>v(this,null,function*(){let i=this.apis.find(a=>a.id===o.apiId);if(!i)return{ok:!1,rowCount:0};let s=E({},o.parameters);try{let a=yield this.api.executeApi(i.id,s),l={sheetName:o.targetSheetName,tableName:o.targetTableName},u=(yield this.workbook.resolveTableTarget(i.id,l))??l,d=yield this.excel.upsertQueryTable(i.id,u,a),p=d.ok;return p&&d.value&&this.state.setLastRun(i.id,{queryId:i.id,completedAt:new Date,rowCount:a.length,location:d.value}),{ok:p,rowCount:a.length}}catch{return{ok:!1,rowCount:0}}}))}finally{if(this.formulasDisabled&&this.previousCalculationMode){let o=this.previousCalculationMode==="Manual"?"Manual":"Automatic";yield this.excel.setCalculationMode(o),this.telemetry.logEvent({category:"excel",name:"formulas.restored",severity:"info",context:{configId:e,restoredMode:o}}),this.formulasDisabled=!1,this.previousCalculationMode=null}this.isRunningConfig=!1}})}exportFormulaDependencies(){return v(this,null,function*(){this.telemetry.logEvent({category:"formula",name:"exportDependencies.clicked",severity:"debug"});let e=yield this.formulaScanner.scanWorkbook();if(!e.ok||!e.value){this.telemetry.logEvent({category:"formula",name:"exportDependencies.failed",severity:"warn",context:{error:e.error?.message}});return}let t=this.formulaScanner.generateReportCsv(e.value.dependencies),r=new Blob([t],{type:"text/csv;charset=utf-8;"}),o=URL.createObjectURL(r),i=document.createElement("a");i.href=o,i.download=`formula-dependencies-${new Date().toISOString().slice(0,10)}.csv`,i.click(),URL.revokeObjectURL(o),this.telemetry.logEvent({category:"formula",name:"exportDependencies.completed",severity:"info",context:{dependencyCount:e.value.dependencies.length,sheetsScanned:e.value.sheetsScanned}})})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(t){return new(t||n)(_(je),_(he),_(ua),_(Xe),_(Nr),_(ae),_(fa),_(pa),_(Je),_(ma),_(wt))};static \u0275cmp=Q({type:n,selectors:[["app-queries"]],decls:45,vars:42,consts:[[1,"queries-debug-state"],["title","API Catalog","subtitle","Choose an API and define per-workbook selected queries.","variant","dense"],["emptyMessage","No APIs available.",3,"columns","rows"],["title","Add selected query for this workbook","subtitle","Bind an API to a target sheet/table and write mode.","variant","dense"],[1,"query-add-form"],["placeholder","Choose API",3,"valueChange","items","value"],["type","text",3,"ngModelChange","ngModel"],[3,"ngModelChange","ngModel"],["value","overwrite"],["value","append"],["type","checkbox",3,"ngModelChange","ngModel"],["label","Add selected",3,"clicked","disabled"],["title","Selected queries for this workbook","subtitle","These configurations will be used for future runs.","variant","dense"],["emptyMessage","No selected queries yet.",3,"columns","rows"],["class","query-actions",4,"ngIf"],["title","Named configurations","subtitle","Save and reuse sets of selected queries for a workbook.","variant","dense"],[1,"query-config-save"],[3,"clicked","label","disabled"],["label","Save as new configuration","variant","secondary","size","sm",3,"clicked","disabled"],["class","query-config-list",4,"ngIf"],["class","query-config-run",4,"ngIf"],["title","Selected query details","subtitle","Edit configuration for a single selected query.","variant","dense"],[4,"ngIf"],["class","query-edit-form",4,"ngIf"],[1,"query-actions"],[3,"query-actions__item--active",4,"ngFor","ngForOf"],["label","Details","variant","secondary","size","sm",3,"clicked"],[1,"query-config-list"],[4,"ngFor","ngForOf"],["label","Load","variant","secondary","size","sm",3,"clicked"],["label","Rename","variant","secondary","size","sm",3,"clicked"],["label","Delete","variant","secondary","size","sm",3,"clicked"],[1,"query-config-run"],[3,"total","completed","currentItemId"],["class","formula-status formula-status--disabled",4,"ngIf"],["class","formula-warning formula-warning--impact",4,"ngIf"],["label","Run configuration",3,"clicked","disabled"],["label","Export formula report","variant","secondary","size","sm",3,"clicked","disabled"],[1,"formula-status","formula-status--disabled"],[1,"formula-warning","formula-warning--impact"],[1,"query-edit-form"],["class","query-edit-params",4,"ngIf"],[1,"query-edit-actions"],["label","Save",3,"clicked"],["label","Cancel","variant","secondary","size","sm",3,"clicked"],[1,"query-edit-params"],["type","date",3,"ngModelChange","ngModel"]],template:function(t,r){t&1&&(h(0,"pre",0),y(1),kn(2,"json"),g(),h(3,"app-section",1),te(4,"app-table",2),g(),h(5,"app-section",3)(6,"div",4)(7,"label"),y(8," API "),h(9,"app-dropdown",5),W("valueChange",function(i){return r.onSelectedApiChange(i)}),g()(),h(10,"label"),y(11," Display name "),h(12,"input",6),re("ngModelChange",function(i){return ie(r.newDisplayName,i)||(r.newDisplayName=i),i}),g()(),h(13,"label"),y(14," Target sheet name "),h(15,"input",6),re("ngModelChange",function(i){return ie(r.newTargetSheetName,i)||(r.newTargetSheetName=i),i}),g()(),h(16,"label"),y(17," Target table name "),h(18,"input",6),re("ngModelChange",function(i){return ie(r.newTargetTableName,i)||(r.newTargetTableName=i),i}),g()(),h(19,"label"),y(20," Write mode "),h(21,"select",7),re("ngModelChange",function(i){return ie(r.newWriteMode,i)||(r.newWriteMode=i),i}),h(22,"option",8),y(23,"Overwrite"),g(),h(24,"option",9),y(25,"Append"),g()()(),h(26,"label")(27,"input",10),re("ngModelChange",function(i){return ie(r.newIncludeInBatch,i)||(r.newIncludeInBatch=i),i}),g(),y(28," Include in batch runs "),g(),h(29,"app-button",11),W("clicked",function(){return r.addSelected()}),g()()(),h(30,"app-section",12),te(31,"app-table",13),A(32,v_,2,1,"ul",14),g(),h(33,"app-section",15)(34,"div",16)(35,"label"),y(36," Configuration name "),h(37,"input",6),re("ngModelChange",function(i){return ie(r.configName,i)||(r.configName=i),i}),g()(),h(38,"app-button",17),W("clicked",function(){return r.saveCurrentConfiguration()}),g(),h(39,"app-button",18),W("clicked",function(){return r.newConfigurationFromCurrent()}),g()(),A(40,D_,5,1,"div",19)(41,w_,6,7,"div",20),g(),h(42,"app-section",21),A(43,I_,2,0,"p",22)(44,T_,28,8,"div",23),g()),t&2&&(m(),Z(On(2,22,r.debugState)),m(3),D("columns",Yc(27,u_,ue(24,a_),ue(25,l_),ue(26,c_)))("rows",r.apis),m(5),D("items",r.addApiItems)("value",r.selectedApiId),m(3),ne("ngModel",r.newDisplayName),m(3),ne("ngModel",r.newTargetSheetName),m(3),ne("ngModel",r.newTargetTableName),m(3),ne("ngModel",r.newWriteMode),m(6),ne("ngModel",r.newIncludeInBatch),m(2),D("disabled",!r.canAddSelected),m(2),D("columns",Jc(36,g_,ue(31,d_),ue(32,f_),ue(33,p_),ue(34,h_),ue(35,m_)))("rows",r.selectedItems),m(),D("ngIf",r.selectedItems.length),m(5),ne("ngModel",r.configName),m(),D("label",r.isRenaming?"Rename configuration":"Save configuration")("disabled",!r.selectedItems.length),m(),D("disabled",!r.selectedItems.length),m(),D("ngIf",r.savedConfigs.length),m(),D("ngIf",r.selectedItems.length),m(2),D("ngIf",!r.editingItem),m(),D("ngIf",r.editingItem))},dependencies:[G,Ct,ee,en,wr,Ir,br,Iu,Xt,_r,Ln,Ke,tn,Xs,Sr,ea,Co],styles:[".query-actions__item--active[_ngcontent-%COMP%]{background-color:#eff6ff}.formula-status[_ngcontent-%COMP%]{font-size:.75rem;padding:.375rem .5rem;border-radius:4px;margin:.5rem 0}.formula-status--disabled[_ngcontent-%COMP%]{background-color:#ed6c021a;color:var(--warning-color, #ed6c02);border:1px solid rgba(237,108,2,.3)}.formula-warning[_ngcontent-%COMP%]{font-size:.75rem;padding:.5rem .75rem;border-radius:4px;margin:.5rem 0;line-height:1.4}.formula-warning--impact[_ngcontent-%COMP%]{background-color:#0288d11a;color:var(--info-color, #0288d1);border:1px solid rgba(2,136,209,.3)}.formula-warning--impact[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:600}"]})};var ga=class n{constructor(e,t,r,o){this.appContext=e;this.auth=t;this.queries=r;this.workbook=o}static \u0275fac=function(t){return new(t||n)(_(rn),_(he),_(Nr),_(wt))};static \u0275cmp=Q({type:n,selectors:[["app-debug-context"]],decls:22,vars:10,template:function(t,r){t&1&&($(0,"section")(1,"h2"),y(2,"Debug / Context State"),q(),$(3,"h3"),y(4,"Host"),q(),$(5,"pre"),y(6),kn(7,"json"),q(),$(8,"h3"),y(9,"Auth"),q(),$(10,"pre"),y(11),kn(12,"json"),q(),$(13,"h3"),y(14,"APIs"),q(),$(15,"pre"),y(16),kn(17,"json"),q(),$(18,"h3"),y(19,"Workbook (isExcel)"),q(),$(20,"pre"),y(21),q()()),t&2&&(m(6),Z(On(7,4,r.appContext.hostStatus)),m(5),Z(On(12,6,r.auth)),m(5),Z(On(17,8,r.queries.getApis())),m(5),Z(r.workbook.isExcel))},dependencies:[G,Co],encapsulation:2})};var Om=new R("Window",{providedIn:"root",factory:()=>window});var ya=class n{constructor(e,t,r){this.storage=e;this.telemetry=t;this.window=r}BACKUP_VERSION="1.0.0";exportBackup(){return v(this,null,function*(){try{let e={version:this.BACKUP_VERSION,timestamp:new Date().toISOString(),authState:this.storage.getItem("auth-state",null),settings:this.storage.getItem("settings",null),queryConfigs:this.getQueryConfigs(),queryState:this.storage.getItem("query-state",null)},t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),r=URL.createObjectURL(t),o=document.createElement("a");o.href=r,o.download=`excel-extension-backup-${Date.now()}.json`,o.click(),URL.revokeObjectURL(r),this.telemetry.logEvent({category:"system",name:"backup-export-success",severity:"info",message:"Backup exported successfully",context:{timestamp:e.timestamp}})}catch(e){throw this.telemetry.logEvent({category:"system",name:"backup-export-error",severity:"error",message:"Failed to export backup",context:{error:e}}),new Error("Failed to export backup. See console for details.")}})}importBackup(e){return v(this,null,function*(){try{let t=yield e.text(),r=JSON.parse(t),o=this.validateBackupStructure(r);if(o)throw new Error(o);let i=r;if(!this.isCompatibleVersion(i.version))throw new Error(`Incompatible backup version: ${i.version}. Current app version: ${this.BACKUP_VERSION}. Cannot import backup from different major version.`);i.authState&&this.storage.setItem("auth-state",i.authState),i.settings&&this.storage.setItem("settings",i.settings),i.queryConfigs&&this.restoreQueryConfigs(i.queryConfigs),i.queryState&&this.storage.setItem("query-state",i.queryState),this.telemetry.logEvent({category:"system",name:"backup-import-success",severity:"info",message:"Backup restored successfully",context:{backupVersion:i.version,backupTimestamp:i.timestamp}}),this.window.location.reload()}catch(t){throw this.telemetry.logEvent({category:"system",name:"backup-import-error",severity:"error",message:"Failed to import backup",context:{error:t}}),t instanceof Error?t:new Error("Failed to import backup. Invalid file format or version.")}})}validateBackupStructure(e){if(!e||typeof e!="object")return"Invalid backup: not an object";let t=e;return typeof t.version!="string"||!t.version?"Invalid backup: missing or invalid version":typeof t.timestamp!="string"||!t.timestamp?"Invalid backup: missing or invalid timestamp":t.queryConfigs!==void 0&&!Array.isArray(t.queryConfigs)?"Invalid backup: queryConfigs must be an array":null}isCompatibleVersion(e){let[t]=e.split("."),[r]=this.BACKUP_VERSION.split(".");return t===r}getQueryConfigs(){let e=[],t="excel-ext:query-configs:";for(let r=0;r<localStorage.length;r++){let o=localStorage.key(r);if(o&&o.startsWith(t)){let i=this.storage.getItem(o,null);i&&e.push({key:o,value:i})}}return e}restoreQueryConfigs(e){for(let t of e)t.key&&t.value&&this.storage.setItem(t.key,t.value)}static \u0275fac=function(t){return new(t||n)(C(_t),C(ae),C(Om))};static \u0275prov=I({token:n,factory:n.\u0275fac,providedIn:"root"})};var va=class n{constructor(e,t,r,o){this.settings=e;this.excel=t;this.telemetry=r;this.backupRestore=o}onTelemetryWorkbookLoggingChange(e){let t=this.settings.value.telemetry;this.settings.update({telemetry:k(E({},t),{enableWorkbookLogging:e})}),this.telemetry.logEvent(this.telemetry.createFeatureEvent({category:"settings",name:"telemetry.workbookLogging.toggled",severity:"info",context:{enabled:e}}))}onTelemetryConsoleLoggingChange(e){let t=this.settings.value.telemetry;this.settings.update({telemetry:k(E({},t),{enableConsoleLogging:e})}),this.telemetry.logEvent(this.telemetry.createFeatureEvent({category:"settings",name:"telemetry.consoleLogging.toggled",severity:"info",context:{enabled:e}}))}onMaxRowsChange(e){let t=parseInt(e,10);isNaN(t)||t<100||(this.settings.update({queryExecution:{maxRowsPerQuery:t}}),this.telemetry.logEvent(this.telemetry.createFeatureEvent({category:"settings",name:"queryExecution.maxRows.changed",severity:"info",context:{maxRows:t}})))}onChunkSizeChange(e){let t=parseInt(e,10);isNaN(t)||t<100||(this.settings.update({queryExecution:{chunkSize:t}}),this.telemetry.logEvent(this.telemetry.createFeatureEvent({category:"settings",name:"queryExecution.chunkSize.changed",severity:"info",context:{chunkSize:t}})))}onProgressiveLoadingChange(e){this.settings.update({queryExecution:{enableProgressiveLoading:e}}),this.telemetry.logEvent(this.telemetry.createFeatureEvent({category:"settings",name:"queryExecution.progressiveLoading.toggled",severity:"info",context:{enabled:e}}))}resetManagedTables(){return v(this,null,function*(){this.excel.isExcel&&(yield this.excel.purgeExtensionManagedContent())})}exportBackup(){this.backupRestore.exportBackup(),this.telemetry.logEvent(this.telemetry.createFeatureEvent({category:"settings",name:"backup.exported",severity:"info",context:{}}))}onFileSelected(e){return v(this,null,function*(){let t=e.target;if(!t.files||t.files.length===0)return;let r=t.files[0];try{yield this.backupRestore.importBackup(r),this.telemetry.logEvent(this.telemetry.createFeatureEvent({category:"settings",name:"backup.imported",severity:"info",context:{fileName:r.name}}))}catch(o){this.telemetry.logEvent(this.telemetry.createFeatureEvent({category:"settings",name:"backup.import.failed",severity:"error",context:{error:o instanceof Error?o.message:String(o)}}))}t.value=""})}static \u0275fac=function(t){return new(t||n)(_(Je),_(je),_(ae),_(ya))};static \u0275cmp=Q({type:n,selectors:[["app-settings"]],decls:44,vars:5,consts:[["fileInput",""],[1,"tables-toolbar"],["type","button",3,"click"],["type","file","accept",".json",2,"display","none",3,"change"],[2,"font-size","0.9em","color","#666","margin-bottom","1em"],["type","number","min","100","max","100000","step","1000",2,"width","100px","margin-left","8px",3,"change","value"],[2,"display","block","margin-top","4px","color","#666"],["type","number","min","100","max","5000","step","100",2,"width","100px","margin-left","8px",3,"change","value"],["type","checkbox",3,"change","checked"],[2,"display","block","margin-top","4px","margin-left","24px","color","#666"]],template:function(t,r){if(t&1){let o=Pe();$(0,"section")(1,"h2"),y(2,"Settings"),q(),$(3,"h3"),y(4,"Backup & Restore"),q(),$(5,"div",1)(6,"button",2),Ye("click",function(){return j(o),B(r.exportBackup())}),y(7," Export Backup "),q(),$(8,"button",2),Ye("click",function(){j(o);let s=Se(11);return B(s.click())}),y(9," Import Backup "),q(),$(10,"input",3,0),Ye("change",function(s){return j(o),B(r.onFileSelected(s))}),q()(),$(12,"h3"),y(13,"Query Execution"),q(),$(14,"p",4),y(15," Configure performance settings for large datasets. Changes take effect on next query run. "),q(),$(16,"label"),y(17," Max rows per query: "),$(18,"input",5),Ye("change",function(s){return j(o),B(r.onMaxRowsChange(s.target.value))}),q(),$(19,"small",6),y(20," Limits result size to prevent Excel crashes (default: 10,000) "),q()(),$(21,"label"),y(22," Chunk size (Excel writes): "),$(23,"input",7),Ye("change",function(s){return j(o),B(r.onChunkSizeChange(s.target.value))}),q(),$(24,"small",6),y(25," Rows per batch when writing to Excel (default: 1,000) "),q()(),$(26,"label")(27,"input",8),Ye("change",function(s){return j(o),B(r.onProgressiveLoadingChange(s.target.checked))}),q(),y(28," Enable progressive loading "),$(29,"small",9),y(30," Show first chunk immediately, queue rest (default: on) "),q()(),$(31,"h3"),y(32,"Telemetry"),q(),$(33,"label")(34,"input",8),Ye("change",function(s){return j(o),B(r.onTelemetryWorkbookLoggingChange(s.target.checked))}),q(),y(35," Enable in-workbook telemetry log table "),q(),$(36,"label")(37,"input",8),Ye("change",function(s){return j(o),B(r.onTelemetryConsoleLoggingChange(s.target.checked))}),q(),y(38," Enable console telemetry logging "),q(),$(39,"h3"),y(40,"Developer Tools"),q(),$(41,"div",1)(42,"button",2),Ye("click",function(){return j(o),B(r.resetManagedTables())}),y(43," Reset extension-managed tables (dev) "),q()()()}t&2&&(m(18),Qt("value",(r.settings.value.queryExecution==null?null:r.settings.value.queryExecution.maxRowsPerQuery)??1e4),m(5),Qt("value",(r.settings.value.queryExecution==null?null:r.settings.value.queryExecution.chunkSize)??1e3),m(4),Qt("checked",(r.settings.value.queryExecution==null?null:r.settings.value.queryExecution.enableProgressiveLoading)??!0),m(7),Qt("checked",r.settings.value.telemetry.enableWorkbookLogging),m(3),Qt("checked",r.settings.value.telemetry.enableConsoleLogging))},dependencies:[G],encapsulation:2})};var x_=()=>["analyst","admin"],N_=n=>({"is-active":n});function A_(n,e){if(n&1){let t=Pe();h(0,"app-button",7),W("clicked",function(){let o=j(t).$implicit,i=w();return B(i.handleNavClick(o))}),g()}if(n&2){let t=e.$implicit,r=w();D("label",r.getNavLabel(t.labelKey))("variant",t.buttonVariant||(r.appConfig.ui==null?null:r.appConfig.ui.navButtonVariant)||"primary")("size",t.buttonSize||(r.appConfig.ui==null?null:r.appConfig.ui.navButtonSize)||"md")("disabled",!r.canAccessNav(t))("ngClass",yo(7,N_,t.viewId&&r.currentView===t.viewId)),yt("id",t.domId||null)("aria-current",t.viewId&&r.currentView===t.viewId?"page":null)}}function R_(n,e){if(n&1&&(h(0,"section",8)(1,"span",9),y(2),g(),h(3,"span",10),y(4),g()()),n&2){let t=e.ngIf,r=w();Rn(r.appConfig.rootIdsAndClasses.userBannerClass),m(2),Z(t),m(2),Y(" ",r.authSummary.roles.length?r.authSummary.roles.join(", "):r.text.userBanner==null?null:r.text.userBanner.noRolesAssigned," ")}}function k_(n,e){if(n&1&&(vt(0),h(1,"span",14),y(2),g(),h(3,"span",16),y(4),g(),Et()),n&2){let t=w(2);m(2),Z(t.text.hostStatus==null?null:t.text.hostStatus.excelNotDetectedLabel),m(2),Y(" ",t.text.hostStatus==null?null:t.text.hostStatus.excelNotDetectedMessage," ")}}function O_(n,e){if(n&1&&(h(0,"span",14),y(1),g()),n&2){let t=w(2);m(),Z(t.text.hostStatus==null?null:t.text.hostStatus.excelConnectedLabel)}}function P_(n,e){if(n&1&&(h(0,"span",16),y(1),g()),n&2){let t=w(2);m(),Y(" ",t.text.hostStatus==null?null:t.text.hostStatus.offlineMessage," ")}}function F_(n,e){if(n&1&&(h(0,"section",11),A(1,k_,5,2,"ng-container",12)(2,O_,2,1,"ng-template",null,0,Fe),h(4,"span",13),y(5,"\u2022"),g(),h(6,"span",14),y(7),g(),A(8,P_,2,1,"span",15),g()),n&2){let t=Se(3),r=w();Rn(r.appConfig.rootIdsAndClasses.hostStatusClass),m(),D("ngIf",!r.hostStatus.isExcel)("ngIfElse",t),m(5),Ue("host-status-offline",!r.hostStatus.isOnline),m(),Y(" ",r.hostStatus.isOnline?r.text.hostStatus==null?null:r.text.hostStatus.onlineLabel:r.text.hostStatus==null?null:r.text.hostStatus.offlineLabel," "),m(),D("ngIf",!r.hostStatus.isOnline)}}function L_(n,e){n&1&&te(0,"app-sso-home")}function V_(n,e){n&1&&te(0,"app-worksheets")}function j_(n,e){n&1&&te(0,"app-tables")}function B_(n,e){n&1&&te(0,"app-user")}function H_(n,e){n&1&&te(0,"app-queries")}function U_(n,e){n&1&&te(0,"app-debug-context")}function $_(n,e){n&1&&te(0,"app-settings")}var Ea=class n{constructor(e,t,r,o,i){this.excel=e;this.auth=t;this.appContext=r;this.appConfigService=o;this.indexedDB=i;this.hostStatus=this.appContext.hostStatus,this.currentView=this.appConfigService.getConfig().defaultViewId}currentView;hostStatus;get appConfig(){return this.appConfigService.getConfig()}get text(){let e={nav:{},auth:{},query:{},worksheet:{},table:{},user:{},hostStatus:{},userBanner:{},ui:{}};return this.appConfigService.getConfig().text||e}get authSummary(){return this.appContext.getAuthSummary()}ngOnInit(){return v(this,null,function*(){yield this.indexedDB.clearExpiredCache()})}selectView(e){this.currentView=e}handleNavClick(e){switch(e.actionType){case"select-view":{e.viewId&&this.selectView(e.viewId);break}case"sign-in-analyst":{this.signInAnalyst();break}case"sign-in-admin":{this.signInAdmin();break}case"sign-out":{this.signOut();break}}}isNavVisible(e){if(this.auth.isAuthenticated){if(e.actionType==="sign-in-analyst"||e.actionType==="sign-in-admin")return!1}else if(e.actionType==="sign-out")return!1;return e.requiresAuth&&!this.auth.isAuthenticated?!1:e.requiredRoles&&e.requiredRoles.length>0?this.auth.hasAnyRole(e.requiredRoles):!0}canAccessNav(e){return this.isNavVisible(e)}getNavLabel(e){let[t,r]=e.split(".");if(t&&r){let o=this.text[t];if(o&&typeof o=="object")return o[r]||e}return e}signInAnalyst(){return v(this,null,function*(){yield this.auth.signInAsAnalyst(),this.currentView="sso"})}signInAdmin(){return v(this,null,function*(){yield this.auth.signInAsAdmin(),this.currentView="sso"})}signIn(){return v(this,null,function*(){yield this.auth.signIn(),this.currentView="sso"})}signOut(){this.auth.signOut(),this.currentView="sso"}title="excel-extension";static \u0275fac=function(t){return new(t||n)(_(je),_(he),_(rn),_(xr),_(nn))};static \u0275cmp=Q({type:n,selectors:[["app-root"]],decls:12,vars:13,consts:[["excelOk",""],["role","navigation","aria-label","Main navigation"],[3,"label","variant","size","disabled","ngClass","clicked",4,"ngFor","ngForOf"],["role","region","aria-label","User information",3,"class",4,"ngIf"],["role","status","aria-live","polite","aria-label","Application status",3,"class",4,"ngIf"],["role","main","aria-label","Main content",1,"content"],[4,"ngIf"],[3,"clicked","label","variant","size","disabled","ngClass"],["role","region","aria-label","User information"],[1,"user-banner-name"],[1,"user-banner-role"],["role","status","aria-live","polite","aria-label","Application status"],[4,"ngIf","ngIfElse"],["aria-hidden","true",1,"host-status-separator"],[1,"host-status-label"],["class","host-status-message",4,"ngIf"],[1,"host-status-message"]],template:function(t,r){t&1&&(h(0,"nav",1),A(1,A_,1,9,"app-button",2),g(),A(2,R_,5,4,"section",3)(3,F_,9,8,"section",4),h(4,"main",5),A(5,L_,1,0,"app-sso-home",6)(6,V_,1,0,"app-worksheets",6)(7,j_,1,0,"app-tables",6)(8,B_,1,0,"app-user",6)(9,H_,1,0,"app-queries",6)(10,U_,1,0,"app-debug-context",6)(11,$_,1,0,"app-settings",6),g()),t&2&&(Rn(r.appConfig.rootIdsAndClasses.navClass),m(),D("ngForOf",r.appConfig.navItems),m(),D("ngIf",r.authSummary.isAuthenticated&&r.authSummary.displayName),m(),D("ngIf",!r.hostStatus.isExcel||!r.hostStatus.isOnline),m(2),D("ngIf",r.currentView==="sso"),m(),D("ngIf",r.currentView==="worksheets"&&r.authSummary.isAuthenticated),m(),D("ngIf",r.currentView==="tables"&&r.authSummary.isAuthenticated),m(),D("ngIf",r.currentView==="user"&&r.authSummary.isAuthenticated),m(),D("ngIf",r.currentView==="queries"&&r.authSummary.isAuthenticated&&r.auth.hasAnyRole(ue(12,x_))),m(),D("ngIf",r.currentView==="debug"&&r.authSummary.isAuthenticated&&r.auth.hasRole("admin")),m(),D("ngIf",r.currentView==="settings"&&r.authSummary.isAuthenticated))},dependencies:[G,Do,Ct,ee,en,Sr,ta,sa,aa,la,ha,ga,va],styles:[".mobile-nav[_ngcontent-%COMP%]{display:flex;gap:1rem;background:#333;padding:.5rem}.mobile-nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff;text-decoration:none}.mobile-nav[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{text-decoration:underline}.status[_ngcontent-%COMP%]{margin-left:auto;color:#ccc}.user-banner[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.5rem 1rem;background:#f5f5f5;border-bottom:1px solid #ddd;font-size:.9rem}.user-banner-name[_ngcontent-%COMP%]{font-weight:600}.user-banner-role[_ngcontent-%COMP%]{color:#666}.host-status[_ngcontent-%COMP%]{position:fixed;left:0;right:0;bottom:0;display:flex;flex-wrap:wrap;align-items:center;gap:.25rem;padding:.5rem 1rem;background:#fff7e6;border-top:1px solid #f0d9a7;font-size:.85rem;z-index:10}.host-status-label[_ngcontent-%COMP%]{font-weight:500}.host-status-message[_ngcontent-%COMP%]{color:#665200}.host-status-separator[_ngcontent-%COMP%]{color:#aa8a2c}.host-status-offline[_ngcontent-%COMP%]{color:#b3261e}@media (max-width: 600px){.mobile-nav[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}}"]})};var Pm={providers:[tu({eventCoalescing:!0}),bu()]};var ma=class n{constructor(e,t){this.excel=e;this.telemetry=t}cachedScan=null;CACHE_TTL_MS=300*1e3;STRUCTURED_REF_REGEX=/([A-Za-z_][A-Za-z0-9_]*)\[(@?\[?#?[A-Za-z_][A-Za-z0-9_ ]*\]?)\]/g;scanWorkbook(e=!1){return v(this,null,function*(){if(!this.excel.isExcel)return{ok:!1,error:{operation:"scanWorkbook",message:"Excel is not available in the current host."}};if(!e&&this.cachedScan){let t=Date.now()-this.cachedScan.timestamp;if(t<this.CACHE_TTL_MS)return this.telemetry.logEvent({category:"formula",name:"scanWorkbook:cache-hit",severity:"debug",context:{cacheAgeMs:t}}),{ok:!0,value:this.cachedScan.result}}try{let t=yield Excel.run(r=>v(this,null,function*(){let o=[],i=0,s=0,a=r.workbook.worksheets;a.load("items/name"),yield r.sync();for(let c of a.items){if(c.name.startsWith("_Extension"))continue;i++;let u=c.getUsedRangeOrNullObject();if(yield r.sync(),u.isNullObject)continue;u.load("formulas,address,rowCount,columnCount"),yield r.sync();let d=u.formulas;if(!d||d.length===0)continue;let p=u.address.split("!")[1]||"A1",f=this.columnLetterToIndex(p.replace(/[0-9]/g,"")),b=parseInt(p.replace(/[A-Za-z]/g,""),10);for(let x=0;x<d.length;x++)for(let S=0;S<d[x].length;S++){let T=d[x][S];if(typeof T!="string"||!T.startsWith("="))continue;s++;let me=this.parseTableColumnReferences(T);for(let et of me)o.push({sheetName:c.name,cellAddress:this.indexToAddress(f+S,b+x),formula:T,tableName:et.tableName,columnName:et.columnName})}}return{dependencies:o,sheetsScanned:i,formulasAnalyzed:s,scannedAt:new Date}}));return this.cachedScan={result:t,timestamp:Date.now()},this.telemetry.logEvent({category:"formula",name:"scanWorkbook",severity:"info",context:{dependencyCount:t.dependencies.length,sheetsScanned:t.sheetsScanned,formulasAnalyzed:t.formulasAnalyzed}}),{ok:!0,value:t}}catch(t){return this.telemetry.normalizeError("scanWorkbook",t,"Failed to scan workbook for formula dependencies.")}})}parseTableColumnReferences(e){let t=[],r=new RegExp(this.STRUCTURED_REF_REGEX.source,"g"),o;for(;(o=r.exec(e))!==null;){let i=o[1],s=o[2];s.startsWith("#")||(s=s.replace(/^@/,"").replace(/^\[/,"").replace(/\]$/,""),t.push({tableName:i,columnName:s||void 0}))}return t}checkQueryImpact(e,t,r){return v(this,null,function*(){let o=yield this.scanWorkbook();if(!o.ok||!o.value)return{ok:!1,error:o.error??{operation:"checkQueryImpact",message:"Scan failed"}};let s=o.value.dependencies.filter(d=>d.tableName.toLowerCase()===t.toLowerCase()),a=r?s.filter(d=>d.columnName&&r.map(p=>p.toLowerCase()).includes(d.columnName.toLowerCase())):s,l=[...new Set(a.map(d=>d.columnName).filter(Boolean))],c="none";a.length>0&&(c=a.length<=5?"low":"high");let u={queryId:e,tableName:t,hasImpact:a.length>0,affectedColumns:l,affectedFormulas:a,severity:c};return this.telemetry.logEvent({category:"formula",name:"checkQueryImpact",severity:"info",context:{queryId:e,tableName:t,hasImpact:u.hasImpact,affectedFormulaCount:a.length,severity:c}}),{ok:!0,value:u}})}getTableDependencies(){return v(this,null,function*(){let e=yield this.scanWorkbook();if(!e.ok||!e.value)return{ok:!1,error:e.error??{operation:"getTableDependencies",message:"Scan failed"}};let t=new Map;for(let r of e.value.dependencies){let o=t.get(r.tableName)??[];o.push(r),t.set(r.tableName,o)}return{ok:!0,value:t}})}generateReportCsv(e){let t=`Sheet,Cell,Formula,Table,Column
`,r=e.map(o=>`"${this.escapeCsvField(o.sheetName)}","${o.cellAddress}","${this.escapeCsvField(o.formula)}","${this.escapeCsvField(o.tableName)}","${o.columnName??""}"`).join(`
`);return t+r}clearCache(){this.cachedScan=null,this.telemetry.logEvent({category:"formula",name:"clearCache",severity:"debug"})}escapeCsvField(e){return e.replace(/"/g,'""')}columnLetterToIndex(e){let t=0;for(let r=0;r<e.length;r++)t=t*26+e.charCodeAt(r)-64;return t-1}indexToAddress(e,t){let r="",o=e;for(;o>=0;)r=String.fromCharCode(o%26+65)+r,o=Math.floor(o/26)-1;return`${r}${t}`}static \u0275fac=function(t){return new(t||n)(C(je),C(ae))};static \u0275prov=I({token:n,factory:n.\u0275fac,providedIn:"root"})};function Fm(){Eu(Ea,Pm).then(()=>{try{let n=typeof Office<"u"&&Office.context?.host===Office.HostType?.Excel,e=location.protocol==="https:",t=/^(localhost|127\.0\.0\.1)$/i.test(location.hostname);if("serviceWorker"in navigator&&e&&!t&&!n){let r=new URL("sw.js",document.baseURI).toString();navigator.serviceWorker.register(r).catch(()=>{})}}catch{}}).catch(n=>console.error(n))}typeof Office<"u"&&typeof Office.onReady=="function"?Office.onReady().then(()=>{Fm()}):Fm();
