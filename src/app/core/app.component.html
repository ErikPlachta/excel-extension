<nav [class]="appConfig.rootIdsAndClasses.navClass" role="navigation" aria-label="Main navigation">
  <app-button
    *ngFor="let item of appConfig.navItems"
    [label]="getNavLabel(item.labelKey)"
    [variant]="item.buttonVariant || appConfig.ui?.navButtonVariant || 'primary'"
    [size]="item.buttonSize || appConfig.ui?.navButtonSize || 'md'"
    [disabled]="!canAccessNav(item)"
    [ngClass]="{ 'is-active': item.viewId && currentView === item.viewId }"
    [attr.id]="item.domId || null"
    [attr.aria-current]="item.viewId && currentView === item.viewId ? 'page' : null"
    (clicked)="handleNavClick(item)"
  ></app-button>
</nav>

<section
  [class]="appConfig.rootIdsAndClasses.userBannerClass"
  *ngIf="authSummary.isAuthenticated && authSummary.displayName as displayName"
  role="region"
  aria-label="User information"
>
  <span class="user-banner-name">{{ displayName }}</span>
  <span class="user-banner-role">
    {{ authSummary.roles.length ? authSummary.roles.join(", ") : text.userBanner?.noRolesAssigned }}
  </span>
</section>

<section
  [class]="appConfig.rootIdsAndClasses.hostStatusClass"
  *ngIf="!hostStatus.isExcel || !hostStatus.isOnline"
  role="status"
  aria-live="polite"
  aria-label="Application status"
>
  <ng-container *ngIf="!hostStatus.isExcel; else excelOk">
    <span class="host-status-label">{{ text.hostStatus?.excelNotDetectedLabel }}</span>
    <span class="host-status-message">
      {{ text.hostStatus?.excelNotDetectedMessage }}
    </span>
  </ng-container>
  <ng-template #excelOk>
    <span class="host-status-label">{{ text.hostStatus?.excelConnectedLabel }}</span>
  </ng-template>

  <span class="host-status-separator" aria-hidden="true">â€¢</span>

  <span class="host-status-label" [class.host-status-offline]="!hostStatus.isOnline">
    {{ hostStatus.isOnline ? text.hostStatus?.onlineLabel : text.hostStatus?.offlineLabel }}
  </span>
  <span class="host-status-message" *ngIf="!hostStatus.isOnline">
    {{ text.hostStatus?.offlineMessage }}
  </span>
</section>

<main class="content" role="main" aria-label="Main content">
  <app-sso-home *ngIf="currentView === 'sso'"></app-sso-home>
  <app-worksheets
    *ngIf="currentView === 'worksheets' && authSummary.isAuthenticated"
  ></app-worksheets>
  <app-tables *ngIf="currentView === 'tables' && authSummary.isAuthenticated"></app-tables>
  <app-user *ngIf="currentView === 'user' && authSummary.isAuthenticated"></app-user>
  <app-queries
    *ngIf="
      currentView === 'queries' &&
      authSummary.isAuthenticated &&
      auth.hasAnyRole(['analyst', 'admin'])
    "
  ></app-queries>
  <app-debug-context
    *ngIf="currentView === 'debug' && authSummary.isAuthenticated && auth.hasRole('admin')"
  ></app-debug-context>
  <app-settings *ngIf="currentView === 'settings' && authSummary.isAuthenticated"></app-settings>
</main>
