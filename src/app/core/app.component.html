<nav [class]="appConfig.rootIdsAndClasses.navClass">
  <button
    *ngFor="let item of appConfig.navItems"
    type="button"
    (click)="selectView(item.viewId)"
    [disabled]="!canAccessNav(item)"
    [hidden]="!isNavVisible(item)"
    [id]="item.domId || null"
  >
    {{ getNavLabel(item.labelKey) }}
  </button>
  <button type="button" (click)="signInAnalyst()" *ngIf="!auth.isAuthenticated">
    {{ text.auth.signInAnalyst }}
  </button>
  <button type="button" (click)="signInAdmin()" *ngIf="!auth.isAuthenticated">
    {{ text.auth.signInAdmin }}
  </button>
  <button type="button" (click)="signOut()" *ngIf="authSummary.isAuthenticated">
    {{ text.auth.signOut }}
  </button>
  <span [class]="appConfig.rootIdsAndClasses.statusClass">
    {{ hostStatus.isExcel ? "isExcel = true" : "isExcel = false" }}
  </span>
</nav>

<section
  [class]="appConfig.rootIdsAndClasses.userBannerClass"
  *ngIf="authSummary.isAuthenticated && authSummary.displayName as displayName"
>
  <span class="user-banner-name">{{ displayName }}</span>
  <span class="user-banner-role">
    {{ authSummary.roles.length ? authSummary.roles.join(", ") : text.userBanner.noRolesAssigned }}
  </span>
</section>

<section
  [class]="appConfig.rootIdsAndClasses.hostStatusClass"
  *ngIf="!hostStatus.isExcel || !hostStatus.isOnline"
>
  <ng-container *ngIf="!hostStatus.isExcel; else excelOk">
    <span class="host-status-label">{{ text.hostStatus.excelNotDetectedLabel }}</span>
    <span class="host-status-message">
      {{ text.hostStatus.excelNotDetectedMessage }}
    </span>
  </ng-container>
  <ng-template #excelOk>
    <span class="host-status-label">{{ text.hostStatus.excelConnectedLabel }}</span>
  </ng-template>

  <span class="host-status-separator">â€¢</span>

  <span class="host-status-label" [class.host-status-offline]="!hostStatus.isOnline">
    {{ hostStatus.isOnline ? text.hostStatus.onlineLabel : text.hostStatus.offlineLabel }}
  </span>
  <span class="host-status-message" *ngIf="!hostStatus.isOnline">
    {{ text.hostStatus.offlineMessage }}
  </span>
</section>

<section class="content">
  <app-sso-home *ngIf="currentView === 'sso'"></app-sso-home>
  <app-worksheets
    *ngIf="currentView === 'worksheets' && authSummary.isAuthenticated"
  ></app-worksheets>
  <app-tables *ngIf="currentView === 'tables' && authSummary.isAuthenticated"></app-tables>
  <app-user *ngIf="currentView === 'user' && authSummary.isAuthenticated"></app-user>
  <app-query-home
    *ngIf="
      currentView === 'queries' &&
      authSummary.isAuthenticated &&
      auth.hasAnyRole(['analyst', 'admin'])
    "
  ></app-query-home>
</section>
