<app-section title="Tables">
  <ng-container *ngIf="isExcel; else noExcel">
    <div *ngIf="isLoading" class="loading" role="status" aria-live="polite">
      <span>Loading tables...</span>
    </div>
    <div *ngIf="loadError" class="error" role="alert">
      {{ loadError }}
    </div>
    <app-table
      *ngIf="!isLoading && !loadError"
      [columns]="[
        { field: 'name', header: 'Name' },
        { field: 'worksheet', header: 'Worksheet' },
        { field: 'rows', header: 'Rows' },
        { field: 'isManaged', header: 'Managed by extension' },
      ]"
      [rows]="tables"
      emptyMessage="No tables found."
    ></app-table>
  </ng-container>
  <ng-template #noExcel>
    <p>Excel not detected.</p>
  </ng-template>
</app-section>
